(function(){function i(){var n={};return n["_$ES.R"]=function(n){function t(){n.call(this)}return t.ERR_PARAM_CAN_NOT_NULL="参数 {0} 不允许为空。",t.ERR_PARAM_TYPE_ERR="参数 {0} 必须为 {1} 类型。",t.ERR_PARAM_NOT_EMPTY_STRING="参数 {0} 不允许为空的字符串",t.ERR_CAN_NOT_INSTANTIATION="尝试实例化的函数不是构造函数。",t.ERR_PARAM_RANGE="参数 {0} 的范围应该在 {1}-{2} 之间",t.ERR_BYTEARRAY_EOF="没有足够的数据可供读取",t.ERR_BYTEARRAY_READBYTES_RANGE="所提供的位移和长度的组合值大于单元的最大值",t.ERR_BYTEARRAY_NOTFOUNDCODEPAGEDEFINE="未找到CodePage{1}的代码页JS定义,可以在extswf的源文件的codepage目录下找到",t.ERR_VECTOR_FIXED="无法修改固定数组的长度",t.ERR_DICTIONARY_PARAM_IS_NOT_EXTENSIBLE="object 作为 Dictionary 的键必须是可扩展的",t.ERR_NOT_FROM_POOLS="类{0}无法直接实例化，必须从池中分配",function(){}.call(t),t},function(){n["_$ES.R"]=n["_$ES.R"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"R",{get:function(){return t===undefined&&(t=null,t=i(),delete n.R,n.R=t["_$ES.R"]),t["_$ES.R"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.TextureInfo"]=function(n){function t(t,i,r,u){this.transformList=[];this.vData=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);n.call(this);this.id=_$ES.F.id++;this.boundsSource=t;this.allocatorBounds=i;this.allocatorResult=r;this.boundsScale=u;r&&(this.spriteId=r.sprite.id,this.textureBoundsInGL=_$ES.Draw.Utils.rectToTextureCoordinate(i,r.sprite.w,r.sprite.h),_$ES.TextureInfo.updateTextureBounds(this.textureBoundsInGL,this.vData));this.toOriginMatrix=_$ES.Draw.Utils.getOriginMatrix(t,u)}return t.prototype.swfParse=undefined,t.prototype.transformList=undefined,t.prototype.vData=undefined,t.prototype.allocatorBounds=undefined,t.prototype.allocatorResult=undefined,t.prototype.id=undefined,t.prototype.deviceFontHeight=undefined,t.prototype.spriteId=undefined,t.prototype.textureBoundsInGL=undefined,t.prototype.boundsSource=undefined,t.prototype.boundsInGL=undefined,t.prototype.boundsScale=undefined,t.prototype.toOriginMatrix=undefined,t.prototype.imageSource=undefined,t.prototype.imageSourceIsAlphaPremultiplied=!1,t.prototype.isClone=!1,Object.defineProperty(t.prototype,"clone",{value:function(n,t,i,r,u,f){var o=this.allocatorBounds,e=new _$ES.TextureInfo(n,new _$ES.Geoms.ESRectangle(o.x+t,o.y+i,r,u),this.allocatorResult,f?f:this.boundsScale);return e.imageSource=this.imageSource,e.isClone=!0,e}}),Object.defineProperty(t,"updateBoundsByPoint",{value:function(n,t,i,r,u,f,e,o,s,h){h?(s[0]=i>>0,s[1]=r>>0,s[4]=n>>0,s[5]=t>>0,s[8]=e>>0,s[9]=o>>0,s[12]=e>>0,s[13]=o>>0,s[16]=n>>0,s[17]=t>>0,s[20]=u>>0,s[21]=f>>0):(s[0]=i,s[1]=r,s[4]=n,s[5]=t,s[8]=e,s[9]=o,s[12]=e,s[13]=o,s[16]=n,s[17]=t,s[20]=u,s[21]=f)}}),Object.defineProperty(t,"updateTextureBounds",{value:function(n,t){t[2]=n.x;t[3]=n.y+n.height;t[6]=n.x;t[7]=n.y;t[10]=n.x+n.width;t[11]=n.y+n.height;t[14]=n.x+n.width;t[15]=n.y+n.height;t[18]=n.x;t[19]=n.y;t[22]=n.x+n.width;t[23]=n.y}}),function(){}.call(t),t},function(){n["_$ES.TextureInfo"]=n["_$ES.TextureInfo"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"TextureInfo",{get:function(){return t===undefined&&(t=null,t=i(),delete n.TextureInfo,n.TextureInfo=t["_$ES.TextureInfo"]),t["_$ES.TextureInfo"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.WorkerManange"]=function(t){function i(n,i){n===undefined&&(n=0);i===undefined&&(i=null);this.inWinMessageDic=[];t.call(this);_$ES.F.isInWorker()||i?(this.inWork=!0,i?(i.vWorkGlobalScope.onmessage=_$ES.F.bind(this.onMessage,this),this.inWorkSelf=i.vWorkGlobalScope):(self.onmessage=_$ES.F.bind(this.onMessage,this),this.inWorkSelf=self),this.inWorkPostMessage({type:999,data:null})):this.inWinWorkerInit()}return i.prototype.isUsedVirtualWork=!1,i.prototype.inWork=!1,i.prototype.inWorkIndex=undefined,i.prototype.inWorkSelf=undefined,i.prototype.messageId=1,Object.defineProperty(i.prototype,"postMessage",{value:function(n,t,i){if(i===undefined&&(i=null),t.id||(t.id=this.messageId++),i)try{n.postMessage(t,i)}catch(r){if(i.length==1)try{n.postMessage(t,i[0])}catch(r){n.postMessage(t)}else n.postMessage(t)}else n.postMessage(t);return t}}),Object.defineProperty(i.prototype,"inWorkPostMessage",{value:function(n,t){return t===undefined&&(t=null),this.postMessage(this.inWorkSelf,n,t)}}),Object.defineProperty(i.prototype,"inWinPostMessage",{value:function(n,t,i){return i===undefined&&(i=null),this.postMessage(n,t,i)}}),i.prototype.inWinMessageDic=undefined,Object.defineProperty(i.prototype,"inWinSWFParse",{value:function(n,t,i){i===undefined&&(i=null);this.inWinPostMessageCallBack({type:30,data:[n]},t,null,i)}}),Object.defineProperty(i.prototype,"inWinPostMessageCallBack",{value:function(n,t,i,r){i===undefined&&(i=null);r===undefined&&(r=null);r==null&&(r=this.inWinGetAvailableWork());n.id=this.messageId++;this.inWinMessageDic[n.id]=n;this.isUsedVirtualWork&&(n.onMessage=t);this.inWinPostMessage(r,n,i);n.onMessage==null&&(n.onMessage=t)}}),Object.defineProperty(i.prototype,"onMessage",{value:function(n){var c=null,i=null,r=null,e=null,u=null,o=NaN,f=null,s=null,h=null,t=n.data;if(t!=null)switch(t.type){case 999:this.inWinWorkerIsInit=!0;this.inWinAvailableWork.onerror=null;_$ES.F.traceLog("WebWork完成初始化");break;case 30:if(this.inWork){if(c=t.data[0],i=new _$ES.BR(c,this),r={isSWF:i.isSWF()},e=[],u=[],o=0,r.isSWF){for(r.version=i.ReadByte(),r.frameRate=i.ReadFloat(),r.frameCount=i.ReadUInt16(),r.frameSize=i.ReadInfo_Rectangle(),r.tagCount=i.ReadInt32(),r.definitionTagCount=i.ReadInt32(),r.tagWithScriptCount=i.ReadInt32(),this.inWorkPostMessage({type:5,data:[r],sourceMessageId:t.id});f=i.ReadTag();)if(typeof f=="object"&&f.tagType)switch(f.tagType){case 4:case 26:case 70:case 5:case 28:case 1:case 15:case 89:case 19:case 18:case 45:case 0:break;default:o=o+(f.tagLength=i.currentTagLength);e.push(f);switch(f.tagType){case 6:case 21:case 35:case 90:case 20:case 36:s=f;s.imageData!=null&&u.push(s.imageData);s.alphaData!=null&&u.push(s.alphaData);break;case 14:h=f;h.soundData!=null&&u.push(h.soundData);h.soundData_ogg!=null&&u.push(h.soundData_ogg)}o>4096&&(this.inWorkPostMessage({type:6,data:e,sourceMessageId:t.id},u.length>0?u:null),o=0,e=[],u=[])}}else this.inWorkPostMessage({type:5,data:[r],sourceMessageId:t.id});e.length>0&&(this.inWorkPostMessage({type:6,data:e,sourceMessageId:t.id}),o=0,e=[],u=[]);this.inWorkPostMessage({type:7,data:null,sourceMessageId:t.id},u.length>0?u:null)}break;case 5:case 6:case 7:this.inWinMessageDic[t.sourceMessageId].onMessage(t);t.type==7&&delete this.inWinMessageDic[t.sourceMessageId];break;case 31:this.inWorkPostMessage({type:32,data:[_$ES.F.setImageDataAlpha(t.data[0],t.data[1])],sourceMessageId:t.id});break;case 33:this.inWorkPostMessage({type:34,data:[_$ES.F.unAlphaPremultiplied(t.data[0],t.data[1])],sourceMessageId:t.id});break;case 32:case 34:this.inWinMessageDic[t.sourceMessageId].onMessage(t.data[0]);delete this.inWinMessageDic[t.sourceMessageId]}}}),i.prototype.inWinWorkerIsInit=!1,Object.defineProperty(i.prototype,"inWinCreateWorker",{value:function(){var n=null,t=_$ES.F.getMainJSUrl();n=new Worker(t);n.onerror=_$ES.F.bind(function(){n.onerror=null;n.terminate();this.inWinCreateWorkerByBlob()},this);this.inWinSetOnMessage(n)}}),Object.defineProperty(i.prototype,"inWinCreateWorkerByBlob",{value:function(){var n=null,t=_$ES.F.getMainJSUrl(),i="self._$baseDirectory='"+_$ES.F.getDirectory(t)+"'; self.importScripts('"+t+"');",r=URL.createObjectURL(_$ES.F.createBlob([i],{type:"application/x-javascript"}));n=new Worker(r);n.onerror=_$ES.F.bind(function(){n.onerror=null;n.terminate();this.inWinCreateVirtualWork()},this);this.inWinSetOnMessage(n)}}),Object.defineProperty(i.prototype,"inWinCreateVirtualWork",{value:function(){var t=null;_$ES.F.traceLog("模拟WebWork");this.isUsedVirtualWork=!0;t=new n.VirtualWork(this)}}),i.prototype.inWinAvailableWork=undefined,Object.defineProperty(i.prototype,"inWinSetOnMessage",{value:function(n){n.onmessage=_$ES.F.bind(this.onMessage,this);this.inWinAvailableWork=n}}),Object.defineProperty(i.prototype,"inWinWorkerInit",{value:function(){try{this.inWinCreateWorker()}catch(n){try{this.inWinCreateWorkerByBlob()}catch(n){this.inWinCreateVirtualWork()}}}}),Object.defineProperty(i.prototype,"inWinGetAvailableWork",{value:function(){return this.inWinAvailableWork}}),function(){}.call(i),i},n.VirtualWorkerGlobalScope=function(n){function t(t){n.call(this);this.vWork=t}return _$ES.F._extends(t,n),t.prototype.vWork=undefined,Object.defineProperty(t.prototype,"postMessage",{value:function(n,t){t===undefined&&(t=null);var i={};i.data=n;this.vWork.onmessage(i)}}),t.prototype.onMessageFunc=undefined,Object.defineProperty(t.prototype,"onmessage",{get:function(){return this.onMessageFunc},set:function(n){this.onMessageFunc=n}}),function(){}.call(t),t},n.VirtualWork=function(t){function i(i){t.call(this);this.vWorkGlobalScope=new n.VirtualWorkerGlobalScope(this);i.inWinSetOnMessage(this);this.mainWM=i;this.workWM=new _$ES.WorkerManange(0,this)}return _$ES.F._extends(i,t),i.prototype.mainWM=undefined,i.prototype.workWM=undefined,i.prototype.vWorkGlobalScope=undefined,i.prototype.onMessageFunc=undefined,Object.defineProperty(i.prototype,"onmessage",{get:function(){return this.onMessageFunc},set:function(n){this.onMessageFunc=n}}),Object.defineProperty(i.prototype,"postMessage",{value:function(n,t){t===undefined&&(t=null);var i={};i.data=n;this.vWorkGlobalScope.onmessage(i)}}),function(){}.call(i),i},function(){n["_$ES.WorkerManange"]=n["_$ES.WorkerManange"](Object);n.VirtualWorkerGlobalScope=n.VirtualWorkerGlobalScope(Object);n.VirtualWork=n.VirtualWork(Object);_$ES.F.isInWorker()&&new n["_$ES.WorkerManange"]}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};t=i();Object.defineProperty(n,"WorkerManange",{get:function(){return t["_$ES.WorkerManange"]},set:function(n){t["_$ES.WorkerManange"]=n},enumerable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.TextureManage"]=function(n){function t(t){this.deviceFontTexutres=[];this.deviceFontInfoDic=[];this.textureList=[];n.call(this);t=this.appInfo=t;var i=t.canvasInfoPoolsSpriteW;this.allocator=new _$ES.CanvasAllocator(i,i,!1,t.canvasInfoPoolsMinW,t.canvasInfoPoolsMinH)}return t.prototype.appInfo=undefined,Object.defineProperty(t.prototype,"createTexture_runTime",{value:function(n,t,i){i!=null&&i()}}),Object.defineProperty(t.prototype,"createTexture_loadTime",{value:function(n,t,i){for(var r=t,u=n.tag_AllToTextureTags,e=(new Date).time,f=u.length;t<f;)if(this.getTextureBySymbol(u[t]),t++,(new Date).time-e>32)break;if(t>r){if(n===this.appInfo.mainSWFParse)this.appInfo.onProgress((t-r)/f*25);window.setTimeout(_$ES.F.bind(this.createTexture_loadTime,this),16,n,t,i);return}i!=null&&i()}}),Object.defineProperty(t.prototype,"tagMorphShapeToTexture",{value:function(n,t,i){var r=this.createTexture(i,1,n),u=new _$ES.Draw.DrawShape(_$ES.F.createCTX(r.allocatorBounds.width,r.allocatorBounds.height),r.toOriginMatrix,null,n.swfParse,!1,!1,t).draw(n.defineShape.shapeInfo);return n.textures[t]=r.id,this.updateToApp(r,u.canvas),r}}),Object.defineProperty(t.prototype,"tagShapeToTexture",{value:function(n){var t=null,i=null;return n.relateShapes?null:n.imageData?this.tagBitsToTexture(n.imageData,n):(t=null,n.bitTagDefineId?this.addTexture(t=this.getTextureBySymbol(n.swfParse.tag_AllTagDefines[n.bitTagDefineId]).clone(_$ES.Geoms.ESRectangle.createByInfo(n.ShapeBounds),n.inBitX,n.inBitY,n.inBitWidth,n.inBitHeight,n.inBitScale),n):(t=this.createTexture(_$ES.Geoms.ESRectangle.createByInfo(n.ShapeBounds),1,n),i=new _$ES.Draw.DrawShape(_$ES.F.createCTX(t.allocatorBounds.width,t.allocatorBounds.height),t.toOriginMatrix,null,n.swfParse,!1).draw(n.shapeInfo),this.updateToApp(t,i.canvas)),t)}}),Object.defineProperty(t.prototype,"tagBitsToTexture",{value:function(n,t){var i=null,r=null;return n.bitTagDefineId?this.addTexture(r=this.getTextureBySymbol(n.swfParse.tag_AllTagDefines[n.bitTagDefineId]).clone(new _$ES.Geoms.ESRectangle(0,0,n.imageWidth,n.imageHeight),n.inBitX,n.inBitY,n.inBitWidth,n.inBitHeight,n.inBitScale),t):(i=n.imageSource,n.imageSource=null,r=this.createTexture(new _$ES.Geoms.ESRectangle(0,0,i.width,i.height),1,t),this.updateToApp(r,i,n.imageSourceIsAlphaPremultiplied,n.shapeRefNumber>0)),r}}),Object.defineProperty(t.prototype,"tagImageFileToTexture",{value:function(n){var t=n.imageSource,i;return n.imageSource=null,i=this.createTexture(new _$ES.Geoms.ESRectangle(0,0,t.width,t.height),1,n),this.updateToApp(i,t),i}}),Object.defineProperty(t.prototype,"transformTexture",{value:function(n,t){var i=null,s=t.toKey();if(i=n.transformList[s])return i;var h=this.appInfo.renderManage,u=h.readPixelToImageSource(n),r=t.transformRect2(new _$ES.Geoms.ESRectangle(0,0,u.width,u.height)),f=_$ES.F.createCTX(r.width,r.height),e=t.tx-r.x,o=t.ty-r.y;return f.transform(t.a,t.b,t.c,t.d,e,o),f.drawImage(u,0,0),i=this.imageSourceToTexture(f.canvas),i.boundsSource.x=-e,i.boundsSource.y=-o,i.toOriginMatrix.tx=e,i.toOriginMatrix.ty=o,n.transformList[s]=i,i}}),Object.defineProperty(t.prototype,"canvasToTexture",{value:function(n){return this.updateToApp(this.createTexture(new _$ES.Geoms.ESRectangle(0,0,n.width,n.height),1,null),n,!1,!0)}}),Object.defineProperty(t.prototype,"imageSourceToTexture",{value:function(n){return this.updateToApp(this.createTexture(new _$ES.Geoms.ESRectangle(0,0,n.width,n.height),1,null),n,!1,!0)}}),Object.defineProperty(t.prototype,"tagDefineTextToTexture",{value:function(n){var t=null,i=null;return n.bitTagDefineId?this.addTexture(t=this.getTextureBySymbol(n.swfParse.tag_AllTagDefines[n.bitTagDefineId]).clone(_$ES.Geoms.ESRectangle.createByInfo(n.bounds),n.inBitX,n.inBitY,n.inBitWidth,n.inBitHeight,n.inBitScale),n):(t=this.createTexture(_$ES.Geoms.ESRectangle.createByInfo(n.bounds),n.maxMatrixScale,n),i=new _$ES.Draw.DrawStaticText(n,_$ES.F.createCTX(t.allocatorBounds.width,t.allocatorBounds.height),t.toOriginMatrix).draw(),this.updateToApp(t,i.canvas)),t}}),Object.defineProperty(t.prototype,"getDefineFontKey",{value:function(n,t,i){return n+"_"+t+"_"+i}}),Object.defineProperty(t.prototype,"defineFontToTexutre",{value:function(n,t,i,r){var o=NaN,v=NaN,h=NaN,c=NaN,y=null,l=NaN,a=null,u=null,f=null,e=null,s=n.ascent,p=n.descent,w=s+p,b=-s*1024;return typeof s=="number"?(n.textures||(n.textures=[]),o=n.codeTableDic[t],v=n.codeTable[o],h=1024*w,c=_$ES.F.getEmbedFontWidth(n,o,1024),y=n.glyphShapes[o],l=r/1024,a=new _$ES.Geoms.ESRectangle(0,b,c,h),u=this.createTexture(a,l,n),f=u.toOriginMatrix,e=_$ES.F.createCTX(u.allocatorBounds.width,u.allocatorBounds.height),e.beginPath(),e.setTransform(f.a,f.b,f.c,f.d,f.tx,f.ty),new _$ES.Draw.DrawShape(e,null,null,null,!1).drawGlyphShape(n.glyphShapes[o]),e.fillStyle=_$ES.Temp.c1.setByRGB(i,255).toCssRGB(),e.fill("evenodd"),n.textures[this.getDefineFontKey(t,i,r)]=u.id,this.updateToApp(u,e.canvas),u):null}}),t.prototype.deviceFontTexutres=undefined,Object.defineProperty(t.prototype,"getDeviceFontKey",{value:function(n,t,i,r,u,f){return n+t+i+r+u+f}}),Object.defineProperty(t.prototype,"deviceFontToTexture",{value:function(n,t,i,r,u,f,e){var h=n.deviceFont||this.getDeviceFontInfo(t,e,r,u),c=h.boundsBoxSize,l=new _$ES.Geoms.ESRectangle(0,0,n.w,c),s=this.createTexture(l,1,null),o=_$ES.F.createCTX(s.allocatorBounds.width,s.allocatorBounds.height);return o.font=h.fontStyle,o.textBaseline="top",o.fillStyle=_$ES.Temp.c1.setByRGB(f,255).toCssRGB(),o.fillText(i,0,0),this.deviceFontTexutres[this.getDeviceFontKey(t,i,r,u,f,e)]=s.id,this.updateToApp(s,o.canvas)}}),t.prototype.deviceFontInfoDic=undefined,Object.defineProperty(t.prototype,"getDeviceFontInfo",{value:function(n,t,i,r){var f=null,d=null,p=NaN,w=NaN,b=null,v=NaN,s=NaN,y=NaN,k=null,g=NaN,l=NaN,h=NaN,e=NaN,c=NaN,a=!1,u="",o;if(i&&(u=u+"italic "),r&&(u=u+"bold "),u=u+(t+"px "),u=n&&n.charAt(0)!="_"?u+n:u+"sans-serif",o=this.deviceFontInfoDic[u],!o){if(o={},o.fontStyle=u,f=_$ES.Temp.ctx,d=f.canvas,f.font=u,b=f.measureText("|MÉq"),"fontBoundingBoxAscent"in b)p=b.fontBoundingBoxAscent,w=b.fontBoundingBoxDescent;else{for(v=Math.ceil(f.measureText("|MÉq").width),s=Math.ceil(f.measureText("M").width),y=2*s,s=s*1.4|0,d.width=v,d.height=y,f.fillStyle="#f00",f.fillRect(0,0,v,y),f.font=u,f.textBaseline="top",f.fillStyle="#000",f.fillText("|MÉq",0,0),k=f.getImageData(0,0,v,y).data,g=k.length,l=v*4,c=0,a=!1,h=0;h<s;){for(e=0;e<l;){if(k[c+e]!==255){a=!0;break}e=e+4}if(a)break;else c=c+l;h++}for(p=s-h,c=g-l,a=!1,h=y;h>s;){for(e=0;e<l;){if(k[c+e]!==255){a=!0;break}e=e+4}if(a)break;else c=c-l;h--}w=h-s}o.boundsBoxSize=p+w;o.ascent=p/t;o.descent=w/t;this.deviceFontInfoDic[u]=o}return o}}),t.prototype.allocator=undefined,t.prototype.allocatorByAlpha=undefined,t.prototype.textureList=undefined,Object.defineProperty(t.prototype,"createAlphaTexture",{value:function(n,t){var i=NaN;return this.allocatorByAlpha||(i=this.appInfo.canvasInfoPoolsSpriteW,this.allocatorByAlpha=new _$ES.CanvasAllocator(i,i,!1,this.appInfo.canvasInfoPoolsMinW,this.appInfo.canvasInfoPoolsMinH)),this.createTexture(new _$ES.Geoms.ESRectangle(0,0,n,t),1,null,this.allocatorByAlpha)}}),Object.defineProperty(t.prototype,"createTexture",{value:function(n,t,i,r){var a;i===undefined&&(i=null);r===undefined&&(r=null);var h=null,l=null,e=NaN,o=NaN,c=NaN;r||(r=this.allocator);n=n.clone();n.width<1&&(n.width=1);n.height<1&&(n.height=1);t||(t=1);var u=n.width*t,f=n.height*t,v=this.appInfo,s=v.canvasInfoPoolsSpriteW;return u=Math.ceil(u),f=Math.ceil(f),v.renderMode===0?((u==128||u==256||u==512||u==1024||u==2048||u==4096)&&(f==128||f==256||f==512||f==1024||f==2048||f==4096)?(e=u,o=f):u>s||f>s?(c=1-Math.max((u-s)/u,(f-s)/f),u=e=Math.floor(u*c),f=o=Math.floor(f*c),e<s&&(e=e+1),o<s&&(o=o+1),t=t*c):(e=u+1,o=f+1),h=r.pop(e,o),l=new _$ES.Geoms.ESRectangle(h.x,h.y,u,f)):l=new _$ES.Geoms.ESRectangle(0,0,u,f),a=new _$ES.TextureInfo(n,l,h,t),this.addTexture(a,i),a}}),Object.defineProperty(t.prototype,"addTexture",{value:function(n,t){return t===undefined&&(t=null),this.textureList[n.id]=n,t&&(n.swfParse=t.swfParse,t.textureId=n.id),n}}),Object.defineProperty(t.prototype,"getTexture",{value:function(n){return this.textureList[n]}}),Object.defineProperty(t.prototype,"getTextureBySymbol",{value:function(n){var t=n.textureId;if(t)return this.textureList[t];switch(n.tagType){case 2:case 22:case 32:case 83:return this.tagShapeToTexture(n);case 1023:return this.tagImageFileToTexture(n);case 6:case 21:case 35:case 90:case 20:case 36:return this.tagBitsToTexture(n,n);case 11:case 33:return this.tagDefineTextToTexture(n)}return null}}),Object.defineProperty(t.prototype,"getFontTexture",{value:function(n,t){var i=NaN,r=null,h=this.appInfo,u=n.format,s=u.font,f=n.char,e=h.renderMode===0?0:u._$colorValue,o=n.size,c=u._$italicValue,l=u._$boldValue;if(t){if(r=h.fontsDic[s],r.textures&&(i=r.textures[this.getDefineFontKey(f,e,o)]),!i)return this.defineFontToTexutre(r,f,e,o)}else if(i=this.deviceFontTexutres[this.getDeviceFontKey(s,f,c,l,e,o)],!i)return this.deviceFontToTexture(n,s,f,c,l,e,o);return this.getTexture(i)}}),Object.defineProperty(t.prototype,"removeTexture",{value:function(n){var t=null,i=NaN,r=NaN;if(n&&(delete this.textureList[n.id],!n.isClone))for(this.appInfo.renderManage.removeTexture(n),n.allocatorResult&&(n.allocatorResult.sprite.allocator.push(n.allocatorResult),n.allocatorResult=null),t=Object.keys(n.transformList),r=t.length;i<r;)this.removeTexture(t[i]),i++}}),Object.defineProperty(t.prototype,"removeTextureById",{value:function(n){this.removeTexture(this.textureList[n])}}),Object.defineProperty(t.prototype,"removeTextureBySwfParse",{value:function(n){this.textureList.forEach(function(t){t.swfParse===n&&this.removeTexture(t)},this)}}),Object.defineProperty(t.prototype,"updateToApp",{value:function(n,t,i,r){i===undefined&&(i=!1);r===undefined&&(r=!1);var f=null,u=n.allocatorBounds,e=t;return(t.width>u.width||t.height>u.height)&&(f=_$ES.F.createCTX(u.width,u.height),f.drawImage(t,0,0,u.width,u.height),t=f.canvas),this.appInfo.renderManage.addTexture(n,t,i,r,e),n}}),function(){}.call(t),t},function(){n["_$ES.TextureManage"]=n["_$ES.TextureManage"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"TextureManage",{get:function(){return t===undefined&&(t=null,t=i(),delete n.TextureManage,n.TextureManage=t["_$ES.TextureManage"]),t["_$ES.TextureManage"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.PreRender"]=function(n){function t(t,i,r,u,f,e,o,s,h,c){e===undefined&&(e=null);o===undefined&&(o=null);s===undefined&&(s=null);h===undefined&&(h=null);c===undefined&&(c=!1);n.call(this);this.player=t;this.render=i;this.renderSupportClip=i.supportClip;this.init(r,u,f,e,o,s,h,c);this.renderCmdList=[];this.renderInfoDic=[]}return Object.defineProperty(t.prototype,"init",{value:function(n,t,i,r,u,f,e,o){r===undefined&&(r=null);u===undefined&&(u=null);f===undefined&&(f=null);e===undefined&&(e=null);o===undefined&&(o=!1);this.source=n;this.canvasRect=new _$ES.Geoms.ESRectangle(0,0,t,i);this.matrix=r?r:new _$ES.Geoms.ESMatrix;this.matrixIsUpdate=!0;this.colorTransform=u?u:null;this.blendMode=f;this.clipRect=e;this.smoothing=o}}),t.prototype.isSystem=!0,t.prototype.player=undefined,t.prototype.render=undefined,t.prototype.renderSupportClip=!1,Object.defineProperty(t.prototype,"dispose",{value:function(){this.renderCmdList.length=0;this.source=null;this.renderInfoDic.forEach(function(n,t){this.removeRenderInfoById(t)},this)}}),t.prototype.renderInfoDic=undefined,Object.defineProperty(t.prototype,"getRenderInfo",{value:function(n){var i=n.id,t=this.renderInfoDic[i];return t||(this.renderInfoDic[i]=t=_$ES.Pools.popRenderInfo(n,n.canDraw,this),this.isSystem&&(n.renderInfoV2=t)),t}}),Object.defineProperty(t.prototype,"hasRenderInfo",{value:function(n){return this.renderInfoDic[n.id]}}),Object.defineProperty(t.prototype,"removeRenderInfoByInfo",{value:function(n){var t=null,i=NaN;n&&(t=n.displayObject,i=t.id,_$ES.Pools.pushRenderInfo(n),delete this.renderInfoDic[i])}}),Object.defineProperty(t.prototype,"removeRenderInfoById",{value:function(n){this.removeRenderInfoByInfo(this.renderInfoDic[n])}}),Object.defineProperty(t.prototype,"removeRenderInfo",{value:function(n){n&&this.removeRenderInfoByInfo(this.renderInfoDic[n.id])}}),t.prototype.renderCmdList=undefined,t.prototype.source=undefined,t.prototype.canvasRect=undefined,t.prototype.matrix=undefined,t.prototype.matrixIsUpdate=!1,t.prototype.colorTransform=undefined,t.prototype.colorTransformIsUpdate=!1,t.prototype.blendMode=undefined,t.prototype.renderByBitmapDataDraw=!1,t.prototype.clipRect=undefined,t.prototype.smoothing=!1,t.prototype.stateIsInMask=!1,t.prototype.stateUseClip=!1,Object.defineProperty(t.prototype,"run",{value:function(){var n=this.matrixIsUpdate;return this.preProcessV2(this.source,this.renderByBitmapDataDraw?this.player.emptyTransform:null,this.matrix,this.colorTransform,n,null,!1,!1,null),n&&(this.matrixIsUpdate=!1),this.renderCmdList}}),Object.defineProperty(t.prototype,"preProcessClipV2",{value:function(n,t,i,r,u,f,e,o,s,h){var v=null,y=null,p=null,w=null,b=null,g=null,k=null,l=this.stateUseClip=!0,d=this.renderSupportClip,c=this.renderCmdList,a;if(u==2?(r.updatePlayerMatrix(this.matrix,i.transform.getConcatenatedMatrix(!1)),r.updateStageCT(this.colorTransform,i.transform.getConcatenatedColorTransform()),i.cacheAsBitmap&&n.cacheAsBitmap&&(l=!1,this.stateUseClip=!1)):u==3&&s&&(y=n.scrollRect,p=n.transform.matrix,t.updatePlayerMatrix(e,p.clone().append(n.scrollRectMatrix)),w=i.getDevBounds(),b=new _$ES.Geoms.ESMatrix(y.width/w.width,0,0,y.height/w.height,0,0),i.transform.matrix=b,r.updatePlayerMatrix(e,b.concat2(p))),l&&d?c.push("C14"):(g=r.updateBounds(i.getBounds(null)),c.push("C2",g,"C8","C1")),this.stateIsInMask=!0,u==3?this.preProcessV2(i,null,null,null,!1,h,!0,!1,null):u==2?this.preProcessV2(i,null,null,null,!0,h,!0,!1,null):this.preProcessV2(i,null,e,o,s,h,!0,!1,null),this.stateIsInMask=!1,l&&d?c.push("C16"):c.push("C9","C4",l),a=n,u==1)while((v=a.above)&&f>=v.depth)a=v,this.preProcessV2(v,null,e,o,s,r,!1,!1,null);else u==3?(k=n.mask)?a=this.preProcessClipV2(n,t,k,this.getRenderInfo(k),2,0,null,o,s,r):this.preProcessV2(n,null,null,o,s,r,!1,!1,null):this.preProcessV2(n,null,e,o,s,r,!1,!1,null);return l&&d?c.push("C17"):c.push("C5","C3"),a}}),Object.defineProperty(t.prototype,"preProcessV2",{value:function(n,t,i,r,u,f,e,o,s){for(var h=null,c=null,p=null,y=null,w=null,b=null,a=!1,k=null,v=NaN,l=null,d=NaN,g=null;n;)h=this.getRenderInfo(n),n.visible&&(e||!n.maskTarget)?(h.clip=f,a=u||h.isUpdateMatrix,k=n.scrollRect,v=0,k?(v=3,c=n.scrollRectShape,c||(c=n.scrollRectShape=new this.player.appInfo.typeManage.ASBuiltinShape(null),c.regSymbol(this.player.rectShapeSymbol)),l=this.getRenderInfo(c),l.playerCT&&(l.playerCT.alphaMultiplier=1,l.playerCT.alphaOffset=0)):this.stateIsInMask||((d=n.clipDepth)?(v=1,c=n,l=h):(c=n.mask)&&(v=2,l=this.getRenderInfo(c))),v==0||l==f?(p=n.scale9Grid||s,t=t||n.transform,a&&i&&h.updatePlayerMatrix(i,t.matrix),b=h.updateStageCT(r,t.colorTransform),w=h.playerMatrix,h.canDraw&&((a||h.isUpdateBounds)&&h.updateBounds(n.getDevBounds()),(e||h.playerBoundsInStage)&&(e&&this.stateUseClip&&this.renderSupportClip?h.displayObject.createRenderClipCmd(h,this.renderCmdList,this.render):h.displayObject.createRenderCmd(h,this.renderCmdList,a,this.render,p)))):y=this.preProcessClipV2(n,h,c,l,v,d,i,r,a,f)):(u&&(h.isUpdateMatrix=!0),y=n),y?(n=o?y.above:null,y=null):((g=n.childBottom)&&this.preProcessV2(g,null,w,b,a,f,e,!0,p),n=o?n.above:null),t=null}}),function(){}.call(t),t},function(){n["_$ES.PreRender"]=n["_$ES.PreRender"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"PreRender",{get:function(){return t===undefined&&(t=null,t=i(),delete n.PreRender,n.PreRender=t["_$ES.PreRender"]),t["_$ES.PreRender"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.IFastLinkedListNodeObj"]=function(){function n(){}return Object.defineProperty(n.prototype,"getLinkedNode",{value:function(){}}),Object.defineProperty(n.prototype,"setLinkedNode",{value:function(){}}),function(){}.call(n),n},function(){n["_$ES.IFastLinkedListNodeObj"]=n["_$ES.IFastLinkedListNodeObj"](null)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"IFastLinkedListNodeObj",{get:function(){return t===undefined&&(t=null,t=i(),delete n.IFastLinkedListNodeObj,n.IFastLinkedListNodeObj=t["_$ES.IFastLinkedListNodeObj"]),t["_$ES.IFastLinkedListNodeObj"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.Define"]=function(t,i,r){return t!=null&&n.defineList.push({fullName:t,refs:i,fun:r}),n.defineList},function(){n.defineList=[]}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"Define",{get:function(){return t===undefined&&(t=null,t=i(),delete n.Define,n.Define=t["_$ES.Define"]),t["_$ES.Define"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.SWFParse"]=function(n){function t(t,i,r){r===undefined&&(r=null);this.parseWorkerTaskList=[];this.codeRefs=[];n.call(this);this.id=_$ES.F.id++;this.appInfo=t;this.onSuccess=i;this.appDomain=r||new _$ES.AppDomain(t,t.appDomainRoot);this.tag_AllCodeDefines=[];this.tag_AllTags=[];this.tag_AllTagDefines=[];this.tag_AllToTextureTags=[]}return t.prototype.so=undefined,t.prototype.appInfo=undefined,t.prototype.loaderInfo=undefined,t.prototype.onSuccess=undefined,t.prototype.id=0,t.prototype.appDomain=null,t.prototype.content=null,t.prototype.contentType=null,t.prototype.frameRate=0,t.prototype.frameSize=null,t.prototype.frameCount=0,t.prototype.height=0,t.prototype.width=0,t.prototype.swfVersion=0,t.prototype.tagCount=0,t.prototype.tagWithScriptCount=0,t.prototype.definitionTagCount=0,t.prototype.tag_Loaded=!1,t.prototype.tag_RefsLoaded=!0,t.prototype.tag_AllCodeDefines=undefined,t.prototype.tag_AllTags=undefined,t.prototype.tag_AllTagDefines=undefined,t.prototype.tag_AllToTextureTags=undefined,t.prototype.tag_SymbolClass=undefined,t.prototype.tag_defineScene=undefined,t.prototype.tag_RefChecked=!1,t.prototype.tag_hasDoAbc2=!1,Object.defineProperty(t.prototype,"onSWFParse",{value:function(n){n&&(this.parseWorkerTaskList.push(n),this.parseWorkerIsStart||(this.parseWorkerIsStart=!0,this.parseWorkerLastTime=(new Date).time,this.parseWorkerTask()))}}),t.prototype.parseWorkerTaskList=undefined,t.prototype.parseWorkerIsStart=!1,t.prototype.parseWorkerLastTime=undefined,Object.defineProperty(t.prototype,"parseWorkerTask",{value:function(){for(var i=null,f=NaN,u=null,n=null,t=NaN,e=0,r=0;i=this.parseWorkerTaskList.shift();){switch(i.type){case 8:this.contentType=null;this.tag_RefsLoaded=!0;break;case 5:n=i.data[0];n.isSWF?(this.frameRate=n.frameRate,this.frameCount=n.frameCount,this.frameSize=_$ES.Geoms.ESRectangle.createByInfo(n.frameSize),this.width=this.frameSize.width,this.height=this.frameSize.height,this.tagCount=n.tagCount,this.definitionTagCount=n.definitionTagCount,this.tagWithScriptCount=n.tagWithScriptCount,t=n.version,this.swfVersion=t<10?t:t<13?10:t<23?11:12):(this.contentType=null,this.tag_RefsLoaded=!0);break;case 6:for(u=i.data,r=0,f=u.length;r<f;)this.parseTag(u[r]),e++,r++;break;case 7:this.tag_Loaded=!0;this.tag_RefsLoaded&&this.parseSuccess()}if((new Date).time-this.parseWorkerLastTime>32)break}if(this===this.appInfo.mainSWFParse)this.appInfo.onProgress(e/this.tagWithScriptCount*15);this.tag_Loaded||(this.parseWorkerLastTime=(new Date).time+16,window.setTimeout(_$ES.F.bind(this.parseWorkerTask,this),16))}}),t.prototype.codeRefs=undefined,Object.defineProperty(t.prototype,"parseTag",{value:function(n){var i=null,f=null,l=null,k=null,e=null,a=null,r=null,d=null,v=null,y=null,t=null,u=null,o=null,p=null,g=null,s=null,h=null,w=null,c=NaN,nt=NaN,b=null,tt=null,it=null,rt;if(n){n.swfParse=this;rt=this.appDomain;this.tag_RefChecked||!this.tag_hasDoAbc2||n.tagType==82||(this.tag_RefChecked=!0,this.tag_RefsLoaded=!1,this.loadCodeRefs());this.tag_AllTags.push(n);typeof n.defineId!="undefined"&&(this.tag_AllTagDefines[n.defineId]=n);switch(n.tagType){case 82:this.tag_hasDoAbc2=!0;i=n;i.defines=rt.addDefine_Code(i.code,this);i.code=null;Array.prototype.push.apply(this.tag_AllCodeDefines,i.defines);break;case 1023:this.loadFiles(n);break;case 9:f=n;this!=this.appInfo.mainSWFParse||this.appInfo.source.transparent||(this.appInfo.renderTargetElement.style.backgroundColor="rgb("+f.color.R+","+f.color.G+","+f.color.B+")");break;case 78:l=n;k=this.tag_AllTagDefines[l.targetDefineId];k.scalingGrid9=l.rect;break;case 76:if(e=n,this.tag_SymbolClass)for(w in e.idAndNames)this.tag_SymbolClass.idAndNames[w]=e.idAndNames[w];else this.tag_SymbolClass=e;break;case 17:a=n;r=this.tag_AllTagDefines[a.buttonId];r&&(r.buttonSounds=r.buttonSounds||[],r.buttonSounds.push(a));break;case 14:d=n;this.decodeAudio(d);break;case 39:v=n;v.soundStreamHead&&(y=v.soundStreamHead.soundDefine)&&(y.swfParse=this,this.decodeAudio(y));break;case 2:if(this.tag_AllToTextureTags.push(n),t=n,t.imageData&&(t.imageData.swfParse=this,this.loadImage(t.imageData,!1)),t.relateShapes)for(c=0,nt=t.relateShapes.length;c<nt;)this.parseTag(t.relateShapes[c]),c++;break;case 46:case 84:this.tag_AllToTextureTags.push(n);break;case 6:case 21:case 35:case 90:case 20:case 36:this.tag_AllToTextureTags.push(n);u=n;u.bitTagDefineId||this.loadImage(u,u.imageIsAlphaPremultiplied&&(!(this.appInfo.renderMode==0)||u.shapeRefNumber>0));break;case 48:case 75:this.tag_AllToTextureTags.push(n);o=n;this.appInfo.fonts.push(o);this.appInfo.fontsDic[o.name]=o;break;case 73:p=n;g=this.tag_AllTagDefines[p.fontId];g.alignZones=p;break;case 11:case 33:this.tag_AllToTextureTags.push(n);s=n;s.textRecords.length>0&&(b=[],it=this.tag_AllTagDefines,s.textRecords.forEach(function(n){n.font=n.fHasFont?tt=it[n.fontId]:tt;n.glyphEntries.forEach(function(t){b.push(n.font.codeTable[t.index])})}),s.text=String.fromCharCode.apply(String,b));break;case 37:h=n;h.hasFont&&(h.font=this.tag_AllTagDefines[h.fontId]);break;case 86:this.tag_defineScene=n}}}}),t.prototype.loadImageNum=0,Object.defineProperty(t.prototype,"loadImage",{value:function(n,t){this.loadImageNum++;_$ES.F.imageArrayBufferToCanvas(this.appInfo,n.imageData,n.imageMIMEType,_$ES.F.bind(function(t,i){n.imageSource=t;n.imageSourceIsAlphaPremultiplied=n.imageIsAlphaPremultiplied&&!i;n.imageData=null;n.alphaData=null;this.loadImageNum--},this),n.alphaData,t)}}),t.prototype.loadFileNum=0,Object.defineProperty(t.prototype,"loadFiles",{value:function(n){var t=this.appInfo.getAbsURL(n.fileName);switch(n.fileType){case 2:this.loadImageNum++;_$ES.F.imageURIToImage(t,_$ES.F.bind(function(t){this.loadImageNum--;n.imageSource=t},this));break;case 3:this.loadFileNum++;this.tag_RefsLoaded=!1;_$ES.F.addScript(t,_$ES.F.bind(function(){this.loadFileNum--;Array.prototype.push.apply(this.tag_AllCodeDefines,this.appDomain.addDefineList(_$ES.Define(null,null,null),this));this.loadCodeRefs()},this),null)}}}),t.prototype.decodeAudioNum=0,Object.defineProperty(t.prototype,"decodeAudio",{value:function(n){_$ES.F.decodeAudioData({defineSound:n,swfParse:this})}}),Object.defineProperty(t.prototype,"loadCodeRefs",{value:function(){var t=null,n=null,i=null;if(this.appInfo.player){for(t=this.appDomain,n=this.codeRefs,n.length=0;this.tag_AllCodeDefines.length>0;)i=this.tag_AllCodeDefines.pop(),i.refs.forEach(function(i){t.hasClass(i,!1)||n.push(i)});n.length>0?t.root.defineSource.loadManange.loadDefines(n,_$ES.F.bind(this.loadCodeRefsSuccess,this)):this.loadCodeRefsSuccess(null)}else window.setTimeout(_$ES.F.bind(this.loadCodeRefs,this),64)}}),Object.defineProperty(t.prototype,"loadCodeRefsSuccess",{value:function(n){var t;if(n)for(t in n)this.appInfo.appDomainRoot.addDefine(n[t],this.appInfo.appSWFParse);this.tag_RefsLoaded=!0;this.tag_Loaded&&this.parseSuccess()}}),Object.defineProperty(t.prototype,"parseSuccess",{value:function(){var t=null,n=null;this.tag_AllTagDefines.hasOwnProperty(0)&&(t=this.tag_AllTagDefines[0],t.defineScene=this.tag_defineScene,t.isRoot=!0,n=this.tag_SymbolClass,n!=null&&(n.nameAndTag||(n.nameAndTag={}),n.idAndNames.forEach(function(t,i){var r=null;r=this.tag_AllTagDefines[i];r&&t.forEach(function(t){t=this.appDomain.checkName(t);r.symbolClassName=t;n.nameAndTag[t]=r;i==0&&(this.content=r)},this)},this)),this.content||(this.content=t));this.parseSuccess_createTexture()}}),Object.defineProperty(t.prototype,"parseSuccess_createTexture",{value:function(){if(this.loadImageNum>0){window.setTimeout(_$ES.F.bind(this.parseSuccess_createTexture,this),64);return}var n=this.appInfo;if(n.renderMode===2)_$ES.F.traceLog("不创建矢量图"),this.parseSuccess_checkAudioDecode();else switch(n.source.textureCreateTime){case"run":this.appInfo.textureManage.createTexture_runTime(this,0,_$ES.F.bind(this.parseSuccess_checkAudioDecode,this));break;default:case"load":this.appInfo.textureManage.createTexture_loadTime(this,0,_$ES.F.bind(this.parseSuccess_checkAudioDecode,this));break;case"convert":this.parseSuccess_checkAudioDecode()}}}),Object.defineProperty(t.prototype,"parseSuccess_checkAudioDecode",{value:function(){if(this.decodeAudioNum>0){window.setTimeout(_$ES.F.bind(this.parseSuccess_checkAudioDecode,this),64);return}window.setTimeout(_$ES.F.bind(this.parseSuccess_checkFiles,this),16)}}),Object.defineProperty(t.prototype,"parseSuccess_checkFiles",{value:function(){if(this.loadFileNum>0){window.setTimeout(_$ES.F.bind(this.parseSuccess_checkFiles,this),64);return}window.setTimeout(this.onSuccess,16)}}),Object.defineProperty(t.prototype,"unload",{value:function(n){var t=null;for(var i in this.tag_AllTagDefines)t=this.tag_AllTagDefines[i],this.clearTag(t),n!=null&&n(t)}}),Object.defineProperty(t.prototype,"clearTag",{value:function(n){var t=null,i=null;switch(n.tagType){case 14:t=n;t.soundDataOggURI=null;t.soundDataURI=null;t.soundData=null;t.soundData_ogg=null;t.audioBuffer=null;break;case 48:case 75:i=n;this.appInfo.fonts.splice(this.appInfo.fonts.indexOf(i),1);delete this.appInfo.fontsDic[i.name]}}}),Object.defineProperty(t.prototype,"getStrokeWidth",{value:function(n,t){return n.transformLineWidth(t)}}),Object.defineProperty(t.prototype,"getSymbolClass",{value:function(n){return n?this.getSymbolClassByName(n.symbolClassName):null}}),Object.defineProperty(t.prototype,"getSymbolClassByName",{value:function(n){return this.appDomain.getClass(n)}}),function(){}.call(t),t},function(){n["_$ES.SWFParse"]=n["_$ES.SWFParse"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"SWFParse",{get:function(){return t===undefined&&(t=null,t=i(),delete n.SWFParse,n.SWFParse=t["_$ES.SWFParse"]),t["_$ES.SWFParse"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.AppDomain"]=function(n){function t(t,i,r){i===undefined&&(i=null);r===undefined&&(r=null);n.call(this);this.childs=[];this.defines={};this.appInfo=t;this.defineSource=r||{url:"",defines:{}};this.soList=[];i&&i.addChild(this)}return t.prototype.soList=undefined,t.prototype.defineSource=undefined,Object.defineProperty(t.prototype,"getDefine",{value:function(n){return this.defineSource.defines[n]}}),Object.defineProperty(t.prototype,"addDefine_Code",{value:function(n,t){try{new Function(n)()}catch(i){_$ES.F.error(t.appInfo,"部分代码解析失败，应用可能无法正常运行！ ",[n])}return this.addDefineList(_$ES.Define(null,null,null),t)}}),Object.defineProperty(t.prototype,"addDefineList",{value:function(n,t){for(var i=null,r=n.slice();n.length>0;)i=n.pop(),this.addDefine(i,t);return r}}),Object.defineProperty(t.prototype,"removeBySwfParse",{value:function(n){var r=null,t=NaN,e=NaN,o=NaN,i=null,l=this.soList,s=n.so,c;s&&(o=this.soList.indexOf(s),this.soList.splice(o,1));var u=this.defineSource.defines,h=this.defines,f=[];for(c in u)r=u[c],r.swfParseId==n.id&&f.push(r.fullName);for(t=0,e=f.length;t<e;)i=f[t],delete u[i],h.hasOwnProperty(i)&&delete h[i],t++;l.length==0&&this.parent&&this.parent.removeChild(this)}}),Object.defineProperty(t.prototype,"addDefine",{value:function(n,t){var i=null,h=null,r=null,s=null,e=null,f=null,u=null,o=t.so;if(o||(o=new _$ES.SO(this.appInfo,this,t),this.soList.push(o)),n.swfParseId=t.id,i=n.fullName,this.defineSource.defines[i]||(this.defineSource.defines[i]=n),!this.defines.hasOwnProperty(i)&&!(n.fun==null)&&(h=this.defineSource,r={def:n,name:i,so:o,d:undefined},s={get:function(){return r.d===undefined&&(r.d=null,r.d=r.def.fun(r.so)),r.d},configurable:!0},Object.defineProperty(this.defines,i,s),this.appInfo.source.from==="javascript"&&!_$ES.F.isInWorker()))for(e=_$ES.F.getNSByFullName(i),e.unshift("_$AS"),u=self;f=e.shift();)e.length!=0||u===self?u=f in u?u[f]:u[f]={}:Object.defineProperty(u,f,{get:function(){return s.get()[i]},configurable:!0});return n}}),t.prototype.appInfo=undefined,t.prototype.defines=undefined,t.prototype.parent=undefined,t.prototype.childs=undefined,t.prototype.domainMemory=undefined,Object.defineProperty(t.prototype,"addChild",{value:function(n){return n?(n.parent&&n.parent.removeChild(n),n.parent=this,this.childs.push(n)):0}}),Object.defineProperty(t.prototype,"removeChild",{value:function(n){n.parent=null;var t=this.childs.indexOf(n);t>=0&&this.childs.splice(t,1)}}),Object.defineProperty(t.prototype,"getDefineAppDomain",{value:function(n,t){t===undefined&&(t=!0);var r=null,f=null,u=0,i=null;if(this.parent&&(i=this.parent.getDefineAppDomain(n)),!i&&this.defines.hasOwnProperty(n)&&(i=this),i==null&&t&&(r=this.getGenericParamTypeNames(n),r)){for(f=[],u=0;u<r.length;)f.push(this.getClass(r[u])),u++;return this.appInfo.typeManage.get(this.getClass(this.getGenericTypeName(n))).makeGeneric(f),this.root}return i}}),Object.defineProperty(t.prototype,"checkName",{value:function(n){var f=null,i=null,u=null,r=0,t=0;if(n.indexOf(".<")!=-1){if(f=this.checkName(this.getGenericTypeName(n)),i=this.getGenericParamTypeNames(n),u=[],i!=null)for(r=0;r<i.length;)u.push(this.checkName(i[r])),r++;return f+".<"+u.join(",")+">"}return n=="Vector"?n="__AS3__.vec::Vector":(t=n.indexOf("::"),t==-1&&(t=n.lastIndexOf("."),t!=-1&&(n=n.substr(0,t)+"::"+n.substr(t+1,n.length-(t+1))))),n}}),Object.defineProperty(t.prototype,"getClass",{value:function(n,t){t===undefined&&(t=!0);var i=null;return n&&(t&&(n=this.checkName(n)),i=this.getClassGlobalObject(n,!1),i!=null)?i[n]:null}}),Object.defineProperty(t.prototype,"getClassGlobalObject",{value:function(n,t){t===undefined&&(t=!0);t&&(n=this.checkName(n));var i=this.getDefineAppDomain(n);return i?i.defines[n]:null}}),Object.defineProperty(t.prototype,"hasClass",{value:function(n,t){t===undefined&&(t=!0);t&&(n=this.checkName(n));var i=this.getDefineAppDomain(n,!1);return i?!0:!1}}),Object.defineProperty(t.prototype,"getGenericTypeName",{value:function(n){var t=null,i=/^[^<]*/.exec(n);return!(i==null)&&i.length>0?(t=i[0],t[t.length-1]=="."&&(t=t.substr(0,t.length-1)),t):null}}),Object.defineProperty(t.prototype,"getGenericParamTypeNames",{value:function(n){var t=/<(.*)>/.exec(n);return t&&t.length>0?t[1].split(","):null}}),Object.defineProperty(t.prototype,"isRoot",{get:function(){return this.parent==null},set:undefined}),Object.defineProperty(t.prototype,"root",{get:function(){return this.parent!=null?this.parent.root:this},set:undefined}),function(){}.call(t),t},function(){n["_$ES.AppDomain"]=n["_$ES.AppDomain"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"AppDomain",{get:function(){return t===undefined&&(t=null,t=i(),delete n.AppDomain,n.AppDomain=t["_$ES.AppDomain"]),t["_$ES.AppDomain"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.ESFastLinkedListIterator"]=function(n){function t(){n.call(this)}return t.prototype.list=undefined,t.prototype.currentNode=undefined,Object.defineProperty(t.prototype,"next",{value:function(){var n=this.currentNode,t=null;return this.currentNode=n?n=n.nextNode:n=this.list.firstNode,n&&(t=n.obj),t}}),t.iteratorList=undefined,Object.defineProperty(t,"pop",{value:function(n,i){var r=_$ES.ESFastLinkedListIterator.iteratorList.pop()||new t;return r.currentNode=i,r.list=n,r}}),Object.defineProperty(t,"push",{value:function(n){n.currentNode=null;n.list=null;_$ES.ESFastLinkedListIterator.iteratorList.push(n)}}),function(){this.iteratorList=[]}.call(t),t},function(){n["_$ES.ESFastLinkedListIterator"]=n["_$ES.ESFastLinkedListIterator"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"ESFastLinkedListIterator",{get:function(){return t===undefined&&(t=null,t=i(),delete n.ESFastLinkedListIterator,n.ESFastLinkedListIterator=t["_$ES.ESFastLinkedListIterator"]),t["_$ES.ESFastLinkedListIterator"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.GL.TEMP_Main_REMOVED"]=function(n){function t(){n.call(this)}return function(){}.call(t),t},function(){n["_$ES.GL.TEMP_Main_REMOVED"]=n["_$ES.GL.TEMP_Main_REMOVED"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};n=n.GL=n.GL||{};Object.defineProperty(n,"TEMP_Main_REMOVED",{get:function(){return t===undefined&&(t=null,t=i(),delete n.TEMP_Main_REMOVED,n.TEMP_Main_REMOVED=t["_$ES.GL.TEMP_Main_REMOVED"]),t["_$ES.GL.TEMP_Main_REMOVED"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.SO"]=function(n){function t(t,i,r){n.call(this);this.appInfo=t;this.appDomain=i;this.swfParse=r;this._values=[];r.so=this;this.js=function(){return this||eval("this")}()}return t.prototype.swfParse=undefined,t.prototype.appInfo=undefined,t.prototype.appDomain=undefined,t.prototype.js=undefined,t.prototype._values=undefined,t.prototype._valueCurrent=undefined,Object.defineProperty(t.prototype,"v",{get:function(){var n=this._valueCurrent;return this._valueCurrent=this._values.pop(),n},set:function(n){this._values.push(this._valueCurrent);this._valueCurrent=n}}),Object.defineProperty(t.prototype,"getClass",{value:function(n){return this.appDomain?this.appDomain.getClass(n,!1):null}}),Object.defineProperty(t.prototype,"createScope",{value:function(n,t){for(var i,u=[],r=2,f=arguments.length;r<f;r++)u.push(arguments[r]);return i=new _$ES.Scope(this,n),i._$push(t),i._$reg.apply(i,u),i}}),Object.defineProperty(t.prototype,"createMethodScope",{value:function(n,t,i){var r=new _$ES.Scope(this,null);return r._$parentScope=n,i&&r._$push(i),r._$push(t),r}}),Object.defineProperty(t.prototype,"_as",{value:function(n,t){return this.appInfo.typeManage.AS(n,t)}}),Object.defineProperty(t.prototype,"_is",{value:function(n,t){return this.appInfo.typeManage.IS(n,t)}}),Object.defineProperty(t.prototype,"setFuncSO",{value:function(n){n&&(n._$SO=this)}}),Object.defineProperty(t.prototype,"writeMemberName",{value:function(n,t,i){n&&i&&t&&(Object.hasOwnProperty.call(n,t)||Object.defineProperty(n,t,{value:[],enumeralbe:!1,configurable:!1}),n[t].push(i))}}),Object.defineProperty(t.prototype,"defProp",{value:function(n,t,i,r){var u=null;u=i&&r?{get:i,set:r,enumeralbe:!1,configurable:!0}:i?{get:i,enumeralbe:!1,configurable:!0}:{set:r,enumeralbe:!1,configurable:!0};Object.defineProperty(n,t,u);this.writeMemberName(n,"_$PropArray",t)}}),Object.defineProperty(t.prototype,"defConstField",{value:function(n,t,i){i===undefined&&(i=undefined);Object.defineProperty(n,t,{value:i,writable:!0,enumeralbe:!1,configurable:!0});this.writeMemberName(n,"_$ConstArray",t)}}),Object.defineProperty(t.prototype,"defField",{value:function(n,t,i){i===undefined&&(i=undefined);Object.defineProperty(n,t,{value:i,writable:!0,enumeralbe:!1,configurable:!0});this.writeMemberName(n,"_$FieldArray",t)}}),Object.defineProperty(t.prototype,"defFunc",{value:function(n,t,i,r){r&&(i=_$ES.F.bind(i,r));Object.defineProperty(n,t,{value:i,enumeralbe:!1,configurable:!0})}}),Object.defineProperty(t.prototype,"newFunc",{value:function(n){return n}}),Object.defineProperty(t.prototype,"defMethod",{value:function(n,t,i){var u=this,r=function(){var n;return Object.prototype.hasOwnProperty.call(this,"_$isprototype")?i:(n=i.bind(this),Object.defineProperty(this,t,{value:n,writable:!0,enumeralbe:!1,configurable:!1}),n)};return Object.defineProperty(n,t,{get:r,enumeralbe:!1,configurable:!0}),Object.defineProperty(n,"_$$"+t,{value:i,enumeralbe:!1,configurable:!0}),this.writeMemberName(n,"_$MethodArray",t),r}}),Object.defineProperty(t.prototype,"isInstantiate",{value:function(n,t){return n instanceof t}}),Object.defineProperty(t.prototype,"isConstructorSuperCall",{value:function(n,t){return n instanceof t&&!(n.constructor===t)}}),Object.defineProperty(t.prototype,"isConstructorCall",{value:function(n,t){return!this.isInstantiate(n,t)&&!this.isConstructorSuperCall(n,t)}}),Object.defineProperty(t.prototype,"castArgs",{value:function(n,t){return this.appInfo.typeManage.CAST_SimpleArgs(n,t)}}),Object.defineProperty(t.prototype,"cast",{value:function(n,t){return this.appInfo.typeManage.CAST(n,t)}}),Object.defineProperty(t.prototype,"castString",{value:function(n){return n==null?null:String(n)}}),Object.defineProperty(t.prototype,"player",{get:function(){return this.appInfo.player},set:undefined}),function(){}.call(t),t},function(){n["_$ES.SO"]=n["_$ES.SO"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"SO",{get:function(){return t===undefined&&(t=null,t=i(),delete n.SO,n.SO=t["_$ES.SO"]),t["_$ES.SO"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.GL.Utils"]=function(n){function t(){n.call(this)}return Object.defineProperty(t,"toWebGLCoordinate",{value:function(n,t,i,r){return new _$ES.Geoms.ESPoint((n-i/2)/(i/2),(t-r/2)/(r/2))}}),Object.defineProperty(t,"rectToWebGlCoordinate",{value:function(n,t){return new _$ES.Geoms.ESRectangle((n.x-t/2)/(t/2),(t/2-n.y)/(t/2),n.width*2/t,n.height*2/t)}}),Object.defineProperty(t,"initShaders",{value:function(n,t,i){var r=null,u=null,f=n.createShader(n.VERTEX_SHADER);return n.shaderSource(f,t),n.compileShader(f),n.getShaderParameter(f,n.COMPILE_STATUS)?(r=n.createShader(n.FRAGMENT_SHADER),n.shaderSource(r,i),n.compileShader(r),n.getShaderParameter(r,n.COMPILE_STATUS)?(u=n.createProgram(),n.attachShader(u,f),n.attachShader(u,r),n.linkProgram(u)):_$ES.F.error(null,n.getShaderInfoLog(r))):_$ES.F.error(null,n.getShaderInfoLog(f)),u}}),function(){}.call(t),t},function(){n["_$ES.GL.Utils"]=n["_$ES.GL.Utils"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};n=n.GL=n.GL||{};Object.defineProperty(n,"Utils",{get:function(){return t===undefined&&(t=null,t=i(),delete n.Utils,n.Utils=t["_$ES.GL.Utils"]),t["_$ES.GL.Utils"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.CanvasAllocator"]=function(n){function t(t,i,r,u,f){r===undefined&&(r=!0);u===undefined&&(u=10);f===undefined&&(f=10);n.call(this);this.w=t;this.h=i;this.minW=u;this.minH=f;this.spriteList=[];this.createCanvas=r}return t.prototype.minW=undefined,t.prototype.minH=undefined,t.prototype.createCanvas=!1,Object.defineProperty(t.prototype,"pop",{value:function(n,t){for(var i=null,f=this.spriteList,u=null,r=0,e=this.spriteList.length;r<e;){if(u=f[r],i=u.pop(n,t))break;r++}if(i||(i=this.createSprite().pop(n,t)),!i)throw new Error("未能从池中分配_$CanvasInfo对象");return i}}),Object.defineProperty(t.prototype,"push",{value:function(n){n.sprite.push(n)}}),t.prototype.id=0,t.prototype.spriteList=undefined,Object.defineProperty(t.prototype,"createSprite",{value:function(){this.spriteList||(this.spriteList=[]);var n=new _$ES.CanvasSprite(this,this.w,this.h);return this.spriteList.push(n),n}}),t.prototype.w=undefined,t.prototype.h=undefined,function(){}.call(t),t},function(){n["_$ES.CanvasAllocator"]=n["_$ES.CanvasAllocator"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"CanvasAllocator",{get:function(){return t===undefined&&(t=null,t=i(),delete n.CanvasAllocator,n.CanvasAllocator=t["_$ES.CanvasAllocator"]),t["_$ES.CanvasAllocator"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.GL.ShaderBase"]=function(n){function t(){this.cacheRenderInfoList=[];n.call(this)}return t.prototype.program=undefined,t.prototype.glRender=undefined,Object.defineProperty(t.prototype,"createGLProgram",{value:function(){return null}}),Object.defineProperty(t.prototype,"drawPre",{value:function(){}}),Object.defineProperty(t.prototype,"draw",{value:function(){}}),t.prototype.cacheRenderInfoList=undefined,t.prototype.cacheGLTexture=undefined,Object.defineProperty(t.prototype,"cache",{value:function(){return!1}}),Object.defineProperty(t.prototype,"vertex",{get:function(){return""},set:undefined}),Object.defineProperty(t.prototype,"fragment",{get:function(){return""},set:undefined}),function(){}.call(t),t},function(){n["_$ES.GL.ShaderBase"]=n["_$ES.GL.ShaderBase"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};n=n.GL=n.GL||{};Object.defineProperty(n,"ShaderBase",{get:function(){return t===undefined&&(t=null,t=i(),delete n.ShaderBase,n.ShaderBase=t["_$ES.GL.ShaderBase"]),t["_$ES.GL.ShaderBase"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.GL.ShaderDefault"]=function(n){function t(t){n.call(this);this.glRender=t;this.createGLProgram()}return _$ES.F._extends(t,n),t.prototype.a_position=undefined,t.prototype.a_texCoord=undefined,t.prototype.u_orthoMatrix=undefined,t.prototype.u_sampler=undefined,t.prototype.u_samplerClip=undefined,t.prototype.u_clipHeight=undefined,t.prototype.u_clipWidth=undefined,t.prototype.u_clipOffset=undefined,t.prototype.u_IsClip=undefined,t.prototype.u_offset=undefined,Object.defineProperty(t.prototype,"createGLProgram",{value:function(){var n=this.glRender.gl,t=this.program=_$ES.GL.Utils.initShaders(n,this.vertex,this.fragment);return this.a_position=n.getAttribLocation(t,"a_Position"),this.a_texCoord=n.getAttribLocation(t,"a_TexCoord"),this.u_orthoMatrix=n.getUniformLocation(t,"u_OrthoMatrix"),this.u_sampler=n.getUniformLocation(t,"u_Sampler"),this.u_samplerClip=n.getUniformLocation(t,"u_SamplerClip"),this.u_clipWidth=n.getUniformLocation(t,"u_ClipWidth"),this.u_clipHeight=n.getUniformLocation(t,"u_ClipHeight"),this.u_clipOffset=n.getUniformLocation(t,"u_ClipOffset"),this.u_offset=n.getUniformLocation(t,"u_Offset"),this.u_IsClip=n.getUniformLocation(t,"u_IsClip"),t}}),Object.defineProperty(t.prototype,"drawPre",{value:function(){var i=null,e=this.cacheRenderInfoList,r=this.cacheGLTexture,t=this.glRender,n=t.gl,u,f;t.stateCurrentShader!=this&&(t.stateCurrentShader=this,n.useProgram(this.program));u=4;f=Float32Array.BYTES_PER_ELEMENT;n.uniform1i(this.u_sampler,t.bindTexture(n,r)._$bindTargetIndex);(i=t.stateCurrentClip)?(n.uniform1i(this.u_samplerClip,t.bindTexture(n,i)._$bindTargetIndex),n.uniform1f(this.u_clipWidth,i._$w),n.uniform1f(this.u_clipHeight,i._$h),n.uniform2f(this.u_clipOffset,i._$offsetX,i._$offsetY),n.uniform1i(this.u_IsClip,i._$isClip?1:0)):n.uniform1f(this.u_clipWidth,0);n.uniformMatrix4fv(this.u_orthoMatrix,!1,t.orthoMatrix.elements);n.uniform2f(this.u_offset,t.stateOffsetX,t.stateOffsetY)}}),t.prototype.isFirstBind=!0,Object.defineProperty(t.prototype,"draw",{value:function(){var t=NaN,i=NaN,r=NaN,n=null,f=null,u=this.cacheRenderInfoList;this.cacheGLTexture&&(t=u.length)&&(i=u[0].textureVDataInBufferIndex/4,r=t*6,n=this.glRender.gl,this.drawPre(),n.drawArrays(n.TRIANGLES,i,r),f=this.glRender,this.cacheGLTexture=null,this.cacheRenderInfoList.length=0)}}),Object.defineProperty(t.prototype,"cache",{value:function(n){var t=null;return n&&n.textureInfo&&(t=this.glRender.getGLTexture(n.textureInfo),t&&(!this.cacheGLTexture||t==this.cacheGLTexture||this.draw(),this.cacheGLTexture=t,this.cacheRenderInfoList.push(n))),!0}}),Object.defineProperty(t.prototype,"vertex",{get:function(){return" attribute vec4 a_Position;\n attribute vec2 a_TexCoord;\n //attribute vec4 a_Mat_p1;\n //attribute vec2 a_Mat_p2;\n uniform mat4 u_OrthoMatrix;\n //uniform mat4 u_Matrix;\n uniform vec2 u_Offset;\n varying vec2 v_TexCoord;\n varying vec2 v_Position;\nvoid main(){\n vec4 vec_Position= /*mat_Model **/ vec4(a_Position.x,a_Position.y,0.0,1.0) ;\n v_Position= vec2(vec_Position.x ,vec_Position.y); vec_Position.x =vec_Position.x+u_Offset.x; //floor(vec_Position.x+u_Offset.x+0.5);\n vec_Position.y =vec_Position.y+u_Offset.y; //floor(vec_Position.y+u_Offset.y+0.5);\n gl_Position = u_OrthoMatrix * vec_Position; v_TexCoord=a_TexCoord;}\n"},set:function(t){_$ES.F.setSuperProperty(this,n,"vertex",t)}}),Object.defineProperty(t.prototype,"fragment",{get:function(){return"precision mediump float;\n uniform sampler2D u_Sampler;\n uniform sampler2D u_SamplerClip;\n uniform float u_ClipWidth;\n uniform float u_ClipHeight;\n uniform vec2 u_ClipOffset;\n uniform bool u_IsClip;\n uniform bool u_HasColor; \n uniform vec4 u_Color; \n varying vec2 v_TexCoord;\n varying vec2 v_Position;\nvoid main(){\n vec4 v_Color = u_HasColor? u_Color : texture2D(u_Sampler,v_TexCoord); if (u_ClipWidth>0.0){ vec2 vec_ClipPosition = vec2((v_Position.x+u_ClipOffset.x)/u_ClipWidth,(v_Position.y+u_ClipOffset.y)/u_ClipHeight); if (vec_ClipPosition.x<0.0 || vec_ClipPosition.y<0.0 || vec_ClipPosition.x>1.0 || vec_ClipPosition.y>1.0){ v_Color.a = 0.0;  v_Color.r = 0.0;  v_Color.g = 0.0;  v_Color.b = 0.0; } else{ vec4 v_Color2 = texture2D(u_SamplerClip,vec_ClipPosition);  float v_Color2_alpha = v_Color2.a ; v_Color.a = v_Color.a*v_Color2_alpha;  v_Color.r = v_Color.r*v_Color2_alpha;  v_Color.g = v_Color.g*v_Color2_alpha;  v_Color.b = v_Color.b*v_Color2_alpha; } } gl_FragColor= v_Color;//texture2D(u_Sampler,v_TexCoord);\n}\n"},set:function(t){_$ES.F.setSuperProperty(this,n,"fragment",t)}}),function(){}.call(t),t},function(){n["_$ES.GL.ShaderDefault"]=n["_$ES.GL.ShaderDefault"](_$ES.GL.ShaderBase)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};n=n.GL=n.GL||{};Object.defineProperty(n,"ShaderDefault",{get:function(){return t===undefined&&(t=null,t=i(),delete n.ShaderDefault,n.ShaderDefault=t["_$ES.GL.ShaderDefault"]),t["_$ES.GL.ShaderDefault"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.GL.ShaderCT"]=function(n){function t(t){n.call(this,t)}return _$ES.F._extends(t,n),Object.defineProperty(t.prototype,"createGLProgram",{value:function(){var i=this.glRender.gl,t=n.prototype.createGLProgram.call(this);return this.u_ct1=i.getUniformLocation(t,"u_CT1"),this.u_ct2=i.getUniformLocation(t,"u_CT2"),t}}),t.prototype.u_ct1=undefined,t.prototype.u_ct2=undefined,Object.defineProperty(t.prototype,"drawPre",{value:function(){n.prototype.drawPre.call(this);var i=this.glRender.gl,t=this.cacheCT;i.uniform4f(this.u_ct1,t.redMultiplier,t.redOffset,t.greenMultiplier,t.greenOffset);i.uniform4f(this.u_ct2,t.blueMultiplier,t.blueOffset,t.alphaMultiplier,t.alphaOffset)}}),Object.defineProperty(t.prototype,"draw",{value:function(){this.cacheCT&&(n.prototype.draw.call(this),this.cacheCT=null)}}),t.prototype.cacheCT=undefined,Object.defineProperty(t.prototype,"cache",{value:function(n){var t=null,i=null;return n&&n.textureInfo&&(t=this.glRender.getGLTexture(n.textureInfo),i=n.playerCT,i&&t&&(!this.cacheGLTexture||!this.cacheCT||t==this.cacheGLTexture&&i.compare(this.cacheCT)||this.draw(),this.cacheGLTexture=t,this.cacheCT=i,this.cacheRenderInfoList.push(n))),!0}}),Object.defineProperty(t.prototype,"vertex",{get:function(){return _$ES.F.getSuperProperty(this,n,"vertex")},set:function(t){_$ES.F.setSuperProperty(this,n,"vertex",t)}}),Object.defineProperty(t.prototype,"fragment",{get:function(){return"precision mediump float;\n uniform sampler2D u_Sampler;\n uniform sampler2D u_SamplerClip;\n uniform float u_ClipWidth;\n uniform float u_ClipHeight;\n uniform vec2 u_ClipOffset;\n varying vec2 v_TexCoord;\n varying vec2 v_Position;\n uniform vec4 u_CT1;\n uniform vec4 u_CT2;\nvoid main(){\n vec4 v_Color = texture2D(u_Sampler,v_TexCoord); float f_alpha = 1.0; if (u_ClipWidth>0.0){ vec2 vec_ClipPosition = vec2((v_Position.x+u_ClipOffset.x)/u_ClipWidth,(v_Position.y+u_ClipOffset.y)/u_ClipHeight); if (vec_ClipPosition.x<0.0 || vec_ClipPosition.y<0.0 || vec_ClipPosition.x>1.0 || vec_ClipPosition.y>1.0){ f_alpha = 0.0; } else{ vec4 v_Color2 = texture2D(u_SamplerClip,vec_ClipPosition);  f_alpha = v_Color2.a; } } if (v_Color.a==0.0){ f_alpha=v_Color.a=u_CT2[3]/255.0*f_alpha; v_Color.r=u_CT1[1]/255.0*f_alpha; v_Color.g=u_CT1[3]/255.0*f_alpha; v_Color.b=u_CT2[1]/255.0*f_alpha;}else{  f_alpha = (v_Color.a*u_CT2[2]+ u_CT2[3]/255.0) * f_alpha;  v_Color.r = (v_Color.r/v_Color.a*u_CT1[0]+ u_CT1[1]/255.0) * f_alpha;  v_Color.g = (v_Color.g/v_Color.a*u_CT1[2]+ u_CT1[3]/255.0) * f_alpha;  v_Color.b = (v_Color.b/v_Color.a*u_CT2[0]+ u_CT2[1]/255.0) * f_alpha;  v_Color.a = f_alpha; } gl_FragColor= v_Color;//texture2D(u_Sampler,v_TexCoord);\n}\n"},set:function(t){_$ES.F.setSuperProperty(this,n,"fragment",t)}}),function(){}.call(t),t},function(){n["_$ES.GL.ShaderCT"]=n["_$ES.GL.ShaderCT"](_$ES.GL.ShaderDefault)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};n=n.GL=n.GL||{};Object.defineProperty(n,"ShaderCT",{get:function(){return t===undefined&&(t=null,t=i(),delete n.ShaderCT,n.ShaderCT=t["_$ES.GL.ShaderCT"]),t["_$ES.GL.ShaderCT"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.SystemLibLoader"]=function(n){function t(t){n.call(this);this.defineSource=t;this.loadFullNames=[];this.loadFullNamesDic={};this.loadedFullNames=[];this.loadErrFullNames=[]}return t.prototype.defineSource=undefined,t.prototype.loadFullNamesDic=undefined,t.prototype.loadFullNames=undefined,t.prototype.loadedFullNames=undefined,t.prototype.loadErrFullNames=undefined,Object.defineProperty(t.prototype,"isLoad",{value:function(n){return this.loadFullNamesDic.hasOwnProperty(n)||this.defineSource.defines.hasOwnProperty(n)}}),Object.defineProperty(t.prototype,"isLoad2",{value:function(n){var t=null,i=null;return(t={},i=function(n){var r,u;if(t.hasOwnProperty(n)||this.loadErrFullNames.indexOf(n)>=0)return!0;if(r=this.defineSource.defines[n],r==null)return!1;for(t[n]=r,u=0;u<r.refs.length;){if(!i.call(this,r.refs[u]))return!1;u++}return!0},i.call(this,n))?t:null}}),Object.defineProperty(t.prototype,"add",{value:function(n){this.isLoad(n)||(this.loadFullNamesDic[n]=null,this.loadFullNames.push(n))}}),Object.defineProperty(t.prototype,"addList",{value:function(n){for(var t=0;t<n.length;)this.add(n[t]),t++}}),Object.defineProperty(t.prototype,"loadDefines",{value:function(n,t,i,r,u){if(i===undefined&&(i=null),r===undefined&&(r=null),u===undefined&&(u=null),n==null||!(n instanceof Array)||n.length==0){t!=null&&t();return}this.addList(n);this.load();this.checkAllSuccess({fullName:n,onAllSuccess:t,onSuccess:i,onProgress:r,onFail:u})}}),Object.defineProperty(t.prototype,"checkAllSuccess",{value:function(n){var i=null,t=0,r,e=null,u=!0,f={};if(n!=null)for(t=0;t<n.fullName.length;){if((i=this.isLoad2(n.fullName[t]))==null){u=!1;break}else for(r in i)f[r]=i[r];t++}if(u){if(e='["'+this.loadedFullNames.join('","')+'"]',n.onAllSuccess!=null)n.onAllSuccess(f);return}window.setTimeout(_$ES.F.bind(this.checkAllSuccess,this),16,n)}}),Object.defineProperty(t.prototype,"load",{value:function(){for(var n=null,t=null;this.loadFullNames.length>0;)n=this.loadFullNames.pop(),t=n.replace("::",".")+".js",this.loadedFullNames.push(t),_$ES.F.addScript(_$ES.F.combineUrl(t,this.defineSource.url),_$ES.F.bind(this.loadFun,this),_$ES.F.bind(this.loadErrorFunc,this))._$fullName=n}}),Object.defineProperty(t.prototype,"loadErrorFunc",{value:function(n){var t=n.target,i=t._$fullName;this.loadErrFullNames.push(i)}}),Object.defineProperty(t.prototype,"loadFun",{value:function(){for(var t=null,r=null,i=_$ES.Define(null,null,null),n=0,u=i.length;n<u;)t=i[n],r=t.fullName,this.defineSource.defines[r]=t,n++;for(n=0;n<u;)this.addList(i.pop().refs),n++;this.load()}}),function(){}.call(t),t},function(){n["_$ES.SystemLibLoader"]=n["_$ES.SystemLibLoader"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"SystemLibLoader",{get:function(){return t===undefined&&(t=null,t=i(),delete n.SystemLibLoader,n.SystemLibLoader=t["_$ES.SystemLibLoader"]),t["_$ES.SystemLibLoader"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.Draw.DrawShape"]=function(n){function t(t,i,r,u,f,e,o,s){e===undefined&&(e=!1);o===undefined&&(o=0);s===undefined&&(s=!1);n.call(this);this.ctx=t;this.m=i;this.ct=r;this.isClip=f;this.swfParse=u;this.usesFillWindingRule=e;this.ratio=o;this.writeBounds=s;s&&(this.rect=new _$ES.Geoms.ESRectangle,this.bounds=new _$ES.Geoms.ESRectangle)}return t.prototype.ctx=undefined,t.prototype.m=undefined,t.prototype.ct=undefined,t.prototype.isClip=!1,t.prototype.usesFillWindingRule=!1,t.prototype.ratio=0,t.prototype.writeBounds=!1,t.prototype.rect=undefined,t.prototype.bounds=undefined,t.prototype.swfParse=undefined,Object.defineProperty(t.prototype,"mathBounds",{value:function(n,t){t===undefined&&(t=!1);var u=NaN,e=NaN,f=NaN,o=NaN,i=null,r=null,s,h=NaN,c=this.writeBounds;for(this.writeBounds=!0,(!this.rect||t)&&(this.rect=new _$ES.Geoms.ESRectangle),(!this.bounds||t)&&(this.bounds=new _$ES.Geoms.ESRectangle),u=0,e=n.segGroupList.length;u<e;){for(r=n.segGroupList[u],f=0,o=r.SegmentList.length;f<o;)i=r.SegmentList[f],i.isReversion&&(i=r.SegmentList[i.reversionSourceIndex-1]),s=r.LineStyleList[i.lineStyleIndex-1],h=this.drawGetLineWidth(s),this.drawPath(i.commands,i.data,!1,!0,h,i.morphRatioDeltaData),f++;u++}this.writeBounds=c}}),Object.defineProperty(t.prototype,"draw",{value:function(n){var r=null,h=NaN,l=NaN,i=NaN,e=NaN,t=null,u=null,f=null,s=null,a=null,o,c,v;for(r=this.ctx,o=this.m,c=this.isClip,r.setTransform(o.a,o.b,o.c,o.d,o.tx,o.ty),r.save(),v=o.transformLineWidth(2),h=0,l=n.segGroupList.length;h<l;){for(f=n.segGroupList[h],i=0,e=f.SegmentList.length;i<e;)t=f.SegmentList[i],t.lineStyleIndex==0&&t.fillStyle0Index>0&&t.fillStyle1Index>0&&(r.beginPath(),this.drawPath(t.commands,t.data,!1,!0,1,t.morphRatioDeltaData),r.lineWidth=v,this.drawFill(f.FillStyleList[t.fillStyle0Index-1],null,!0)),i++;for(i=0,e=f.FigureList.length;i<e;)a=f.FigureList[i],c||r.beginPath(),this.drawPathFigure(f,a,!1),i++;if(c)return r.restore(),r;for(s=[],i=0,e=f.SegmentList.length;i<e;)t=f.SegmentList[i],t.lineStyleIndex>0&&(u=s[t.lineStyleIndex],u||(u=[],s[t.lineStyleIndex]=u),u.push(t)),i++;s.forEach(function(n,o){var h,c=NaN;if(o>0&&(h=f.LineStyleList[o-1],u=s[o],c=this.drawGetLineWidth(h),!(u==null)&&u.length>0)){for(r.beginPath(),i=0,e=u.length;i<e;)t=u[i],this.drawPath(t.commands,t.data,!1,!0,c,t.morphRatioDeltaData),i++;this.drawLine(h)}},this);h++}return r.restore(),r}}),Object.defineProperty(t.prototype,"drawGlyphShape",{value:function(n){for(var t=null,i=NaN,u=NaN,r=0;r<n.segGroupList.length;){for(t=n.segGroupList[r],i=0,u=t.FigureList.length;i<u;)this.drawPathFigure(t,t.FigureList[i],!0),i++;r++}}}),Object.defineProperty(t.prototype,"isPointInShape",{value:function(n,t,i,r){for(var f=null,e=NaN,s=NaN,u=null,h=this.ctx,o=0,c=i.segGroupList.length;o<c;){for(f=i.segGroupList[o],e=0,s=f.FigureList.length;e<s;){if(u=f.FigureList[e],(this.ratio>0||n>=u.boundX&&t>=u.boundY&&n<=u.boundX+u.boundW&&t<=u.boundY+u.boundH)&&(!r||(h.beginPath(),this.drawPathFigure(f,f.FigureList[e],!0),h.isPointInPath(n,t,u.winding?u.winding:this.usesFillWindingRule?"nonzero":"evenodd"))))return!0;e++}o++}return!1}}),Object.defineProperty(t.prototype,"drawPathFigure",{value:function(n,t,i){i===undefined&&(i=!1);for(var r=NaN,f=NaN,o=NaN,u=null,e=!1,s=0,r=0,f=t.segmentIndex.length;r<f;)o=t.segmentIndex[r],u=n.SegmentList[o-1],e=!1,u.isReversion&&(u=n.SegmentList[u.reversionSourceIndex-1],e=!0),this.drawPath(u.commands,u.data,e,s==0,0,u.morphRatioDeltaData),s++,r++;if(t.childs)for(r=0,f=t.childs.length;r<f;)this.drawPathFigure(n,t.childs[r],!0),r++;!i&&!this.isClip&&t.fillStyleIndex>0&&this.drawFill(n.FillStyleList[t.fillStyleIndex-1],t.winding?t.winding:this.usesFillWindingRule?"nonzero":"evenodd")}}),Object.defineProperty(t.prototype,"drawPath",{value:function(n,t,i,r,u,f){r===undefined&&(r=!0);u===undefined&&(u=0);f===undefined&&(f=null);for(var s=NaN,h=NaN,l=NaN,a=NaN,k=NaN,d=NaN,b=null,tt=NaN,v=this.ctx,c=this.ratio,it=t.length-1,rt=i?t.length-1:0,e=rt,g=i?it-1:1,y=i?-1:1,o=i?-1:0,p=0,w=0,nt=this.writeBounds,ut=u/2,ft=0;ft<it;){e==rt&&(p=t[e+o],w=t[e+1+o],f&&(p=p+f[e+o]*c,w=w+f[e+1+o]*c),r&&v&&v.moveTo(p,w),e=e+2*y);tt=n[g];switch(tt){case 2:s=t[e+o];h=t[e+1+o];f&&(s=s+f[e+o]*c,h=h+f[e+1+o]*c);v&&v.lineTo(s,h);e=e+2*y;nt&&(b=_$ES.Geoms.ESRectangle.createByPointValue(p,w,s,h));break;case 3:l=t[e+o];a=t[e+1+o];f&&(l=l+f[e+o]*c,a=a+f[e+1+o]*c);e=e+2*y;s=t[e+o];h=t[e+1+o];f&&(s=s+f[e+o]*c,h=h+f[e+1+o]*c);e=e+2*y;v&&v.quadraticCurveTo(l,a,s,h);nt&&(b=_$ES.Geoms.ESRectangle.createByCurveBezier(p,w,l,a,s,h));break;case 6:l=t[e+o];a=t[e+1+o];f&&(l=l+f[e+o]*c,a=a+f[e+1+o]*c);e=e+2*y;k=t[e+o];d=t[e+1+o];f&&(k=k+f[e+o]*c,d=d+f[e+1+o]*c);e=e+2*y;s=t[e+o];h=t[e+1+o];f&&(s=s+f[e+o]*c,h=h+f[e+1+o]*c);e=e+2*y;v&&v.bezierCurveTo(l,a,k,d,s,h);nt&&(b=_$ES.Geoms.ESRectangle.createByBezier(p,w,l,a,k,d,s,h))}b&&(this.rect.unionIgnoreEmpty(b),this.bounds.unionIgnoreEmpty(b.inflate2(ut,ut)),p=s,w=h,b=null);g=g+y;ft++}}}),Object.defineProperty(t.prototype,"drawFill",{value:function(n,t,i){var l,d;i===undefined&&(i=!1);var r=null,e=NaN,o=null,u=null,w=null,b=null,a=null,v=null,s=null,k=null,g=null,f=NaN,h=null,c=NaN,y=NaN,nt=NaN,p=null,tt=null;r=this.ctx;l=this.ct;e=this.ratio;d=!1;switch(n.fillStyleType){case 0:w=_$ES.Temp.c1.setByInfo(n.colorRGBA).ratioByRGBAInfo(n.endColorRGBA,e);o=l?l.transform(w).toCssRGBA():w.toCssRGBA();break;case 19:case 16:case 18:for(u=_$ES.Geoms.ESMatrix.create(n.gradientMatrix).ratioByInfo(n.endGradientMatrix,e),a=u.transformPointValues(-16384,0),v=u.transformPointValues(16384,0),s=u.transformPointValues(0,0),b=n.fillStyleType==16?r.createLinearGradient(a.x,a.y,v.x,v.y):r.createRadialGradient(s.x,s.y,0,s.x,s.y,Math.abs((v.x-a.x)/2)),f=0;f<n.gradient.ratios.length;)h=_$ES.Geoms.ESColor.createByRGB(n.gradient.colors[f],n.gradient.alphas[f]),c=n.gradient.ratios[f],n.gradient.endColors&&typeof(y=n.gradient.endColors[f])=="number"&&(y=(y<<8|n.gradient.endAlphas[f]&255)>>>0,nt=n.gradient.endRatios[f],h=h.ratioByRGBANumber(y,e),c=c+(nt-c)/65535*e),b.addColorStop(c/255,l?l.transform(h).toCssRGBA():h.toCssRGBA()),f++;o=b;break;case 65:case 67:case 64:case 66:n.bitmapData?k=n.bitmapData._$getImageSource():(p=this.swfParse,tt=p.appInfo.textureManage.getTextureBySymbol(p.tag_AllTagDefines[n.bitmapId]),k=p.appInfo.renderManage.readPixelToImageSource(tt));g=r.createPattern(k,n.fillStyleType==65||n.fillStyleType==67?"no-repeat":"repeat");o=g;d=!0;r.save();u=_$ES.Geoms.ESMatrix.create(n.bitmapMatrix).ratioByInfo(n.bitmapMatrix,e);r.transform(u.a,u.b,u.c,u.d,u.tx,u.ty)}i?(r.strokeStyle=o,r.stroke()):(r.fillStyle=o,r.fill(t));d&&r.restore()}}),Object.defineProperty(t.prototype,"drawGetLineWidth",{value:function(n){var t=NaN,i;return n?(i=this.ratio,t=0+n.endWidth===n.endWidth&&i>0?n.width+(n.endWidth-n.width)/65535*i:n.width,t>0&&t<1&&(t=1),t):0}}),Object.defineProperty(t.prototype,"drawLine",{value:function(n){n&&(n.isLineStyle2?this.drawLineStyle2(n):this.drawLineStyle(n))}}),Object.defineProperty(t.prototype,"drawLineStyle",{value:function(n){var t=this.ctx,r=this.ct,u=this.ratio,i;t.lineWidth=this.drawGetLineWidth(n);t.lineCap="round";t.lineJoin="round";i=_$ES.Temp.c1.setByInfo(n.colorRGBA).ratioByRGBAInfo(n.endColorRGBA,u);t.strokeStyle=r?r.transform(i).toCssRGBA():i.toCssRGBA();t.stroke()}}),Object.defineProperty(t.prototype,"drawLineStyle2",{value:function(n){var i=null,t=this.ctx,r=this.ct,u=this.ratio;t.lineWidth=this.drawGetLineWidth(n);t.lineCap=n.endCapStyle==1?"butt":n.endCapStyle==2?"square":"round";n.joinStyle==1?t.lineJoin="bevel":n.joinStyle==2?(t.lineJoin="miter",t.miterLimit=n.miterLimitFactor):t.lineJoin="round";n.hasFillFlag?this.drawFill(n.fillStyle,null,!0):(i=_$ES.Temp.c1.setByInfo(n.colorRGBA).ratioByRGBAInfo(n.endColorRGBA,u),t.strokeStyle=r?r.transform(i).toCssRGBA():i.toCssRGBA(),t.stroke())}}),t.isPointInShapeDrawShape=undefined,Object.defineProperty(t,"isPointInShape",{value:function(n,t,i,r,u){u===undefined&&(u=0);var f=_$ES.Draw.DrawShape.isPointInShapeDrawShape;return f.ratio=u,f.isPointInShape(n,t,i,r)}}),t.drawShape=undefined,Object.defineProperty(t,"draw",{value:function(n,t,i,r,u){var f=_$ES.Draw.DrawShape.drawShape;f.swfParse=i;f.m=t;f.ctx=n;f.ratio=u;f.draw(r)}}),t.clipDrawShape=undefined,Object.defineProperty(t,"drawClip",{value:function(n,t,i,r){t&&n.setTransform(t.a,t.b,t.c,t.d,t.tx,t.ty);var u=_$ES.Draw.DrawShape.clipDrawShape;u.ctx=n;u.ratio=r;u.drawGlyphShape(i)}}),function(){this.isPointInShapeDrawShape=new t(_$ES.Temp.ctx,null,null,null,!1);this.drawShape=new t(null,null,null,null,!1);this.clipDrawShape=new t(null,null,null,null,!1)}.call(t),t},function(){n["_$ES.Draw.DrawShape"]=n["_$ES.Draw.DrawShape"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};n=n.Draw=n.Draw||{};Object.defineProperty(n,"DrawShape",{get:function(){return t===undefined&&(t=null,t=i(),delete n.DrawShape,n.DrawShape=t["_$ES.Draw.DrawShape"]),t["_$ES.Draw.DrawShape"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.GL.ShaderRect"]=function(n){function t(t){n.call(this);this.glRender=t;this.vData=new Float32Array(56);this.createGLProgram()}return _$ES.F._extends(t,n),t.prototype.a_position=undefined,t.prototype.u_color=undefined,t.prototype.u_orthoMatrix=undefined,t.prototype.u_samplerClip=undefined,t.prototype.u_clipHeight=undefined,t.prototype.u_clipWidth=undefined,t.prototype.u_clipOffset=undefined,t.prototype.u_offset=undefined,t.prototype.u_ct1=undefined,t.prototype.u_ct2=undefined,t.prototype.vBuffer=undefined,t.prototype.vData=undefined,t.prototype.fillColor=undefined,t.prototype.borderColor=undefined,t.prototype.renderInfo=undefined,Object.defineProperty(t.prototype,"createGLProgram",{value:function(){var n=this.glRender.gl,t=this.program=_$ES.GL.Utils.initShaders(n,this.vertex,this.fragment);return this.a_position=n.getAttribLocation(t,"a_Position"),this.u_orthoMatrix=n.getUniformLocation(t,"u_OrthoMatrix"),this.u_samplerClip=n.getUniformLocation(t,"u_SamplerClip"),this.u_clipWidth=n.getUniformLocation(t,"u_ClipWidth"),this.u_clipHeight=n.getUniformLocation(t,"u_ClipHeight"),this.u_clipOffset=n.getUniformLocation(t,"u_ClipOffset"),this.u_offset=n.getUniformLocation(t,"u_Offset"),this.u_ct1=n.getUniformLocation(t,"u_CT1"),this.u_ct2=n.getUniformLocation(t,"u_CT2"),this.u_color=n.getUniformLocation(t,"u_Color"),t}}),Object.defineProperty(t.prototype,"drawPre",{value:function(){var r=null,i=this.glRender,n=i.gl,u,t;i.stateCurrentShader!=this&&(i.stateCurrentShader=this,n.useProgram(this.program));u=this.renderInfo;(r=i.stateCurrentClip)?(n.uniform1i(this.u_samplerClip,i.bindTexture(n,r)._$bindTargetIndex),n.uniform1f(this.u_clipWidth,r._$w),n.uniform1f(this.u_clipHeight,r._$h),n.uniform2f(this.u_clipOffset,r._$offsetX,r._$offsetY)):n.uniform1f(this.u_clipWidth,0);n.uniformMatrix4fv(this.u_orthoMatrix,!1,i.orthoMatrix.elements);n.uniform2f(this.u_offset,i.stateOffsetX,i.stateOffsetY);t=u.playerCT;t?(n.uniform4f(this.u_ct1,t.redMultiplier,t.redOffset,t.greenMultiplier,t.greenOffset),n.uniform4f(this.u_ct2,t.blueMultiplier,t.blueOffset,t.alphaMultiplier,t.alphaOffset)):(n.uniform4f(this.u_ct1,1,0,1,0),n.uniform4f(this.u_ct2,1,0,1,0))}}),t.prototype.isFirstBind=!0,Object.defineProperty(t.prototype,"draw",{value:function(){var r=this.renderInfo,u=this.glRender,i=r.textureVDataInBufferIndex/4,t=u.gl,n;this.drawPre();n=this.fillColor;n!=-1&&(t.uniform4f(this.u_color,(n>>16&255)/255,(n>>8&255)/255,(n&255)/255,1),t.drawArrays(t.TRIANGLES,i,6));n=this.borderColor;n!=-1&&(t.uniform4f(this.u_color,(n>>16&255)/255,(n>>8&255)/255,(n&255)/255,1),t.drawArrays(t.LINES,i+6,8))}}),Object.defineProperty(t.prototype,"vertex",{get:function(){return" attribute vec4 a_Position;\n uniform mat4 u_OrthoMatrix;\n uniform vec2 u_Offset;\n varying vec2 v_Position;\nvoid main(){\n vec4 vec_Position= vec4(a_Position) ;\n v_Position= vec2(vec_Position.x ,vec_Position.y); vec_Position.x = vec_Position.x+u_Offset.x;\n vec_Position.y = vec_Position.y+u_Offset.y;\n gl_Position = u_OrthoMatrix * vec_Position;}\n"},set:function(t){_$ES.F.setSuperProperty(this,n,"vertex",t)}}),Object.defineProperty(t.prototype,"fragment",{get:function(){return"precision mediump float;\n uniform vec4 u_Color;\n uniform sampler2D u_SamplerClip;\n uniform float u_ClipWidth;\n uniform float u_ClipHeight;\n uniform vec2 u_ClipOffset;\n varying vec2 v_Position;\n uniform vec4 u_CT1;\n uniform vec4 u_CT2;\nvoid main(){\n float f_alpha = 1.0; if (u_ClipWidth>0.0){ vec2 vec_ClipPosition = vec2((v_Position.x+u_ClipOffset.x)/u_ClipWidth,(v_Position.y+u_ClipOffset.y)/u_ClipHeight); if (vec_ClipPosition.x<0.0 || vec_ClipPosition.y<0.0 || vec_ClipPosition.x>1.0 || vec_ClipPosition.y>1.0){ f_alpha = 0.0; } else{ vec4 v_Color2 = texture2D(u_SamplerClip,vec_ClipPosition);  f_alpha = v_Color2.a; } }  f_alpha =  (u_Color.a*u_CT2[2]+ u_CT2[3]/255.0) * f_alpha; gl_FragColor= vec4((u_Color.r*u_CT1[0]+ u_CT1[1]/255.0) * f_alpha, (u_Color.g*u_CT1[2]+ u_CT1[3]/255.0) * f_alpha,(u_Color.b*u_CT2[0]+ u_CT2[1]/255.0) * f_alpha,f_alpha);\n}\n"},set:function(t){_$ES.F.setSuperProperty(this,n,"fragment",t)}}),function(){}.call(t),t},function(){n["_$ES.GL.ShaderRect"]=n["_$ES.GL.ShaderRect"](_$ES.GL.ShaderBase)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};n=n.GL=n.GL||{};Object.defineProperty(n,"ShaderRect",{get:function(){return t===undefined&&(t=null,t=i(),delete n.ShaderRect,n.ShaderRect=t["_$ES.GL.ShaderRect"]),t["_$ES.GL.ShaderRect"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.AppInfo"]=function(n){function t(t){var f;this.pools=new _$ES.Pools;this.fonts=[];this.fontsDic=[];this.asFontsDic=[];n.call(this);t.appInfo=this;this.source=t;this.appId=t.id;this.createDate=new Date;this.url=t.url;this.urlFileName=_$ES.F.getFileName(t.url);this.systemLibUrl=t.systemLibUrl;this.scaleMode=t.scaleMode;this.targetElement=t.targetElement;this.targetElement&&this.targetElement.appendChild(this.renderTargetElement=document.createElement("div"));var r=document.createElement("canvas"),i=t.renderMode,u=null;if(f=window.navigator.userAgent.toLocaleLowerCase(),i==0&&!(u=r.getContext("webgl"))&&(!(f.match(/trident/)||f.match(/edge/))||!(u=r.getContext("experimental-webgl")))){i=1;t.onnotsupportwebgl(this)}i!==0&&(u=r.getContext("2d"));this.renderCanvas=r;this.renderCTX=u;(this.renderMode=i)===0?(this.renderManage=new _$ES.GL.GLRender(this),_$ES.F.traceLog2(this,"采用 WebGL位图 渲染模式")):(this.renderManage=new _$ES.Canvas2D.CanvasRender(this),i===1?_$ES.F.traceLog2(this,"采用 Canvas2D位图 渲染模式"):_$ES.F.traceLog2(this,"采用 Canvas2D矢量 渲染模式"));this.textureManage=new _$ES.TextureManage(this);this.onProgress(1);this.load();_$ES.AppInfo.apps.push(this);_$ES.AppInfo.appsDic[this.appId]=this}return t.prototype.source=undefined,t.prototype.renderMode=undefined,t.prototype.textureManage=undefined,t.prototype.textureCreateAtRuntime=!1,t.prototype.renderManage=undefined,t.prototype.canvasInfoPoolsMinW=30,t.prototype.canvasInfoPoolsMinH=30,t.prototype.canvasInfoPoolsSpriteW=2048,t.prototype.canvasInfoPoolsSpriteH=2048,t.prototype.pools=undefined,t.prototype.maxDisplayChilds=65535,t.prototype.workerManage=undefined,t.prototype.createDate=undefined,t.prototype.appId=undefined,t.prototype.url=undefined,t.prototype.urlFileName=undefined,Object.defineProperty(t.prototype,"getAbsURL",{value:function(n){return _$ES.F.isAbsoluteUrl(n)||(n=_$ES.F.toAbsURL(_$ES.F.combineUrl(n,_$ES.F.getDirectory(this.url)))),n}}),t.prototype.systemLibUrl=undefined,t.prototype.width=undefined,t.prototype.height=undefined,t.prototype.scaleMode=undefined,t.prototype.align="",t.prototype.version=undefined,t.prototype.backgroundColor=undefined,t.prototype.targetElement=undefined,t.prototype.renderTargetElement=undefined,t.prototype.renderCanvas=undefined,t.prototype.renderCTX=undefined,t.prototype.player=undefined,t.prototype.enabledWorkers=!1,t.prototype.dragSprite=undefined,t.prototype.dragSpriteLocalX=0,t.prototype.dragSpriteLocalY=0,t.prototype.dragSpriteBounds=null,t.prototype.dragEventFunc=undefined,Object.defineProperty(t.prototype,"startDrag",{value:function(n,t,i){var r=n.mousePoint;t&&(r.x=r.y=0);this.dragSprite=n;this.dragSpriteLocalX=r.x;this.dragSpriteLocalY=r.y;this.dragSpriteBounds=i;this.dragEventFunc==null&&this.player.stage.addEventListener("mouseMove",this.dragEventFunc=_$ES.F.bind(this.onMouseDrag,this))}}),Object.defineProperty(t.prototype,"stopDrag",{value:function(){this.dragSprite=null;this.dragEventFunc!=null&&(this.player.stage.removeEventListener("mouseMove",this.dragEventFunc),this.dragEventFunc=null)}}),t.prototype.touchDrawPointID=undefined,t.prototype.touchDragSprite=undefined,t.prototype.touchDragSpriteLocalX=0,t.prototype.touchDragSpriteLocalY=0,t.prototype.touchDragSpriteBounds=null,t.prototype.touchDragEventFunc=undefined,Object.defineProperty(t.prototype,"startTouchDrag",{value:function(n,t,i,r){var u=n.mousePoint;i&&(u.x=u.y=0);this.touchDrawPointID=t;this.touchDragSprite=n;this.touchDragSpriteLocalX=u.x;this.touchDragSpriteLocalY=u.y;this.touchDragSpriteBounds=r;this.touchDragEventFunc==null&&this.player.stage.addEventListener("touchMove",this.touchDragEventFunc=_$ES.F.bind(this.onTouchDrag,this))}}),Object.defineProperty(t.prototype,"stopTouchDrag",{value:function(){this.touchDragSprite=null;this.touchDragEventFunc!=null&&(this.player.stage.removeEventListener("touchMove",this.touchDragEventFunc),this.touchDragEventFunc=null)}}),Object.defineProperty(t.prototype,"onTouchDrag",{value:function(n){if(n.touchPointID==this.touchDrawPointID)this.onDrag(this.touchDragSprite,n.stageX,n.stageY,this.touchDragSpriteLocalX,this.touchDragSpriteLocalY,this.touchDragSpriteBounds)}}),Object.defineProperty(t.prototype,"onMouseDrag",{value:function(n){this.onDrag(this.dragSprite,n.stageX,n.stageY,this.dragSpriteLocalX,this.dragSpriteLocalY,this.dragSpriteBounds)}}),Object.defineProperty(t.prototype,"onDrag",{value:function(n,t,i,r,u,f){var h=null,s=null,e=NaN,o=NaN;n&&(h=n.parent)&&(s=h.globalToLocal(new _$ES.Geoms.ESPoint(t,i),null),e=s.x-r,o=s.y-u,f&&(e<f.x?e=f.x:e>f.right&&(e=f.right),o<f.y?o=f.y:o>f.bottom&&(o=f.bottom)),n.transform.translateX=e,n.transform.translateY=o)}}),t.prototype.appDomainRoot=undefined,t.prototype.fonts=undefined,t.prototype.fontsDic=undefined,t.prototype.asFontsDic=undefined,t.prototype.fontGlyphTextureSize=32,t.prototype.mainFileLoader=undefined,t.prototype.fromJSConfig=undefined,t.prototype.mainSWFParse=undefined,t.prototype.appSWFParse=undefined,t.prototype.typeManage=undefined,Object.defineProperty(t.prototype,"onProgress",{value:function(n){this.source.onprogress(this,n)}}),Object.defineProperty(t.prototype,"load",{value:function(){var u=null,i=null,s=null,t=NaN,f=NaN,h=null,c=null,r=null,e=NaN,n=NaN,l=_$ES.AppInfo.getSystemLib(this.systemLibUrl),o;this.appDomainRoot=new _$ES.AppDomain(this,null,l);this.appSWFParse=new _$ES.SWFParse(this,null,this.appDomainRoot);this.typeManage=new _$ES.TypeManage(this);u=this.workerManage=new _$ES.WorkerManange;l.loadManange.loadDefines(["_$SYS::Player"],_$ES.F.bind(this.loadSuccess,this));i=_$ES.F.bind(function(){if(this.player){if(this.source&&this.source.onload)this.source.onload(this);this.player.run()}else window.setTimeout(i,32)},this);this.mainSWFParse=new _$ES.SWFParse(this,_$ES.F.bind(function(){_$ES.F.traceLog2(this,"应用解析完成");this.mainSWFParse.content?i():_$ES.F.traceLog("错误的文件格式")},this));o=_$ES.F.bind(function(n){var t;t=_$ES.F.bind(function(){u.inWinWorkerIsInit?(_$ES.F.traceLog2(this,"应用解析开始"),u.inWinSWFParse(n,_$ES.F.bind(function(n){this.mainSWFParse.onSWFParse(n)},this))):window.setTimeout(t,32)},this);t()},this);this.url=_$ES.F.toAbsURL(this.url);this.source.from==="swf_base64"?(_$ES.F.traceLog2(this,"来源:","Base64 SWF文件"),_$ES.F.addScript(this.url,_$ES.F.bind(function(){this.onProgress(55);var n=_$ES.F.currentESContent;_$ES.F.currentESContent=null;o((this.source.base64Data=_$ES.Base64.toByteArray(n)).buffer)},this),_$ES.F.bind(function(){_$ES.F.error(this,"加载"+this.url+"失败")},this))):this.source.from==="javascript"?(_$ES.F.traceLog2(this,"来源:","Javascript文件"),s=this.source.flashResources,t=95,f=t/s.length,h=_$ES.F.bind(function(){_$ES.F.addScript(this.url,_$ES.F.bind(function(){this.onProgress(t);var n=this.fromJSConfig=_$ES.F.currentFormJSConfig;_$ES.F.currentFormJSConfig=null;typeof n.mainFunc!="function"?_$ES.F.error(this,"不正确的Javascript文件,这个文件必须执行 _$ES.start( 你的主函数 ); "):i()},this),_$ES.F.bind(function(){_$ES.F.error(this,"加载"+this.url+"失败")},this))},this),c=_$ES.F.bind(function(){this.onProgress(f);t=t-f},this),_$ES.F.loadFlashResources(this,this.source.flashResources,c,h)):(_$ES.F.traceLog2(this,"来源:","SWF文件"),r=this.mainFileLoader=new _$ES.Loader(this,"binary"),r.onComplete=_$ES.F.bind(function(n){o(n.data)},this),e=0,n=0,r.onProgress=_$ES.F.bind(function(t){if(n===0&&(n=t.total,!n)){n=-1;this.onProgress(55)}if(n>0)this.onProgress((t.loaded-e)/t.total*55);e=t.loaded},this),r.load({url:this.url,method:"GET"}))}}),Object.defineProperty(t.prototype,"loadSuccess",{value:function(n){for(var t in n)this.appDomainRoot.addDefine(n[t],this.appSWFParse);_$ES.F.traceLog("核心类库加载完成");this.player=new(this.appDomainRoot.getClass("_$SYS::Player"))(this);this.onProgress(4)}}),t.apps=undefined,t.appsDic=undefined,Object.defineProperty(t,"getAppByTargetElement",{value:function(n){for(var t=null,r=_$ES.AppInfo.apps,i=0,u=r.length;i<u;){if(t=r[i],t.targetElement==n)return t;i++}return null}}),t.systemLibs=undefined,Object.defineProperty(t,"getSystemLib",{value:function(n){if(_$ES.AppInfo.systemLibs.hasOwnProperty(n))return _$ES.AppInfo.systemLibs[n];var t={url:n,defines:{}};return t.loadManange=new _$ES.SystemLibLoader(t),_$ES.AppInfo.systemLibs[n]=t,t}}),Object.defineProperty(t,"start",{value:function(n){var r=null,i;if(n)for(i=0;i<n.length;)r=n[i],r.appInfo||new t(n[i]),i++}}),function(){this.apps=[];this.appsDic={};this.systemLibs={}}.call(t),t},function(){return n["_$ES.AppInfo"]=n["_$ES.AppInfo"](Object),window.setInterval(function(){var t=null,i=document.activeElement;if(n.currentActiveElement!=i){for(n.currentActiveElement=i;i;){if(i instanceof HTMLElement&&_$ES.F.isApp(i)&&(t=_$ES.AppInfo.getAppByTargetElement(i))&&t.player){n.currentActiveAppInfo!=t&&t.player.dispatchBroadcastActivateEvent();break}else t=null;i=i.parentNode}t&&t==n.currentActiveAppInfo||(n.currentActiveAppInfo&&n.currentActiveAppInfo.player.dispatchBroadcastDeactivateEvent(),n.currentActiveAppInfo=t)}},200)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"AppInfo",{get:function(){return t===undefined&&(t=null,t=i(),delete n.AppInfo,n.AppInfo=t["_$ES.AppInfo"]),t["_$ES.AppInfo"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.CanvasSpriteRect"]=function(n){function t(t,i,r,u,f){n.call(this);this.sprite=t;this.x=i;this.y=r;this.width=u;this.height=f;this.vertexLocation=0;this.vertexX=i;this.vertexY=r;this.isUsed=!1;this.allocateResult=null}return _$ES.F._extends(t,n),t.prototype.sprite=undefined,t.prototype.isUsed=!1,t.prototype.allocateResult=undefined,Object.defineProperty(t.prototype,"setUsed",{value:function(n,t){this.isUsed=n;this.allocateResult=t;this.getVertexLocation();this.topRect&&this.topRect.getVertexLocation();this.bottomRect&&this.bottomRect.getVertexLocation();this.leftRect&&this.leftRect.getVertexLocation();this.rightRect&&this.rightRect.getVertexLocation()}}),t.prototype.vertexLocation=undefined,Object.defineProperty(t.prototype,"getVertexLocation",{value:function(){var t=null,i=null,r=null,u=null,n=0,f=this.x,e=this.y,o,s;return this.isUsed||(t=this.topRect,i=this.leftRect,r=this.rightRect,u=this.bottomRect,(!i||i.isUsed)&&(!t||t.isUsed)?n=1:(!i||i.isUsed)&&(!u||u.isUsed)?(n=3,e=e+this.height):(!r||r.isUsed)&&(!u||u.isUsed)?(n=4,f=f+this.width,e=e+this.height):(!r||r.isUsed)&&(!t||t.isUsed)&&(n=2,f=f+this.width)),o=this.vertexLocation,s=this.sprite,n!=o&&(n==0?s.removeCanAllocateRect(this):o==0&&s.addCanAllocateRect(this),this.vertexLocation=n,this.vertexX=f,this.vertexY=e),n}}),t.prototype.topRect=undefined,t.prototype.leftRect=undefined,t.prototype.rightRect=undefined,t.prototype.bottomRect=undefined,t.prototype.vertexX=undefined,t.prototype.vertexY=undefined,Object.defineProperty(t.prototype,"tryAllocate",{value:function(n,t){var s=null,h=null,c=null,l=null,u=NaN,f=NaN,v=this.vertexLocation,y=v==1||v==3,a=v==1||v==2;if(this.isUsed||y&&this.vertexX+n>this.sprite.w||!y&&this.vertexX-n<0||a&&this.vertexY+t>this.sprite.h||!a&&this.vertexY-t<0)return null;for(var i=_$ES.Pools.popCanvasAllocateResult(this.sprite,this.vertexX,this.vertexY,n,t,this,v),e=0,w=0,p=0,o=this,r=this,b=this.sprite.allocator.minW,k=this.sprite.allocator.minH;w<t&&o;){for(p=0,w=w+o.height,f=t-w,f<0&&-f<k&&(i.height=t=t+-f,f=0);p<n&&r;){if(e=0,p=p+r.width,u=n-p,u<0&&-u<b&&(i.width=n=n+-u,u=0),h||(h=a?r.topRect:r.bottomRect),(!h||h.isUsed)&&(e=e+1),f!=0||(s=a?r.bottomRect:r.topRect)&&!s.isUsed||(e=e+1),i.realLength=i.realLength+(u>0?r.width:r.width+u)*e,e=0,c=y?r.rightRect:r.leftRect,l||(l=y?r.leftRect:r.rightRect),(!l||l.isUsed)&&(e=e+1),u==0&&(!c||c.isUsed)&&(e=e+1),i.realLength=i.realLength+(f>0?r.height:r.height+f)*e,u<0)i.separateColumns=!0,i.lastColumnsRect=r,i.separateColumnsWidth=y?r.width+u:-u;else if(u==0)i.separateColumns=!1,i.lastColumnsRect=r;else if(!c||c.isUsed)return i.isSucceed=!1,i;h=null;l=r;r=c}if(s=a?o.bottomRect:o.topRect,f<0)i.separateRows=!0,i.lastRowsRect=o,i.separateRowsHeight=a?o.height+f:-f;else if(f==0)i.separateRows=!1,i.lastRowsRect=o;else if(!s||s.isUsed)return i.isSucceed=!1,i;l=null;h=o;o=r=s}return i.isSucceed=!0,i}}),Object.defineProperty(t.prototype,"colTopRect",{get:function(){var n=this.topRect;return n?n.colTopRect:this},set:undefined}),Object.defineProperty(t.prototype,"colBottomRect",{get:function(){var n=this.bottomRect;return n?n.colBottomRect:this},set:undefined}),Object.defineProperty(t.prototype,"rowLeftRect",{get:function(){var n=this.leftRect;return n?n.rowLeftRect:this},set:undefined}),Object.defineProperty(t.prototype,"rowRightRect",{get:function(){var n=this.rightRect;return n?n.rowRightRect:this},set:undefined}),function(){}.call(t),t},function(){n["_$ES.CanvasSpriteRect"]=n["_$ES.CanvasSpriteRect"](_$ES.Geoms.ESRectangle)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"CanvasSpriteRect",{get:function(){return t===undefined&&(t=null,t=i(),delete n.CanvasSpriteRect,n.CanvasSpriteRect=t["_$ES.CanvasSpriteRect"]),t["_$ES.CanvasSpriteRect"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.ESSet"]=function(n){function t(){if(n.call(this),typeof Set=="function")return new Set;this.arr=[]}return t.prototype.arr=undefined,Object.defineProperty(t.prototype,"add",{value:function(n){return this.arr.indexOf(n)==-1&&this.arr.push(n),this}}),Object.defineProperty(t.prototype,"clear",{value:function(){this.arr.length=0}}),Object.defineProperty(t.prototype,"has",{value:function(n){return!(this.arr.indexOf(n)==-1)}}),Object.defineProperty(t.prototype,"delete",{value:function(n){var t=this.arr.indexOf(n);return t==-1?!1:(this.arr.splice(t,1),!0)}}),Object.defineProperty(t.prototype,"forEach",{value:function(n){for(var i=this.arr,t=0,r=i.length;t<r;)n(i[t]),t++}}),Object.defineProperty(t.prototype,"size",{get:function(){return this.arr.length},set:undefined}),function(){}.call(t),t},function(){n["_$ES.ESSet"]=n["_$ES.ESSet"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"ESSet",{get:function(){return t===undefined&&(t=null,t=i(),delete n.ESSet,n.ESSet=t["_$ES.ESSet"]),t["_$ES.ESSet"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.ESLinkedList"]=function(n){function t(){this.objNodeMap=new Map;this.iteratorList=[];n.call(this)}return t.prototype.objNodeMap=undefined,t.prototype.count=0,t.prototype.firstNode=undefined,t.prototype.lastNode=undefined,t.prototype.iteratorList=undefined,t.prototype.iteratorListLength=0,t.prototype.theIterator=undefined,Object.defineProperty(t.prototype,"beginReader",{value:function(n,t){n===undefined&&(n=null);t===undefined&&(t="next");var r=this.iteratorList,i=_$ES.ESLinkedListIterator.pop(this,n,t);return this.theIterator!=null&&(r.push(this.theIterator),this.iteratorListLength++,this.theIterator=null),this.iteratorListLength>0?(r.push(i),this.iteratorListLength++):this.theIterator=i,i}}),Object.defineProperty(t.prototype,"endReader",{value:function(n){var t=this.iteratorList;n==this.theIterator?this.theIterator=null:(t.splice(t.indexOf(n),1),--this.iteratorListLength==1&&(this.theIterator=t.pop(),this.iteratorListLength=0));_$ES.ESLinkedListIterator.push(n)}}),Object.defineProperty(t.prototype,"clear",{value:function(){this.firstNode=this.lastNode=null;this.iteratorList.length=0;this.theIterator=null;this.count=0;this.objNodeMap.clear()}}),Object.defineProperty(t.prototype,"has",{value:function(n){return this.objNodeMap.has(n)}}),Object.defineProperty(t.prototype,"get",{value:function(n){return this.objNodeMap.get(n)}}),Object.defineProperty(t.prototype,"insert",{value:function(n,t){var r=null,u=this.objNodeMap,i=u.get(n);i?(this.removeNode(i),i.linkedList=this):i={obj:n,linkedList:this};u.set(n,i);t?(r=t.prevNode,r?(r.nextNode=i,i.prevNode=r):this.firstNode=i,t.prevNode=i,i.nextNode=t):(this.lastNode?(this.lastNode.nextNode=i,i.prevNode=this.lastNode):this.firstNode=i,this.lastNode=i);this.count++}}),Object.defineProperty(t.prototype,"push",{value:function(){for(var t=[],n=0,i=arguments.length;n<i;n++)t.push(arguments[n]);if(n=NaN,i=NaN,t)for(n=0,i=t.length;n<i;)this.insert(t[n],null),n++}}),Object.defineProperty(t.prototype,"removeNode",{value:function(n){var t=null,i=null,e=null,r=null,u=NaN,o=NaN,f=null;if(n&&n.linkedList==this){if(t=n.prevNode,i=n.nextNode,e=this.iteratorList,r=this.theIterator,r)r.currentNode==n&&(r.currentNode=r.direction=="next"?t:i);else for(u=0,o=e.length;u<o;)f=e[u],f.currentNode==n&&(f.currentNode=f.direction=="next"?t:i),u++;return n==this.firstNode&&(this.firstNode=i),n==this.lastNode&&(this.lastNode=t),t&&(t.nextNode=i),i&&(i.prevNode=t),n.prevNode=n.nextNode=null,n.linkedList=null,this.count--,this.objNodeMap.delete(n.obj),!0}return!1}}),Object.defineProperty(t.prototype,"remove",{value:function(n){return this.removeNode(this.objNodeMap.get(n))}}),function(){}.call(t),t},function(){n["_$ES.ESLinkedList"]=n["_$ES.ESLinkedList"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"ESLinkedList",{get:function(){return t===undefined&&(t=null,t=i(),delete n.ESLinkedList,n.ESLinkedList=t["_$ES.ESLinkedList"]),t["_$ES.ESLinkedList"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.Scope"]=function(n){function t(t,i){n.call(this);this._$so=t;this._$nsSetDic=i;this._$chain=[]}return t.prototype._$so=undefined,t.prototype._$chain=undefined,t.prototype._$parentScope=undefined,t.prototype._$nsSetDic=undefined,Object.defineProperty(t.prototype,"_$push",{value:function(){for(var t=[],n=0,i=arguments.length;n<i;n++)t.push(arguments[n]);Array.prototype.push.apply(this._$chain,t)}}),Object.defineProperty(t.prototype,"_$pop",{value:function(){this._$chain.pop()}}),Object.defineProperty(t.prototype,"_$getAttrPropObj",{value:function(n,t,i){t===undefined&&(t=!0);i===undefined&&(i=null);for(var u=NaN,r,f=null,e=this._$chain,u=e.length-1;u>=0;){if(f=e[u],this._$findAttrProp2(f,n)){r=f;break}u--}return r==null&&this._$parentScope&&(r=this._$parentScope._$getAttrPropObj(n,t,i)),r||(r=t?new this._$so.appInfo.typeManage.AS_XML(""):this._$chain[0]),r}}),Object.defineProperty(t.prototype,"_$getPropObj",{value:function(n,t,i){return t===undefined&&(t=!0),i===undefined&&(i=null),this._$findProp(n,t,i).findResult}}),Object.defineProperty(t.prototype,"_$findProp",{value:function(n,t,i){t===undefined&&(t=!0);i===undefined&&(i=null);for(var u=NaN,s=NaN,r,f=null,e=null,o=null,h=this._$chain,u=h.length-1;u>=0;){if(f=h[u],this._$findProp2(f,n)){r=f;break}u--}if(r==null)if(this._$parentScope)r=this._$parentScope._$findProp(n,t,i);else if(e=this._$so.appDomain,r=e.getClassGlobalObject(n,!1),!r&&i)for(u=0,s=i.length;u<s;){if(o=i[u]+"::"+n,r=e.getClassGlobalObject(o,!1),r!=null){n=o;break}u++}return r==null&&(t?(_$ES.F.error(null,"未找到",n,"的定义,程序可能会出现错误"),r={},r[n]=Object):r=this._$chain[0]),{multiname:n,findResult:r}}}),Object.defineProperty(t.prototype,"_$findProp2",{value:function(n,t){var r=null,i;return n?(i=this._$so.appInfo.typeManage,i.isClass(n)&&!((r=i.get3(n))==null)&&r.allClassKeys.hasOwnProperty(t))?!0:i.isClassInstance(n)&&!((r=i.get2(n))==null)&&Object.hasOwnProperty.call(r.allInstanceKeys,t)?!0:Object.hasOwnProperty.call(n,t)?!0:!1:!1}}),Object.defineProperty(t.prototype,"_$findAttrProp2",{value:function(n,t){var i=this._$so.appInfo.typeManage;return!n||!i.IS(n,i.AS_XML)&&!i.IS(n,i.AS_XMLList)?!1:n.attribute(t).length()>0}}),t.prototype._$regNames=undefined,Object.defineProperty(t.prototype,"_$reg",{value:function(){for(var r=[],t=0,h=arguments.length;t<h;t++)r.push(arguments[t]);var t=0,s=null,n=null,u=null,f=null,e=!1,o=NaN,i=null;for(this._$regNames==null&&(this._$regNames=[]),this._$regNames.push.apply(this._$regNames,r);t<r.length;)s=r[t],n=s.split("|"),n.length>0&&(u=n[0],f=null,e=!0,o=0,n.length>1&&(f=this._$nsSetDic[Number(n[1])]),n.length>2&&(o=Number(n[2])),n.length>3&&(e=n[3]==1),i=u.replace(/\.\<.*\>/,"").replace(/.*::/,""),o>0&&(i="_$"+o+i),Object.defineProperty(this,i,{get:this._$reg_createGetFunc(i,u,e,f),set:this._$reg_createSetFunc(u,e,f),enumeralbe:!0,configurable:!0})),t++}}),Object.defineProperty(t.prototype,"_$reg_createGetFunc",{value:function(n,t,i,r){var f=null,u;return f=this,u=null,function(){var o,e;return u==null?(o=f._$findProp(t,i,r),u=o.findResult,t=o.multiname,e=u[t],typeof e=="function"&&(delete f[n],f[n]=e),e):u[t]}}}),Object.defineProperty(t.prototype,"_$reg_createSetFunc",{value:function(n,t,i){var u=null,r;return u=this,r=null,function(f){var e;r==null&&(e=u._$findProp(n,t,i),r=e.findResult,n=e.multiname);r[n]=f}}}),Object.defineProperty(t.prototype,"_$clone",{value:function(){var n=new _$ES.Scope(this._$so,this._$nsSetDic);return n._$chain=this._$chain,n._$reg.apply(n,this._$regNames),n}}),function(){}.call(t),t},function(){n["_$ES.Scope"]=n["_$ES.Scope"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"Scope",{get:function(){return t===undefined&&(t=null,t=i(),delete n.Scope,n.Scope=t["_$ES.Scope"]),t["_$ES.Scope"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.Geom"]=function(n){function t(){n.call(this)}return function(){}.call(t),t},function(){n["_$ES.Geom"]=n["_$ES.Geom"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"Geom",{get:function(){return t===undefined&&(t=null,t=i(),delete n.Geom,n.Geom=t["_$ES.Geom"]),t["_$ES.Geom"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.CanvasSprite"]=function(n){function t(t,i,r){n.call(this);this.id=_$ES.F.id++;this.allocator=t;this.w=i;this.h=r;this.rectDic={};this.canAllocateRectDic={};t.createCanvas&&this.initCanvas();var u=new _$ES.CanvasSpriteRect(this,0,0,i,r);u.getVertexLocation();this.addRect(u)}return Object.defineProperty(t.prototype,"initCanvas",{value:function(){var n=document.createElement("canvas");n.width=this.w;n.height=this.h;this.canvas=n;this.ctx=n.getContext("2d")}}),t.prototype.allocator=undefined,t.prototype.canvas=undefined,t.prototype.ctx=undefined,t.prototype.id=undefined,t.prototype.w=undefined,t.prototype.h=undefined,t.prototype.rectDic=undefined,Object.defineProperty(t.prototype,"addRect",{value:function(n){return n&&(this.rectDic[n.x+","+n.y]=n,n.sprite=this),n}}),Object.defineProperty(t.prototype,"removeRect",{value:function(n){return n&&(delete this.rectDic[n.x+","+n.y],this.removeCanAllocateRect(n),_$ES.Pools.pushCanvasSpriteRect(n)),n}}),Object.defineProperty(t.prototype,"getRect",{value:function(n,t){return this.rectDic[n+","+t]}}),t.prototype.canAllocateRectDic=undefined,Object.defineProperty(t.prototype,"addCanAllocateRect",{value:function(n){return n&&(this.canAllocateRectDic[n.x+","+n.y]=n),n}}),Object.defineProperty(t.prototype,"removeCanAllocateRect",{value:function(n){return n&&delete this.canAllocateRectDic[n.x+","+n.y],n}}),Object.defineProperty(t.prototype,"pop",{value:function(n,t){for(var o=null,i=null,u=NaN,f=NaN,c=(n+t)*2,s=this.canAllocateRectDic,h=Object.keys(s),r=null,e=0,l=h.length;e<l;){if(o=s[h[e]],i=o.tryAllocate(n,t),i,i&&i.isSucceed)if(r)if(i.realLength==c){_$ES.Pools.pushCanvasAllocateResult(r);r=i;break}else u=0,i.separateColumns&&u++,i.separateRows&&u++,f=0,r.separateColumns&&f++,r.separateRows&&f++,(u<f||i.realLength>r.realLength||i.realLength==r.realLength&&i.vertexLocation<r.vertexLocation)&&(_$ES.Pools.pushCanvasAllocateResult(r),r=i);else r=i;!i||i===r||_$ES.Pools.pushCanvasAllocateResult(i);e++}return r&&this.allocate(r)?r:null}}),Object.defineProperty(t.prototype,"push",{value:function(n){var t=null,i,f,e,r,o,u;for(this.eachAllocateResult(n,!1),i=n.mainRect,f=i.topRect,t=i,t.topRect&&(t=t.topRect),e=n.y+n.height,r=0;r<=e&&t;)this.mergerRows(t)||(t=t.bottomRect),t&&(r=t.y+t.height);for(t=i.sprite?i:f,t.leftRect&&(t=t.leftRect),o=n.x+n.width,u=0;u<=o&&t;)this.mergerColumns(t)||(t=t.rightRect),t&&(u=t.x+t.width);_$ES.Pools.pushCanvasAllocateResult(n)}}),Object.defineProperty(t.prototype,"allocate",{value:function(n){var r=NaN,u=NaN,t=NaN,i=NaN;if(n.isSucceed){r=n.width;u=n.height;n.separateColumns&&n.lastColumnsRect&&this.separateColumns(n.lastColumnsRect,n.separateColumnsWidth);n.separateRows&&n.lastRowsRect&&this.separateRows(n.lastRowsRect,n.separateRowsHeight);t=n.vertexX;i=n.vertexY;switch(n.vertexLocation){case 3:i=i-u;break;case 2:t=t-r;break;case 4:t=t-r;i=i-u}return n.x=t,n.y=i,this.eachAllocateResult(n,!0),!0}return!1}}),Object.defineProperty(t.prototype,"eachAllocateResult",{value:function(n,t){for(var h=null,c=null,l=null,a=null,v=this.allocator.minW,y=this.allocator.minH,b=n.x,k=n.y,p=n.width,w=n.height,u=0,e=0,o=n.mainRect=this.getRect(b,k),i=o,f=[],r=!1,s;e<w&&o;){for(u=0,e=e+o.height;u<p&&i;)u=u+i.width,r=!1,i.isUsed=t,i.allocateResult=t?n:null,u==i.width&&(h=i.leftRect)&&(this.eachAllocateResultAdjacent(i,h,h.leftRect,f,r,t,!0,v),r=!0),u==p&&(c=i.rightRect)&&(this.eachAllocateResultAdjacent(i,c,c.rightRect,f,r,t,!0,v),r=!0),e==i.height&&(l=i.topRect)&&(this.eachAllocateResultAdjacent(i,l,l.topRect,f,r,t,!1,y),r=!0),e==w&&(a=i.bottomRect)&&(this.eachAllocateResultAdjacent(i,a,a.bottomRect,f,r,t,!1,y),r=!0),i=i.rightRect;o=i=o.bottomRect}for(s=0;s<f.length;)f[s].getVertexLocation(),s++}}),Object.defineProperty(t.prototype,"eachAllocateResultAdjacent",{value:function(n,t,i,r,u,f,e,o){u||r.push(n);f&&!t.isUsed&&(e?t.width:t.height)<o&&(!i||i.isUsed)?t.setUsed(!0,null):f||!t.isUsed||t.allocateResult?r.push(t):t.setUsed(!1,null)}}),Object.defineProperty(t.prototype,"separateColumns",{value:function(n,t){var u=null,r=null,i=null;if(n){for(u=n=n.colTopRect,r=null;n;)i=_$ES.Pools.popCanvasSpriteRect(this,n.x+t,n.y,n.width-t,n.height),i.isUsed=n.isUsed,i.allocateResult=n.allocateResult,i.leftRect=n,i.rightRect=n.rightRect,n.rightRect&&(n.rightRect.leftRect=i),n.rightRect=i,r&&(i.topRect=r,r.bottomRect=i),n.width=t,this.addRect(i),r=i,n=n.bottomRect;if(n=u)while(n)n.getVertexLocation(),n.rightRect.getVertexLocation(),n=n.bottomRect}}}),Object.defineProperty(t.prototype,"mergerColumns",{value:function(n){var i=null,t=null,r=null,u=null;if(n&&(i=n=n.colTopRect,t=n.rightRect,n&&t)){for(u=n.sprite;n&&t;){if(!(n.isUsed==t.isUsed)||!(n.allocateResult==t.allocateResult))return!1;n=n.bottomRect;t=t.bottomRect}for(n=i,t=n.rightRect;n&&t;)n.rightRect=t.rightRect,t.rightRect&&(t.rightRect.leftRect=n),n.width=n.width+t.width,n=n.bottomRect,r=t,t=t.bottomRect,u.removeRect(r);for(n=i;n;)n.getVertexLocation(),n=n.bottomRect;return!0}return!1}}),Object.defineProperty(t.prototype,"mergerRows",{value:function(n){var i=null,t=null,r=null,u=null;if(n&&(i=n=n.rowLeftRect,t=n.bottomRect,n&&t)){for(u=n.sprite;n&&t;){if(!(n.isUsed==t.isUsed)||!(n.allocateResult==t.allocateResult))return!1;n=n.rightRect;t=t.rightRect}for(n=i,t=n.bottomRect;n&&t;)n.bottomRect=t.bottomRect,t.bottomRect&&(t.bottomRect.topRect=n),n.height=n.height+t.height,n=n.rightRect,r=t,t=t.rightRect,u.removeRect(r);for(n=i;n;)n.getVertexLocation(),n=n.rightRect;return!0}return!1}}),Object.defineProperty(t.prototype,"separateRows",{value:function(n,t){var u=null,r=null,i=null;if(n){for(u=n=n.rowLeftRect,r=null;n;)i=_$ES.Pools.popCanvasSpriteRect(this,n.x,n.y+t,n.width,n.height-t),i.isUsed=n.isUsed,i.allocateResult=n.allocateResult,i.topRect=n,i.bottomRect=n.bottomRect,n.bottomRect&&(n.bottomRect.topRect=i),n.bottomRect=i,r&&(i.leftRect=r,r.rightRect=i),n.height=t,this.addRect(i),r=i,n=n.rightRect;if(n=u)while(n)n.getVertexLocation(),n.bottomRect.getVertexLocation(),n=n.rightRect}}}),function(){}.call(t),t},function(){n["_$ES.CanvasSprite"]=n["_$ES.CanvasSprite"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"CanvasSprite",{get:function(){return t===undefined&&(t=null,t=i(),delete n.CanvasSprite,n.CanvasSprite=t["_$ES.CanvasSprite"]),t["_$ES.CanvasSprite"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.start"]=function(n,t,i,r,u){_$ES.F.currentFormJSConfig={w:n,h:t,frameRate:i,bgColor:r,mainFunc:u}},function(){}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"start",{get:function(){return t===undefined&&(t=null,t=i(),delete n.start,n.start=t["_$ES.start"]),t["_$ES.start"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.IRender"]=function(){function n(){}return Object.defineProperty(n.prototype,"setRenderBounds",{value:function(){}}),Object.defineProperty(n.prototype,"init",{value:function(){}}),Object.defineProperty(n.prototype,"addTexture",{value:function(){}}),Object.defineProperty(n.prototype,"removeTexture",{value:function(){}}),Object.defineProperty(n.prototype,"setVdata",{value:function(){}}),Object.defineProperty(n.prototype,"setRectVData",{value:function(){}}),Object.defineProperty(n.prototype,"renderToCanvas",{value:function(){}}),Object.defineProperty(n.prototype,"render",{value:function(){}}),Object.defineProperty(n.prototype,"getRenderTarget",{value:function(){}}),Object.defineProperty(n.prototype,"readPixel",{value:function(){}}),Object.defineProperty(n.prototype,"readPixelToImageSource",{value:function(){}}),Object.defineProperty(n.prototype,"renderCanvas",{get:function(){},set:undefined}),Object.defineProperty(n.prototype,"supportClip",{get:function(){},set:undefined}),function(){}.call(n),n},function(){n["_$ES.IRender"]=n["_$ES.IRender"](null)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"IRender",{get:function(){return t===undefined&&(t=null,t=i(),delete n.IRender,n.IRender=t["_$ES.IRender"]),t["_$ES.IRender"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.GL.Mat4"]=function(n){function t(){n.call(this);var t=this.matArr=new _$ES.GL.Mat4.ARRAY_TYPE(16);t[0]=1;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=1;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=1;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1}return t.prototype.matArr=undefined,Object.defineProperty(t.prototype,"clone",{value:function(){var i=new _$ES.GL.Mat4,n=i.matArr,t=this.matArr;return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],i}}),Object.defineProperty(t.prototype,"copy",{value:function(n){var t=n.matArr,i=this.matArr;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],n}}),Object.defineProperty(t.prototype,"identity",{value:function(){var n=this.matArr;return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}}),Object.defineProperty(t.prototype,"transpose",{value:function(n){var r=NaN,u=NaN,f=NaN,e=NaN,o=NaN,s=NaN,t=n.matArr,i=this.matArr;return t===i?(r=i[1],u=i[2],f=i[3],e=i[6],o=i[7],s=i[11],t[1]=i[4],t[2]=i[8],t[3]=i[12],t[4]=r,t[6]=i[9],t[7]=i[13],t[8]=u,t[9]=e,t[11]=i[14],t[12]=f,t[13]=o,t[14]=s):(t[0]=i[0],t[1]=i[4],t[2]=i[8],t[3]=i[12],t[4]=i[1],t[5]=i[5],t[6]=i[9],t[7]=i[13],t[8]=i[2],t[9]=i[6],t[10]=i[10],t[11]=i[14],t[12]=i[3],t[13]=i[7],t[14]=i[11],t[15]=i[15]),n}}),Object.defineProperty(t.prototype,"invert",{value:function(n){var i=n.matArr,r=this.matArr,u=r[0],f=r[1],e=r[2],o=r[3],s=r[4],h=r[5],c=r[6],l=r[7],a=r[8],v=r[9],y=r[10],p=r[11],w=r[12],b=r[13],k=r[14],d=r[15],g=u*h-f*s,nt=u*c-e*s,tt=u*l-o*s,it=f*c-e*h,rt=f*l-o*h,ut=e*l-o*c,ft=a*b-v*w,et=a*k-y*w,ot=a*d-p*w,st=v*k-y*b,ht=v*d-p*b,ct=y*d-p*k,t=g*ct-nt*ht+tt*st+it*ot-rt*et+ut*ft;return t?(t=1/t,i[0]=(h*ct-c*ht+l*st)*t,i[1]=(e*ht-f*ct-o*st)*t,i[2]=(b*ut-k*rt+d*it)*t,i[3]=(y*rt-v*ut-p*it)*t,i[4]=(c*ot-s*ct-l*et)*t,i[5]=(u*ct-e*ot+o*et)*t,i[6]=(k*tt-w*ut-d*nt)*t,i[7]=(a*ut-y*tt+p*nt)*t,i[8]=(s*ht-h*ot+l*ft)*t,i[9]=(f*ot-u*ht-o*ft)*t,i[10]=(w*rt-b*tt+d*g)*t,i[11]=(v*tt-a*rt-p*g)*t,i[12]=(h*et-s*st-c*ft)*t,i[13]=(u*st-f*et+e*ft)*t,i[14]=(b*nt-w*it-k*g)*t,i[15]=(a*it-v*nt+y*g)*t,n):null}}),Object.defineProperty(t.prototype,"adjoint",{value:function(n){var h=n.matArr,c=this.matArr,p=c[0],l=c[1],t=c[2],i=c[3],w=c[4],a=c[5],r=c[6],u=c[7],b=c[8],v=c[9],f=c[10],e=c[11],k=c[12],y=c[13],o=c[14],s=c[15];return h[0]=a*(f*s-e*o)-v*(r*s-u*o)+y*(r*e-u*f),h[1]=-(l*(f*s-e*o)-v*(t*s-i*o)+y*(t*e-i*f)),h[2]=l*(r*s-u*o)-a*(t*s-i*o)+y*(t*u-i*r),h[3]=-(l*(r*e-u*f)-a*(t*e-i*f)+v*(t*u-i*r)),h[4]=-(w*(f*s-e*o)-b*(r*s-u*o)+k*(r*e-u*f)),h[5]=p*(f*s-e*o)-b*(t*s-i*o)+k*(t*e-i*f),h[6]=-(p*(r*s-u*o)-w*(t*s-i*o)+k*(t*u-i*r)),h[7]=p*(r*e-u*f)-w*(t*e-i*f)+b*(t*u-i*r),h[8]=w*(v*s-e*y)-b*(a*s-u*y)+k*(a*e-u*v),h[9]=-(p*(v*s-e*y)-b*(l*s-i*y)+k*(l*e-i*v)),h[10]=p*(a*s-u*y)-w*(l*s-i*y)+k*(l*u-i*a),h[11]=-(p*(a*e-u*v)-w*(l*e-i*v)+b*(l*u-i*a)),h[12]=-(w*(v*o-f*y)-b*(a*o-r*y)+k*(a*f-r*v)),h[13]=p*(v*o-f*y)-b*(l*o-t*y)+k*(l*f-t*v),h[14]=-(p*(a*o-r*y)-w*(l*o-t*y)+k*(l*r-t*a)),h[15]=p*(a*f-r*v)-w*(l*f-t*v)+b*(l*r-t*a),n}}),Object.defineProperty(t.prototype,"determinant",{value:function(){var n=this.matArr,t=n[0],i=n[1],r=n[2],u=n[3],f=n[4],e=n[5],o=n[6],s=n[7],h=n[8],c=n[9],l=n[10],a=n[11],v=n[12],y=n[13],p=n[14],w=n[15],b=t*e-i*f,k=t*o-r*f,d=t*s-u*f,g=i*o-r*e,nt=i*s-u*e,tt=r*s-u*o,it=h*y-c*v,rt=h*p-l*v,ut=h*w-a*v,ft=c*p-l*y,et=c*w-a*y,ot=l*w-a*p;return b*ot-k*et+d*ft+g*ut-nt*rt+tt*it}}),Object.defineProperty(t.prototype,"multiply",{value:function(n,t){t===undefined&&(t=null);t||(t=this);var e=t.matArr,o=this.matArr,s=n.matArr,h=o[0],c=o[1],l=o[2],a=o[3],v=o[4],y=o[5],p=o[6],w=o[7],b=o[8],k=o[9],d=o[10],g=o[11],nt=o[12],tt=o[13],it=o[14],rt=o[15],i=s[0],r=s[1],u=s[2],f=s[3];return e[0]=i*h+r*v+u*b+f*nt,e[1]=i*c+r*y+u*k+f*tt,e[2]=i*l+r*p+u*d+f*it,e[3]=i*a+r*w+u*g+f*rt,i=s[4],r=s[5],u=s[6],f=s[7],e[4]=i*h+r*v+u*b+f*nt,e[5]=i*c+r*y+u*k+f*tt,e[6]=i*l+r*p+u*d+f*it,e[7]=i*a+r*w+u*g+f*rt,i=s[8],r=s[9],u=s[10],f=s[11],e[8]=i*h+r*v+u*b+f*nt,e[9]=i*c+r*y+u*k+f*tt,e[10]=i*l+r*p+u*d+f*it,e[11]=i*a+r*w+u*g+f*rt,i=s[12],r=s[13],u=s[14],f=s[15],e[12]=i*h+r*v+u*b+f*nt,e[13]=i*c+r*y+u*k+f*tt,e[14]=i*l+r*p+u*d+f*it,e[15]=i*a+r*w+u*g+f*rt,t}}),Object.defineProperty(t.prototype,"translate",{value:function(n,t){t===undefined&&(t=null);var o=NaN,s=NaN,h=NaN,c=NaN,l=NaN,a=NaN,v=NaN,y=NaN,p=NaN,w=NaN,b=NaN,k=NaN;t||(t=this);var r=t.matArr,i=this.matArr,d=n.vecArray,u=d[0],f=d[1],e=d[2];return i===r?(r[12]=i[0]*u+i[4]*f+i[8]*e+i[12],r[13]=i[1]*u+i[5]*f+i[9]*e+i[13],r[14]=i[2]*u+i[6]*f+i[10]*e+i[14],r[15]=i[3]*u+i[7]*f+i[11]*e+i[15]):(o=i[0],s=i[1],h=i[2],c=i[3],l=i[4],a=i[5],v=i[6],y=i[7],p=i[8],w=i[9],b=i[10],k=i[11],r[0]=o,r[1]=s,r[2]=h,r[3]=c,r[4]=l,r[5]=a,r[6]=v,r[7]=y,r[8]=p,r[9]=w,r[10]=b,r[11]=k,r[12]=o*u+l*f+p*e+i[12],r[13]=s*u+a*f+w*e+i[13],r[14]=h*u+v*f+b*e+i[14],r[15]=c*u+y*f+k*e+i[15]),t}}),Object.defineProperty(t.prototype,"scale",{value:function(n,t){t===undefined&&(t=null);t||(t=this);var i=t.matArr,r=this.matArr,o=n.vecArray,u=o[0],f=o[1],e=o[2];return i[0]=r[0]*u,i[1]=r[1]*u,i[2]=r[2]*u,i[3]=r[3]*u,i[4]=r[4]*f,i[5]=r[5]*f,i[6]=r[6]*f,i[7]=r[7]*f,i[8]=r[8]*e,i[9]=r[9]*e,i[10]=r[10]*e,i[11]=r[11]*e,i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15],t}}),Object.defineProperty(t.prototype,"rotate",{value:function(n,t,i){var h=NaN,l=NaN,s=NaN,nt=NaN,tt=NaN,it=NaN,rt=NaN,ut=NaN,ft=NaN,et=NaN,ot=NaN,st=NaN,ht=NaN,ct=NaN,lt=NaN,a=NaN,v=NaN,y=NaN,p=NaN,w=NaN,b=NaN,k=NaN,d=NaN,g=NaN,r=i.matArr,u=this.matArr,at=t.vecArray,f=at[0],e=at[1],o=at[2],c=Math.sqrt(f*f+e*e+o*o);return Math.abs(c)<_$ES.GL.Mat4.EPSILON?null:(c=1/c,f=f*c,e=e*c,o=o*c,h=Math.sin(n),l=Math.cos(n),s=1-l,nt=u[0],tt=u[1],it=u[2],rt=u[3],ut=u[4],ft=u[5],et=u[6],ot=u[7],st=u[8],ht=u[9],ct=u[10],lt=u[11],a=f*f*s+l,v=e*f*s+o*h,y=o*f*s-e*h,p=f*e*s-o*h,w=e*e*s+l,b=o*e*s+f*h,k=f*o*s+e*h,d=e*o*s-f*h,g=o*o*s+l,r[0]=nt*a+ut*v+st*y,r[1]=tt*a+ft*v+ht*y,r[2]=it*a+et*v+ct*y,r[3]=rt*a+ot*v+lt*y,r[4]=nt*p+ut*w+st*b,r[5]=tt*p+ft*w+ht*b,r[6]=it*p+et*w+ct*b,r[7]=rt*p+ot*w+lt*b,r[8]=nt*k+ut*d+st*g,r[9]=tt*k+ft*d+ht*g,r[10]=it*k+et*d+ct*g,r[11]=rt*k+ot*d+lt*g,u!==r&&(r[12]=u[12],r[13]=u[13],r[14]=u[14],r[15]=u[15]),i)}}),Object.defineProperty(t.prototype,"rotateX",{value:function(n,t){t===undefined&&(t=null);t||(t=this);var i=t.matArr,r=this.matArr,u=Math.sin(n),f=Math.cos(n),e=r[4],o=r[5],s=r[6],h=r[7],c=r[8],l=r[9],a=r[10],v=r[11];return r!==i&&(i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15]),i[4]=e*f+c*u,i[5]=o*f+l*u,i[6]=s*f+a*u,i[7]=h*f+v*u,i[8]=c*f-e*u,i[9]=l*f-o*u,i[10]=a*f-s*u,i[11]=v*f-h*u,t}}),Object.defineProperty(t.prototype,"rotateY",{value:function(n,t){t===undefined&&(t=null);t||(t=this);var i=t.matArr,r=this.matArr,u=Math.sin(n),f=Math.cos(n),e=r[0],o=r[1],s=r[2],h=r[3],c=r[8],l=r[9],a=r[10],v=r[11];return r!==i&&(i[4]=r[4],i[5]=r[5],i[6]=r[6],i[7]=r[7],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15]),i[0]=e*f-c*u,i[1]=o*f-l*u,i[2]=s*f-a*u,i[3]=h*f-v*u,i[8]=e*u+c*f,i[9]=o*u+l*f,i[10]=s*u+a*f,i[11]=h*u+v*f,t}}),Object.defineProperty(t.prototype,"rotateZ",{value:function(n,t){t===undefined&&(t=null);t||(t=this);var i=t.matArr,r=this.matArr,u=Math.sin(n),f=Math.cos(n),e=r[0],o=r[1],s=r[2],h=r[3],c=r[4],l=r[5],a=r[6],v=r[7];return r!==i&&(i[8]=r[8],i[9]=r[9],i[10]=r[10],i[11]=r[11],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15]),i[0]=e*f+c*u,i[1]=o*f+l*u,i[2]=s*f+a*u,i[3]=h*f+v*u,i[4]=c*f-e*u,i[5]=l*f-o*u,i[6]=a*f-s*u,i[7]=v*f-h*u,t}}),Object.defineProperty(t.prototype,"fromTranslation",{value:function(n){var t=this.matArr,i=n.vecArray;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,this}}),Object.defineProperty(t.prototype,"fromScaling",{value:function(n){var t=this.matArr,i=n.vecArray;return t[0]=i[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=i[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}}),Object.defineProperty(t.prototype,"fromRotation",{value:function(n,t){var o=NaN,h=NaN,e=NaN,i=this.matArr,c=t.vecArray,r=c[0],u=c[1],f=c[2],s=Math.sqrt(r*r+u*u+f*f);return Math.abs(s)<_$ES.GL.Mat4.EPSILON?null:(s=1/s,r=r*s,u=u*s,f=f*s,o=Math.sin(n),h=Math.cos(n),e=1-h,i[0]=r*r*e+h,i[1]=u*r*e+f*o,i[2]=f*r*e-u*o,i[3]=0,i[4]=r*u*e-f*o,i[5]=u*u*e+h,i[6]=f*u*e+r*o,i[7]=0,i[8]=r*f*e+u*o,i[9]=u*f*e-r*o,i[10]=f*f*e+h,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this)}}),Object.defineProperty(t.prototype,"fromXRotation",{value:function(n){var t=this.matArr,i=Math.sin(n),r=Math.cos(n);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=i,t[7]=0,t[8]=0,t[9]=-i,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}}),Object.defineProperty(t.prototype,"fromYRotation",{value:function(n){var t=this.matArr,i=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=0,t[2]=-i,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=i,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}}),Object.defineProperty(t.prototype,"fromZRotation",{value:function(n){var t=this.matArr,i=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=i,t[2]=0,t[3]=0,t[4]=-i,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}}),Object.defineProperty(t.prototype,"frustum",{value:function(n,t,i,r,u,f){var e=this.matArr,o=1/(t-n),s=1/(r-i),h=1/(u-f);return e[0]=u*2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=u*2*s,e[6]=0,e[7]=0,e[8]=(t+n)*o,e[9]=(r+i)*s,e[10]=(f+u)*h,e[11]=-1,e[12]=0,e[13]=0,e[14]=f*u*2*h,e[15]=0,this}}),Object.defineProperty(t.prototype,"perspective",{value:function(n,t,i,r){var u=this.matArr,f=1/Math.tan(n/2),e=1/(i-r);return u[0]=f/t,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=f,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=(r+i)*e,u[11]=-1,u[12]=0,u[13]=0,u[14]=2*r*i*e,u[15]=0,this}}),Object.defineProperty(t.prototype,"perspectiveFromFieldOfView",{value:function(n,t,i){var r=this.matArr,u=Math.tan(n.upDegrees*Math.PI/180),f=Math.tan(n.downDegrees*Math.PI/180),e=Math.tan(n.leftDegrees*Math.PI/180),o=Math.tan(n.rightDegrees*Math.PI/180),s=2/(e+o),h=2/(u+f);return r[0]=s,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=h,r[6]=0,r[7]=0,r[8]=-((e-o)*s*.5),r[9]=(u-f)*h*.5,r[10]=i/(t-i),r[11]=-1,r[12]=0,r[13]=0,r[14]=i*t/(t-i),r[15]=0,this}}),Object.defineProperty(t.prototype,"ortho",{value:function(n,t,i,r,u,f){var e=this.matArr,o=1/(n-t),s=1/(i-r),h=1/(u-f);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*h,e[11]=0,e[12]=(n+t)*o,e[13]=(r+i)*s,e[14]=(f+u)*h,e[15]=1,this}}),Object.defineProperty(t.prototype,"lookAt",{value:function(n,t,i){var s=NaN,h=NaN,c=NaN,l=NaN,a=NaN,v=NaN,f=NaN,e=NaN,o=NaN,r=NaN,b=n.vecArray,k=t.vecArray,d=i.vecArray,u=this.matArr,y=b[0],p=b[1],w=b[2],g=d[0],nt=d[1],tt=d[2],it=k[0],rt=k[1],ut=k[2];return Math.abs(y-it)<_$ES.GL.Mat4.EPSILON&&Math.abs(p-rt)<_$ES.GL.Mat4.EPSILON&&Math.abs(w-ut)<_$ES.GL.Mat4.EPSILON?this.identity():(f=y-it,e=p-rt,o=w-ut,r=1/Math.sqrt(f*f+e*e+o*o),f=f*r,e=e*r,o=o*r,s=nt*o-tt*e,h=tt*f-g*o,c=g*e-nt*f,r=Math.sqrt(s*s+h*h+c*c),r?(r=1/r,s=s*r,h=h*r,c=c*r):(s=0,h=0,c=0),l=e*c-o*h,a=o*s-f*c,v=f*h-e*s,r=Math.sqrt(l*l+a*a+v*v),r?(r=1/r,l=l*r,a=a*r,v=v*r):(l=0,a=0,v=0),u[0]=s,u[1]=l,u[2]=f,u[3]=0,u[4]=h,u[5]=a,u[6]=e,u[7]=0,u[8]=c,u[9]=v,u[10]=o,u[11]=0,u[12]=-(s*y+h*p+c*w),u[13]=-(l*y+a*p+v*w),u[14]=-(f*y+e*p+o*w),u[15]=1,this)}}),Object.defineProperty(t.prototype,"str",{value:function(){var n=this.matArr;return"mat4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+", "+n[6]+", "+n[7]+", "+n[8]+", "+n[9]+", "+n[10]+", "+n[11]+", "+n[12]+", "+n[13]+", "+n[14]+", "+n[15]+")"}}),Object.defineProperty(t.prototype,"frob",{value:function(){var n=this.matArr;return Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2)+Math.pow(n[2],2)+Math.pow(n[3],2)+Math.pow(n[4],2)+Math.pow(n[5],2)+Math.pow(n[6],2)+Math.pow(n[7],2)+Math.pow(n[8],2)+Math.pow(n[9],2)+Math.pow(n[10],2)+Math.pow(n[11],2)+Math.pow(n[12],2)+Math.pow(n[13],2)+Math.pow(n[14],2)+Math.pow(n[15],2))}}),Object.defineProperty(t.prototype,"elements",{get:function(){return this.matArr},set:undefined}),t.EPSILON=1e-6,t.ARRAY_TYPE=undefined,t.RANDOM=undefined,t.ENABLE_SIMD=!1,t.SIMD_AVAILABLE=!1,t.USE_SIMD=!1,Object.defineProperty(t,"setMatrixArrayType",{value:function(n){_$ES.GL.Mat4.ARRAY_TYPE=n}}),t.degree=0,Object.defineProperty(t,"toRadian",{value:function(n){return n*_$ES.GL.Mat4.degree}}),function(){this.ARRAY_TYPE=typeof Float32Array!="undefined"?Float32Array:Array;this.RANDOM=Math.random;this.SIMD_AVAILABLE=this.ARRAY_TYPE===Float32Array&&"SIMD"in this;this.USE_SIMD=this.ENABLE_SIMD&&this.SIMD_AVAILABLE;this.degree=Math.PI/180}.call(t),t},function(){n["_$ES.GL.Mat4"]=n["_$ES.GL.Mat4"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};n=n.GL=n.GL||{};Object.defineProperty(n,"Mat4",{get:function(){return t===undefined&&(t=null,t=i(),delete n.Mat4,n.Mat4=t["_$ES.GL.Mat4"]),t["_$ES.GL.Mat4"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.Draw.Utils"]=function(n){function t(){n.call(this)}return Object.defineProperty(t,"getOriginMatrix",{value:function(n,t){return new _$ES.Geoms.ESMatrix(t,0,0,t,n.x*t*-1,n.y*t*-1)}}),Object.defineProperty(t,"rectToTextureCoordinate",{value:function(n,t,i){return new _$ES.Geoms.ESRectangle(n.x/t,n.y/i,n.width/t,n.height/i)}}),Object.defineProperty(t,"toTextureSize",{value:function(n,t){for(var i=2;i;){if(i>=n){n=i;break}i=i*2}for(i=2;i;){if(i>=t){t=i;break}i=i*2}return new _$ES.Geoms.ESPoint(n,t)}}),function(){}.call(t),t},function(){n["_$ES.Draw.Utils"]=n["_$ES.Draw.Utils"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};n=n.Draw=n.Draw||{};Object.defineProperty(n,"Utils",{get:function(){return t===undefined&&(t=null,t=i(),delete n.Utils,n.Utils=t["_$ES.Draw.Utils"]),t["_$ES.Draw.Utils"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.GL.ShaderTexture"]=function(n){function t(t){n.call(this);this.glRender=t;this.createGLProgram()}return _$ES.F._extends(t,n),t.prototype.a_position=undefined,t.prototype.a_texCoord=undefined,t.prototype.u_orthoMatrix=undefined,t.prototype.u_sampler=undefined,Object.defineProperty(t.prototype,"createGLProgram",{value:function(){var n=this.glRender.gl,t=this.program=_$ES.GL.Utils.initShaders(n,this.vertex,this.fragment);return this.a_position=n.getAttribLocation(t,"a_Position"),this.a_texCoord=n.getAttribLocation(t,"a_TexCoord"),this.u_orthoMatrix=n.getUniformLocation(t,"u_OrthoMatrix"),this.u_sampler=n.getUniformLocation(t,"u_Sampler"),t}}),Object.defineProperty(t.prototype,"drawByTextureInfo",{value:function(n){var i=this.glRender,t=i.gl,e=i.getGLTexture(n),r=n.allocatorBounds.width,u=n.allocatorBounds.height,f;_$ES.TextureInfo.updateBoundsByPoint(0,0,0,u,r,0,r,u,n.vData,!0);f=i.glRenderBuffer;t.bindBuffer(t.ARRAY_BUFFER,f);t.bufferSubData(t.ARRAY_BUFFER,0,n.vData);i.stateCurrentShader!=this&&(i.stateCurrentShader=this,t.useProgram(this.program));t.uniform1i(this.u_sampler,i.bindTexture(t,e)._$bindTargetIndex);t.uniformMatrix4fv(this.u_orthoMatrix,!1,i.orthoMatrix.elements);t.drawArrays(t.TRIANGLES,0,6)}}),Object.defineProperty(t.prototype,"vertex",{get:function(){return" attribute vec4 a_Position;\n attribute vec2 a_TexCoord;\n uniform mat4 u_OrthoMatrix;\n varying vec2 v_TexCoord;\nvoid main(){\n gl_Position = u_OrthoMatrix * a_Position; v_TexCoord=a_TexCoord;}\n"},set:function(t){_$ES.F.setSuperProperty(this,n,"vertex",t)}}),Object.defineProperty(t.prototype,"fragment",{get:function(){return"precision mediump float;\n uniform sampler2D u_Sampler;\n varying vec2 v_TexCoord;\nvoid main(){\n gl_FragColor =  texture2D(u_Sampler,v_TexCoord);}\n"},set:function(t){_$ES.F.setSuperProperty(this,n,"fragment",t)}}),function(){}.call(t),t},function(){n["_$ES.GL.ShaderTexture"]=n["_$ES.GL.ShaderTexture"](_$ES.GL.ShaderBase)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};n=n.GL=n.GL||{};Object.defineProperty(n,"ShaderTexture",{get:function(){return t===undefined&&(t=null,t=i(),delete n.ShaderTexture,n.ShaderTexture=t["_$ES.GL.ShaderTexture"]),t["_$ES.GL.ShaderTexture"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.Loader"]=function(n){function t(t,i,r,u,f,e,o,s,h,c,l){r===undefined&&(r=null);u===undefined&&(u=null);f===undefined&&(f=null);e===undefined&&(e=null);o===undefined&&(o=null);s===undefined&&(s=null);h===undefined&&(h=null);c===undefined&&(c=null);l===undefined&&(l=null);this.dataFormat="text";n.call(this);this.appInfo=t;this.dataFormat=i;this.onOpen=f;this.onHttpResponseStatus=e;this.onHttpStatus=o;this.onProgress=s;this.onComplete=u;this.onIoError=h;this.onSecurityError=c;this.onLoaded=l;r&&this.load(r)}return t.prototype.ret_ResponseStatus=undefined,t.prototype.ret_Status=undefined,t.prototype.ret_Complete=undefined,t.prototype.appInfo=undefined,t.prototype.dataFormat=undefined,t.prototype.onOpen=undefined,t.prototype.onHttpResponseStatus=undefined,t.prototype.onHttpStatus=undefined,t.prototype.onProgress=undefined,t.prototype.onComplete=undefined,t.prototype.onIoError=undefined,t.prototype.onSecurityError=undefined,t.prototype.onLoaded=undefined,t.prototype.xhr=null,t.prototype.xhrAbort=!1,t.prototype.total=undefined,t.prototype.loaded=undefined,Object.defineProperty(t.prototype,"close",{value:function(){if(this.xhr!=null)this.xhr.onerror=this.xhr.ontimeout=this.xhr.onload=this.xhr.onprogress=this.xhr.onloadend=this.xhr.onreadystatechange=null,this.xhrAbort=!0,this.xhr.abort();else throw new Error("Error: Error #2029: ");}}),Object.defineProperty(t.prototype,"load",{value:function(n){var t=null,r=NaN,e=NaN,i;this.total=this.loaded=0;this.appInfo&&(n.url=this.appInfo.getAbsURL(n.url));t=this.xhr=new XMLHttpRequest;this.xhrAbort=!1;t.onabort=_$ES.F.bind(function(){this.xhrAbort=!0},this);t.onprogress=_$ES.F.bind(function(n){if(this.total=n.total,this.loaded=n.loaded,this.onProgress)this.onProgress({loaderId:0,total:n.total,loaded:n.loaded})},this);t.onloadend=_$ES.F.bind(function(n){if(this.onLoaded)this.onLoaded(n)},this);t.onerror=t.ontimeout=_$ES.F.bind(function(){if(this.onIoError)this.onIoError({loaderId:0,status:t.status,statusText:this.xhr.statusText})},this);t.onreadystatechange=_$ES.F.bind(function(){var u,f,e,o,s,r,h,i;if(!this.xhrAbort){if(t.readyState===XMLHttpRequest.HEADERS_RECEIVED){for(u=this.xhr.getAllResponseHeaders().split("\n"),f=[],e={},o=n.url,s=!1,r=0,h=u.length;r<h;)i=u[r].split(":"),i.length==2&&(i[0]==""&&(s=!0,o=i[1]),f.push({name:i[0],value:i[1]}),e[i[0]]=i[1]),r++;if(this.ret_ResponseStatus={loaderId:0,redirected:s,responseURL:o,heads:f,status:this.xhr.status,statusText:this.xhr.statusText},this.ret_ResponseStatus.headsDic=e,this.ret_Status={loaderId:0,status:this.xhr.status,statusText:this.xhr.statusText},this.onHttpStatus)this.onHttpStatus(this.ret_Status);if(this.onHttpResponseStatus)this.onHttpResponseStatus(this.ret_ResponseStatus)}if(t.readyState===XMLHttpRequest.OPENED){if(this.onOpen)this.onOpen({loaderId:0})}else if(t.readyState===XMLHttpRequest.DONE)if(this.xhr.status>=200&&this.xhr.status<=399||this.xhr.status==0&&this.total>0&&this.loaded==this.total){this.ret_Complete={loaderId:0,dataFormat:this.dataFormat,data:null};switch(this.dataFormat){default:case"text":case"variables":this.ret_Complete.data=this.xhr.responseText;break;case"binary":this.ret_Complete.data=this.xhr.response}if(this.onComplete)this.onComplete(this.ret_Complete)}else if(t.status===0){if(this.onSecurityError)this.onSecurityError({loaderId:0,status:this.xhr.status,statusText:this.xhr.statusText})}else if(this.onIoError)this.onIoError({loaderId:0,status:this.xhr.status,statusText:this.xhr.statusText})}},this);var f=n.data,u=n.url,o=!1;if(n.method=="GET"&&n._$dataFormat=="variables"&&(u=u.indexOf("?")===-1?u+("?"+f.toString()):u+("&"+f.toString()),o=!0),t.open(n.method,u,!0),i=n.requestHeaders,!(i==null)&&i.length>0)for(r=0,e=i.length;r<e;)this.xhr.setRequestHeader(i[r].name,i[r].value),r++;n.contentType&&t.setRequestHeader("Content-type",n.contentType);switch(this.dataFormat){default:case"variables":case"text":t.responseType="text";break;case"binary":t.responseType="arraybuffer"}t.timeout=6e5;o?t.send():f!==null?t.send(f):t.send()}}),function(){}.call(t),t},function(){n["_$ES.Loader"]=n["_$ES.Loader"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"Loader",{get:function(){return t===undefined&&(t=null,t=i(),delete n.Loader,n.Loader=t["_$ES.Loader"]),t["_$ES.Loader"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.RenderInfoV2"]=function(n){function t(){this.textureVData=new Float32Array(24);n.call(this)}return t.prototype.displayObject=undefined,t.prototype.preRender=undefined,t.prototype.canDraw=!1,t.prototype.playerBoundsInStage=!1,t.prototype.playerBounds=undefined,t.prototype.playerBoundsSource=undefined,t.prototype.playerBoundsP1=undefined,t.prototype.playerBoundsP2=undefined,t.prototype.playerBoundsP3=undefined,t.prototype.playerBoundsP4=undefined,t.prototype.playerMatrix=undefined,t.prototype.stageMatrix=undefined,t.prototype.playerCT=undefined,t.prototype.playerCT2=undefined,t.prototype.textureVData=undefined,t.prototype.isUpdateMatrix=!1,t.prototype.isUpdateBounds=!1,t.prototype.isUpdateTexture=!1,t.prototype.isUpdateTextureVData=!1,t.prototype.scale9GridRenderInfoArray=undefined,t.prototype.textureInfo=undefined,t.prototype.textureVDataInBufferIndex=undefined,t.prototype.textureBounds=undefined,t.prototype.clip=undefined,Object.defineProperty(t.prototype,"updatePlayerMatrix",{value:function(n,t){return this.isUpdateMatrix=!1,this.playerMatrixInvert=null,n?this.playerMatrix.setByMatrix(n).append(t):this.playerMatrix.setByMatrix(t)}}),t.prototype.playerMatrixInvert=undefined,Object.defineProperty(t.prototype,"getPlayerMatrixInvert",{value:function(){return this.playerMatrixInvert||(this.playerMatrixInvert=this.playerMatrix.clone().invert()),this.playerMatrixInvert}}),Object.defineProperty(t.prototype,"updateStageCT",{value:function(n,t){var i=null,r=null;return n||t?(r=this.displayObject,i=this.playerCT||(this.playerCT=this.playerCT2),n&&t?i.setTo(n).concat2(t):n?i.setTo(n):i.setTo(t)):this.playerCT=i=null,i}}),Object.defineProperty(t.prototype,"updateBounds",{value:function(n){this.playerBoundsSource=n;var i=this.playerMatrix,t=this.playerBounds;return this.isUpdateBounds=!1,i.transformRect(t.setByRect(n),this.playerBoundsP1,this.playerBoundsP2,this.playerBoundsP3,this.playerBoundsP4),this.isUpdateTextureVData=!0,this.playerBoundsInStage=t.intersects(this.preRender.canvasRect),t}}),Object.defineProperty(t.prototype,"updateTexture",{value:function(n){return this.isUpdateTexture=!1,this.textureInfo=n,this.textureVData.set(n.vData),this.isUpdateTextureVData=!0,n}}),Object.defineProperty(t.prototype,"updateTextureVData",{value:function(n){n===undefined&&(n=!1);_$ES.TextureInfo.updateBoundsByPoint(this.playerBoundsP1.x,this.playerBoundsP1.y,this.playerBoundsP2.x,this.playerBoundsP2.y,this.playerBoundsP3.x,this.playerBoundsP3.y,this.playerBoundsP4.x,this.playerBoundsP4.y,this.textureVData,n);this.isUpdateTextureVData=!1}}),Object.defineProperty(t.prototype,"clearScale9GridRenderInfoArray",{value:function(){var n=null,t=null;if(t=this.scale9GridRenderInfoArray){while(n=t.pop())_$ES.Pools.pushRenderInfo(n);this.scale9GridRenderInfoArray=null}}}),Object.defineProperty(t.prototype,"hitTestPixel",{value:function(n,t){var r=null,i=null,f=null,u=!1;return this.canDraw&&(i=this.playerBounds,n>=i.x&&t>=i.y&&n<=i.x+i.width&&t<=i.y+i.height&&this.displayObject&&(f=this.getPlayerMatrixInvert().transformPointValues(n,t),u=this.displayObject.hitTestPixelBySymbol(f.x,f.y)),u&&(r=this.clip)&&(u=r.canDraw?r.hitTestPixel(n,t):r.displayObject.hitTestPixel(n,t))),u}}),Object.defineProperty(t.prototype,"reset",{value:function(){this.preRender=null;this.displayObject=null;this.textureInfo=null;this.textureBounds=null;this.canDraw=!1;this.clip=null;this.playerCT=null;this.stageMatrix=null;this.isUpdateMatrix=!0;this.isUpdateBounds=!0;this.isUpdateTexture=!0;this.isUpdateTextureVData=!0;this.playerBoundsInStage=!0;this.clearScale9GridRenderInfoArray()}}),function(){}.call(t),t},function(){n["_$ES.RenderInfoV2"]=n["_$ES.RenderInfoV2"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"RenderInfoV2",{get:function(){return t===undefined&&(t=null,t=i(),delete n.RenderInfoV2,n.RenderInfoV2=t["_$ES.RenderInfoV2"]),t["_$ES.RenderInfoV2"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.Canvas2D.CanvasRender"]=function(n){function t(t){this.stateTextureFrameBufferStack=[];this.stateClipStack=[];this.stateClipApplicationStack=[];this.canvasBufferPools=[];n.call(this);this.appInfo=t;this.mainCanvas=t.renderCanvas;this.mainCTX=t.renderCTX;this.mainCTX._$offsetX=0;this.mainCTX._$offsetY=0}return t.prototype.preRender=undefined,t.prototype.mainCanvas=undefined,t.prototype.mainCTX=undefined,t.prototype.stateTextureFrameBufferStack=undefined,t.prototype.stateClipStack=undefined,t.prototype.stateClipApplicationStack=undefined,t.prototype.stateTextureFrameBufferCTX=undefined,t.prototype.stateClipCTX=undefined,t.prototype.stateClipApplicationCTX=undefined,t.prototype.appInfo=undefined,Object.defineProperty(t.prototype,"addTexture",{value:function(n,t,i,r,u){n.imageSource=u}}),Object.defineProperty(t.prototype,"removeTexture",{value:function(){}}),Object.defineProperty(t.prototype,"readPixel",{value:function(n,t,i,r,u){var f=null,e=n.imageSource;return e?(e instanceof HTMLCanvasElement?f=e.getContext("2d"):(f=_$ES.F.createCTX(r,u),f.drawImage(e,0,0)),f.getImageData(t,i,r,u).data):null}}),Object.defineProperty(t.prototype,"readPixelToImageSource",{value:function(n,t,i,r,u){t===undefined&&(t=0);i===undefined&&(i=0);r===undefined&&(r=0);u===undefined&&(u=0);var e=null,f=n.imageSource;return f?(r==0&&(r=f.width),u==0&&(u=f.height),t==0&&i==0&&r==f.width&&u==f.height||(e=_$ES.F.createCTX(r,u),e.drawImage(f,t,i,r,u,0,0,r,u),f=e.canvas),f):null}}),Object.defineProperty(t.prototype,"getRenderTarget",{value:function(){return this.mainCanvas}}),Object.defineProperty(t.prototype,"init",{value:function(n,t,i,r,u,f,e,o,s){u===undefined&&(u=null);f===undefined&&(f=!1);e===undefined&&(e=null);o===undefined&&(o=null);s===undefined&&(s=!1);var c=this.appInfo,h=_$ES.F.getPixelRatio(),l=h*t,a=h*i;c.player.matrix=r.scale2(h,h);c.player.matrixIsEmpty=r.isEmpty();c.player.matrixInvert=r.clone().invert();this.setRenderBounds(t,i,l,a);this.preRender?this.preRender.init(n,l,a,r,u,e,o,s):this.preRender=new _$ES.PreRender(this.appInfo.player,this,n,l,a,r,u,e,o,s);n.updateRenderInfoMatrix()}}),t.prototype.canvasBufferPools=undefined,Object.defineProperty(t.prototype,"popCanvasBuffer",{value:function(n,t){var u=null,i=null,r=this.canvasBufferPools.pop(),f=0,e=0;return r&&(u=r.canvas)?(f=u.width,e=u.height,(f<n||e<t)&&(i=_$ES.Draw.Utils.toTextureSize(n,t),i.x>f&&(u.width=i.x),i.y>e&&(u.height=i.y)),this.render_clearCTX(r)):(i=_$ES.Draw.Utils.toTextureSize(n,t),r=_$ES.F.createCTX(i.x,i.y)),r._$useWidth=n,r._$useHeight=t,r}}),Object.defineProperty(t.prototype,"pushCanvasBuffer",{value:function(n){this.canvasBufferPools.push(n)}}),Object.defineProperty(t.prototype,"clipApplicationRenderToCanvas",{value:function(n,t,i){var f=null,e=null,o=null,r=NaN,u=NaN;n&&t&&t._$isRender&&i&&(f=n.canvas,e=t.canvas,o=i.canvas,this.render_checkTransform(t),r=n._$useWidth,u=n._$useHeight,t.globalCompositeOperation="destination-in",t.drawImage(f,0,0,r,u,0,0,r,u),t.globalCompositeOperation="source-over",this.render_checkTransform(i),r=t._$useWidth,u=t._$useHeight,i.drawImage(e,0,0,r,u,-t._$offsetX+i._$offsetX,-t._$offsetY+i._$offsetY,r,u),this.render_clearCTX(t))}}),Object.defineProperty(t.prototype,"render_checkTransform",{value:function(n){n._$isSetTransform&&(n.setTransform(1,0,0,1,0,0),n._$isSetTransform=!1)}}),Object.defineProperty(t.prototype,"render_clearCTX",{value:function(n){this.render_checkTransform(n);n._$isRender&&(n.clearRect(0,0,n.canvas.width,n.canvas.height),n._$isRender=!1)}}),Object.defineProperty(t.prototype,"render",{value:function(n){var i=null,u=null,a=null,t=null,c=NaN,b=NaN,l=null,y=NaN,p=NaN,k=null,v=null,d=null,g,nt,tt=null,it,rt,s=null,f=null,o=null,h=null,ft=this.preRender;u=ft.run();var r=0,et=u.length,w=1,ut=this.mainCanvas,e=this.mainCTX;for(n&&this.render_clearCTX(e),r=0;r<et;){b=u[r];switch(b){case"C1":this.render_clearCTX(e);break;case"C2":a=u[++r];t=this.popCanvasBuffer(a.width,a.height);t._$offsetX=-a.x;t._$offsetY=-a.y;this.stateTextureFrameBufferStack.push(this.stateTextureFrameBufferCTX);this.stateTextureFrameBufferCTX=t;break;case"C3":this.pushCanvasBuffer(this.stateTextureFrameBufferCTX);this.stateTextureFrameBufferCTX=this.stateTextureFrameBufferStack.pop();break;case"C4":r++;this.clipApplicationRenderToCanvas(this.stateClipCTX,this.stateClipApplicationCTX,e);this.stateClipStack.push(this.stateClipCTX);t=this.stateClipCTX=this.stateTextureFrameBufferCTX;this.stateClipApplicationStack.push(this.stateClipApplicationCTX);t=this.stateClipApplicationCTX=this.popCanvasBuffer(t._$useWidth,t._$useHeight);t._$offsetX=this.stateClipCTX._$offsetX;t._$offsetY=this.stateClipCTX._$offsetY;break;case"C5":this.clipApplicationRenderToCanvas(this.stateClipCTX,this.stateClipApplicationCTX,e);this.stateClipCTX=this.stateClipStack.pop();this.pushCanvasBuffer(this.stateClipApplicationCTX);this.stateClipApplicationCTX=this.stateClipApplicationStack.pop();break;case"C9":this.clipApplicationRenderToCanvas(this.stateClipCTX,this.stateClipApplicationCTX,e);ut=this.mainCanvas;e=this.mainCTX;break;case"C8":this.clipApplicationRenderToCanvas(this.stateClipCTX,this.stateClipApplicationCTX,e);e=this.stateTextureFrameBufferCTX;ut=e.canvas;break;case"C0":t=this.stateClipApplicationCTX||e;i=u[++r];c=i.playerCT?i.playerCT.alphaMultiplier:1;c>0&&(l=i.textureInfo)&&(s=i.playerMatrix,c<1&&(t.globalAlpha=c),o=l.allocatorBounds,h=i.textureBounds,s.a>0&&s.d>0&&s.b==0&&s.c==0?(f=i.playerBounds,t._$isSetTransform&&(t.setTransform(1,0,0,1,0,0),t._$isSetTransform=!1),h?t.drawImage(l.imageSource,o.x+h.x,o.y+h.y,h.width,h.height,f.x+t._$offsetX,f.y+t._$offsetY,f.width,f.height):t.drawImage(l.imageSource,o.x,o.y,o.width,o.height,f.x+t._$offsetX,f.y+t._$offsetY,f.width,f.height)):(f=l.boundsSource,t.setTransform(s.a,s.b,s.c,s.d,s.tx+t._$offsetX,s.ty+t._$offsetY),h?t.drawImage(l.imageSource,o.x+h.x,o.y+h.y,h.width,h.height,f.x,f.y,f.width,f.height):t.drawImage(l.imageSource,o.x,o.y,o.width,o.height,f.x,f.y,f.width,f.height),t._$isSetTransform=!0),c<1&&(t.globalAlpha=1),t._$isRender=!0);break;case"C10":t=this.stateClipApplicationCTX||e;i=u[++r];y=u[++r];p=u[++r];t._$isSetTransform&&(t.setTransform(1,0,0,1,0,0),t._$isSetTransform=!1);t.beginPath();t.moveTo(i.playerBoundsP1.x,i.playerBoundsP1.y);t.lineTo(i.playerBoundsP2.x,i.playerBoundsP2.y);t.lineTo(i.playerBoundsP4.x,i.playerBoundsP4.y);t.lineTo(i.playerBoundsP3.x,i.playerBoundsP3.y);t.closePath();y!=-1&&(t.fillStyle=_$ES.Temp.c1.setByRGB(y,255).toCssRGB(),t.fill());p!=-1&&(t.lineWidth=1,t.strokeStyle=_$ES.Temp.c1.setByRGB(p,255).toCssRGB(),t.stroke());break;case"C11":k=u[++r];v=u[++r];v.parentNode||k.appendChild(v);v.style.zIndex!=w&&(v.style.zIndex=w);w++;break;case"C14":t=this.stateClipApplicationCTX||e;t.beginPath();break;case"C16":t=this.stateClipApplicationCTX||e;t.closePath();t._$isSetTransform=!1;t.setTransform(1,0,0,1,0,0);t.save();t.clip();break;case"C15":t=this.stateClipApplicationCTX||e;i=u[++r];d=u[++r];g=u[++r];nt=u[++r];d(t,i.playerMatrix,g,nt);break;case"C17":t=this.stateClipApplicationCTX||e;t.restore();break;case"C18":t=this.stateClipApplicationCTX||e;i=u[++r];c=i.playerCT?i.playerCT.alphaMultiplier:1;c<1&&(t.globalAlpha=c);tt=u[++r];it=u[++r];rt=u[++r];tt(t,i.playerMatrix,it,rt);c<1&&(t.globalAlpha=1);t._$isSetTransform=!0;t._$isRender=!0}r++}u.length=0}}),Object.defineProperty(t.prototype,"renderToCanvas",{value:function(n,t,i,r,u,f,e){var s=null,b=this.mainCanvas,k=this.mainCTX,d=this.mainCanvas=n.canvas,o,h,c,l,a,v,y,p,w;n=this.mainCTX=n;n._$offsetX=0;n._$offsetY=0;n.setTransform(1,0,0,1,0,0);e&&(n.save(),n.rect(e.x,e.y,e.width,e.height),n.clip());o=this.preRender;h=o.matrix;o.matrix=u;c=o.colorTransform;o.colorTransform=f;l=o.source;o.source=t;a=o.canvasRect;o.canvasRect=new _$ES.Geoms.ESRectangle(0,0,i,r);v=o.renderByBitmapDataDraw;o.renderByBitmapDataDraw=!0;y=o.isSystem;o.isSystem=!1;p=o.renderInfoDic;o.renderInfoDic=[];this.render(!1);o.matrix=h;o.colorTransform=c;o.source=l;o.canvasRect=a;o.renderByBitmapDataDraw=v;o.isSystem=y;for(w in o.renderInfoDic)s=o.renderInfoDic[w],_$ES.Pools.pushRenderInfo(s);return o.renderInfoDic=p,this.mainCanvas=b,this.mainCTX=k,e&&n.restore(),n}}),Object.defineProperty(t.prototype,"setRenderBounds",{value:function(n,t,i,r){var u=this.mainCanvas;this.appInfo.renderTargetElement.appendChild(u);u.style.position="absolute";u.style.left="0px";u.style.top="0px";u.style.width=n+"px";u.style.height=t+"px";u.width=i;u.height=r}}),Object.defineProperty(t.prototype,"setRectVData",{value:function(){}}),Object.defineProperty(t.prototype,"setVdata",{value:function(n,t,i){i===undefined&&(i=!1);var u=null,r=null;t?(u=n.textureInfo.allocatorBounds,t.x=t.x-u.x,t.y=t.y-u.y,n.textureBounds=t):n.textureBounds=null;i&&(r=n.playerBounds,r.x=r.x>>0,r.y=r.y>>0,r.width=r.width>>0,r.height=r.height>>0)}}),Object.defineProperty(t.prototype,"renderCanvas",{get:function(){return this.mainCanvas},set:undefined}),Object.defineProperty(t.prototype,"supportClip",{get:function(){return!0},set:undefined}),function(){}.call(t),t},function(){n["_$ES.Canvas2D.CanvasRender"]=n["_$ES.Canvas2D.CanvasRender"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};n=n.Canvas2D=n.Canvas2D||{};Object.defineProperty(n,"CanvasRender",{get:function(){return t===undefined&&(t=null,t=i(),delete n.CanvasRender,n.CanvasRender=t["_$ES.Canvas2D.CanvasRender"]),t["_$ES.Canvas2D.CanvasRender"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.GL.GLMain_REMOVED"]=function(n){function t(){n.call(this)}return function(){}.call(t),t},function(){n["_$ES.GL.GLMain_REMOVED"]=n["_$ES.GL.GLMain_REMOVED"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};n=n.GL=n.GL||{};Object.defineProperty(n,"GLMain_REMOVED",{get:function(){return t===undefined&&(t=null,t=i(),delete n.GLMain_REMOVED,n.GLMain_REMOVED=t["_$ES.GL.GLMain_REMOVED"]),t["_$ES.GL.GLMain_REMOVED"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.GL.Vec3"]=function(n){function t(t,i,r){n.call(this);var u=this.vecArray=new _$ES.GL.Mat4.ARRAY_TYPE(3);u[0]=t;u[1]=i;u[2]=r}return t.prototype.vecArray=undefined,function(){}.call(t),t},function(){n["_$ES.GL.Vec3"]=n["_$ES.GL.Vec3"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};n=n.GL=n.GL||{};Object.defineProperty(n,"Vec3",{get:function(){return t===undefined&&(t=null,t=i(),delete n.Vec3,n.Vec3=t["_$ES.GL.Vec3"]),t["_$ES.GL.Vec3"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.createClass"]=function(n,t){return(n==null)?null:_$ES.F._extends(n(t),t||Object)},function(){}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"createClass",{get:function(){return t===undefined&&(t=null,t=i(),delete n.createClass,n.createClass=t["_$ES.createClass"]),t["_$ES.createClass"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.Draw.DrawStaticText"]=function(n){function t(t,i,r){n.call(this);this.tag=t;this.ctx=i;this.m=r;var u=t.matrix;u&&(u.tx||u.ty)&&r.translate(u.tx*r.a,u.ty*r.d)}return t.prototype.tag=undefined,t.prototype.m=undefined,t.prototype.ctx=undefined,Object.defineProperty(t.prototype,"draw",{value:function(){var c=null,o=null,s=NaN,n=null,h=NaN,l=NaN,r=NaN,a=NaN,u=null,f=0,v=0,t=this.ctx,i=this.m,e,y;for(t.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty),e=0,y=this.tag.textRecords.length;e<y;){for(n=this.tag.textRecords[e],n.fHasColor&&(c=n.color),n.fHasFont&&(s=n.textHeight,o=n.font),n.fHasXOffset&&(f=n.xOffset),n.fHasYOffset&&(v=n.yOffset),h=s/1024,l=1024/s,t.save(),t.beginPath(),t.translate(f,v),t.scale(h,h),r=0,a=n.glyphCount;r<a;)u=n.glyphEntries[r],o&&new _$ES.Draw.DrawShape(t,_$ES.Geoms.ESMatrix.EMPTY,_$ES.Geoms.ESColorTransform.EMPTY,null,!1).drawGlyphShape(o.glyphShapes[u.index]),f=f+u.advance,t.translate(u.advance*l,0),r++;t.fillStyle=_$ES.Temp.c1.setByInfo(c).toCssRGBA();t.fill("evenodd");t.restore();e++}return t}}),Object.defineProperty(t,"isPointInDefineText",{value:function(n,t,i,r){var s=null,a=NaN,u=null,h=NaN,e=NaN,v=NaN,c=null,f=i.matrix;f&&(f.tx||f.ty)&&(n=n-f.tx,t=t-f.ty);for(var o=0,y=0,l=0,p=i.textRecords.length;l<p;){for(u=i.textRecords[l],u.fHasFont&&(a=u.textHeight,s=u.font),u.fHasXOffset&&(o=u.xOffset),u.fHasYOffset&&(y=u.yOffset),h=1024/a,e=0,v=u.glyphCount;e<v;){if(c=u.glyphEntries[e],s&&_$ES.Draw.DrawShape.isPointInShape((n-o)*h,(t-y)*h,s.glyphShapes[c.index],r))return!0;o=o+c.advance;e++}l++}return!1}}),Object.defineProperty(t,"drawClip",{value:function(n,t,i){var h=null,c=NaN,r=null,l=NaN,v=NaN,e=NaN,y=NaN,o=null,u=i.matrix,f,a,s,p;for(u&&(u.tx||u.ty)&&t.translate(u.tx*t.a,u.ty*t.d),f=0,a=0,n.setTransform(t.a,t.b,t.c,t.d,t.tx,t.ty),s=0,p=i.textRecords.length;s<p;){for(r=i.textRecords[s],r.fHasFont&&(c=r.textHeight,h=r.font),r.fHasXOffset&&(f=r.xOffset),r.fHasYOffset&&(a=r.yOffset),l=c/1024,v=1024/c,n.save(),n.translate(f,a),n.scale(l,l),e=0,y=r.glyphCount;e<y;)o=r.glyphEntries[e],h&&_$ES.Draw.DrawShape.drawClip(n,null,h.glyphShapes[o.index],0),f=f+o.advance,n.translate(o.advance*v,0),e++;n.restore();s++}}}),function(){}.call(t),t},function(){n["_$ES.Draw.DrawStaticText"]=n["_$ES.Draw.DrawStaticText"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};n=n.Draw=n.Draw||{};Object.defineProperty(n,"DrawStaticText",{get:function(){return t===undefined&&(t=null,t=i(),delete n.DrawStaticText,n.DrawStaticText=t["_$ES.Draw.DrawStaticText"]),t["_$ES.Draw.DrawStaticText"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.Random"]=function(t){function i(n){t.call(this);this.seed=n>>>0}return i.prototype.seed=undefined,Object.defineProperty(i.prototype,"nextSeed",{value:function(){return(this.seed=this.seed*16807%2147483647)/2147483647}}),Object.defineProperty(i.prototype,"next",{value:function(n,t){return(this.seed=this.seed*16807%2147483647,arguments.length===2)?this.seed/2147483647*(t-n)+n:this.seed/2147483647}}),i.random=undefined,Object.defineProperty(i,"next",{value:function(t,r){return n["_$ES.Random"].random||(n["_$ES.Random"].random=new i(99)),n["_$ES.Random"].random.next(t,r)}}),function(){}.call(i),i},function(){n["_$ES.Random"]=n["_$ES.Random"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"Random",{get:function(){return t===undefined&&(t=null,t=i(),delete n.Random,n.Random=t["_$ES.Random"]),t["_$ES.Random"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.Base64"]=function(n){function t(){n.call(this)}return t.lookup=undefined,t.revLookup=undefined,t.Arr=undefined,Object.defineProperty(t,"init",{value:function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=0,i=t.length;n<i;)this.lookup[n]=t[n],this.revLookup[t.charCodeAt(n)]=n,n++;this.revLookup["-".charCodeAt(0)]=62;this.revLookup["_".charCodeAt(0)]=63}}),Object.defineProperty(t,"toByteArray",{value:function(n){var t=NaN,o=NaN,s=NaN,i=NaN,e=NaN,r,f=n.length,u;if(f%4>0)throw new Error("Invalid string. Length must be a multiple of 4");for(e=n[f-2]==="="?2:n[f-1]==="="?1:0,r=new this.Arr(f*3/4-e),s=e>0?f-4:f,u=0,t=0,o=0;t<s;)i=this.revLookup[n.charCodeAt(t)]<<18|this.revLookup[n.charCodeAt(t+1)]<<12|this.revLookup[n.charCodeAt(t+2)]<<6|this.revLookup[n.charCodeAt(t+3)],r[u++]=i>>16&255,r[u++]=i>>8&255,r[u++]=i&255,t=t+4,o=o+3;return e===2?(i=this.revLookup[n.charCodeAt(t)]<<2|this.revLookup[n.charCodeAt(t+1)]>>4,r[u++]=i&255):e===1&&(i=this.revLookup[n.charCodeAt(t)]<<10|this.revLookup[n.charCodeAt(t+1)]<<4|this.revLookup[n.charCodeAt(t+2)]>>2,r[u++]=i>>8&255,r[u++]=i&255),r}}),Object.defineProperty(t,"tripletToBase64",{value:function(n){return this.lookup[n>>18&63]+this.lookup[n>>12&63]+this.lookup[n>>6&63]+this.lookup[n&63]}}),Object.defineProperty(t,"encodeChunk",{value:function(n,t,i){for(var u=NaN,f=[],r=t;r<i;)u=(n[r]<<16)+(n[r+1]<<8)+n[r+2],f.push(this.tripletToBase64(u)),r=r+3;return f.join("")}}),Object.defineProperty(t,"fromByteArray",{value:function(n){for(var i=NaN,u=n.length,f=u%3,t="",e=[],o=16383,r=0,s=u-f;r<s;)e.push(this.encodeChunk(n,r,r+o>s?s:r+o)),r=r+o;return f===1?(i=n[u-1],t=t+this.lookup[i>>2],t=t+this.lookup[i<<4&63],t=t+"=="):f===2&&(i=(n[u-2]<<8)+n[u-1],t=t+this.lookup[i>>10],t=t+this.lookup[i>>4&63],t=t+this.lookup[i<<2&63],t=t+"="),e.push(t),e.join("")}}),function(){this.lookup=[];this.revLookup=[];this.Arr=(typeof Uint8Array=="undefined")?Array:Uint8Array}.call(t),t},function(){return n["_$ES.Base64"]=n["_$ES.Base64"](Object),n["_$ES.Base64"].init()}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"Base64",{get:function(){return t===undefined&&(t=null,t=i(),delete n.Base64,n.Base64=t["_$ES.Base64"]),t["_$ES.Base64"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.Main"]=function(){var i=null,u=null,r=null,f=null,e=null,a;_$ES.F.isInWorker()||_$ES.F.traceLog("# 闪归 flashreturn.com,ver:"+_$ES.F.VERSION+" #");Object.defineProperty(Object.prototype,"_$get",{value:function(n){return this[n]},enumeralbe:!1,configurable:!1});Object.defineProperty(Object.prototype,"_$set",{value:function(n,t){return this[n]=t},enumeralbe:!1,configurable:!1});Object.defineProperty(Object.prototype,"_$delete",{value:function(n){delete this[n]},enumeralbe:!1,configurable:!1});Object.defineProperty(Object.prototype,"_$in",{value:function(n){return n in this},enumeralbe:!1,configurable:!1});Object.defineProperty(Object.prototype,"_$forIn",{value:function(n){var t;for(var i in this)if(t=n(i))break;return t},enumeralbe:!1,configurable:!1});for(var o=Date.prototype,s=["date","dateUTC","day","dayUTC","fullYear","fullYearUTC","hours","hoursUTC","milliseconds","millisecondsUTC","minutes","minutesUTC","month","monthUTC","seconds","secondsUTC","time","timeZoneOffset"],h=["getDate","getUTCDate","getDay","getUTCDay","getFullYear","getUTCFullYear","getHours","getUTCHours","getMilliseconds","getUTCMilliseconds","getMinutes","getUTCMinutes","getMonth","getUTCMonth","getSeconds","getUTCSeconds","getTime","getTimezoneOffset"],c=["setDate","setUTCDate",null,null,"setFullYear","setUTCFullYear","setHours","setUTCHours","setMilliseconds","setUTCMilliseconds","setMinutes","setUTCMinutes","setMonth","setUTCMonth","setSeconds","setUTCSeconds","setTime",null],t=0,l=s.length;t<l;)i=s[t],u=h[t],r=c[t],e=new Function("return this."+u+"();"),r&&(f=new Function("v","this."+r+"(v);")),Object.hasOwnProperty.call(o,i)||Object.defineProperty(o,i,{get:e,set:f,enumeralbe:!1,configurable:!1}),t++;a=0;_$ES.F.isInWorker()||function(){var n;n=0;window.requestAnimationFrame=_$ES.F.JSAPIGet(window,["requestAnimationFrame"]);window.cancelAnimationFrame=_$ES.F.JSAPIGet(window,["cancelAnimationFrame"]);window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var i,r,u;return i=(new Date).getTime(),r=Math.max(0,16-(i-n)),u=window.setTimeout(function(){t(i+r)},r),n=i+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){window.clearTimeout(n)})}();self.URL=_$ES.F.JSAPIGet(self,["URL"]);self.Blob=_$ES.F.JSAPIGet(self,["Blob"]);self.AudioContext=_$ES.F.JSAPIGet(self,["AudioContext"]);self.BlobBuilder=_$ES.F.JSAPIGet(self,["BlobBuilder"]);self.WebSocket=_$ES.F.JSAPIGet(self,["WebSocket"]);Object.assign==null&&Object.defineProperty(Object,"assign",{value:function(n){var t,f,i,s,r,e,o,u;if(n===undefined||n===null)throw new TypeError("Cannot convert first argument to object");for(o=Object(n),u=1;u<arguments.length;){if(t=arguments[u],t!==undefined&&t!==null)for(f=Object.keys(Object(t)),i=0,s=f.length;i<s;)r=f[i],e=Object.getOwnPropertyDescriptor(t,r),e===undefined||!e.enumerable||(o[r]=t[r]),i++;u++}return o},writable:!0,enumeralbe:!1,configurable:!0});new Function("("+n.zlib+").call(this);")()},function(){return n.zlib='function(){"use strict";function t(n){throw n;}function c(n,t){var u=n.split("."),i=li,f;for((u[0]in i)||!i.execScript||i.execScript("var "+u[0]);u.length&&(f=u.shift());)!u.length&&t!==r?i[f]=t:i=i[f]?i[f]:i[f]={}}function l(i,r){this.index="number"==typeof r?r:0;this.i=0;this.buffer=i instanceof(n?Uint8Array:Array)?i:new(n?Uint8Array:Array)(32768);2*this.buffer.length<=this.index&&t(Error("invalid index"));this.buffer.length<=this.index&&this.f()}function d(t){this.buffer=new(n?Uint16Array:Array)(2*t);this.length=0}function p(t){for(var v=t.length,f=0,s=Number.POSITIVE_INFINITY,h,c,u,e,l,o,a,r,i=0;i<v;++i)t[i]>f&&(f=t[i]),t[i]<s&&(s=t[i]);for(h=1<<f,c=new(n?Uint32Array:Array)(h),u=1,e=0,l=2;u<=f;){for(i=0;i<v;++i)if(t[i]===u){for(o=0,a=e,r=0;r<u;++r)o=o<<1|a&1,a>>=1;for(r=o;r<h;r+=l)c[r]=u<<16|i;++e}++u;e<<=1;l<<=1}return[c,f,s]}function w(t,i){this.h=g;this.w=0;this.input=n&&t instanceof Array?new Uint8Array(t):t;this.b=0;i&&(i.lazy&&(this.w=i.lazy),"number"==typeof i.compressionType&&(this.h=i.compressionType),i.outputBuffer&&(this.a=n&&i.outputBuffer instanceof Array?new Uint8Array(i.outputBuffer):i.outputBuffer),"number"==typeof i.outputIndex&&(this.b=i.outputIndex));this.a||(this.a=new(n?Uint8Array:Array)(32768))}function vi(n,t){this.length=n;this.G=t}function wt(u,f){function w(n,r){var u=n.G,e=[],h=0,o,f,l,v;o=pt[n.length];e[h++]=o&65535;e[h++]=o>>16&255;e[h++]=o>>24;switch(i){case 1===u:f=[0,u-1,0];break;case 2===u:f=[1,u-2,0];break;case 3===u:f=[2,u-3,0];break;case 4===u:f=[3,u-4,0];break;case 6>=u:f=[4,u-5,1];break;case 8>=u:f=[5,u-7,1];break;case 12>=u:f=[6,u-9,2];break;case 16>=u:f=[7,u-13,2];break;case 24>=u:f=[8,u-17,3];break;case 32>=u:f=[9,u-25,3];break;case 48>=u:f=[10,u-33,4];break;case 64>=u:f=[11,u-49,4];break;case 96>=u:f=[12,u-65,5];break;case 128>=u:f=[13,u-97,5];break;case 192>=u:f=[14,u-129,6];break;case 256>=u:f=[15,u-193,6];break;case 384>=u:f=[16,u-257,7];break;case 512>=u:f=[17,u-385,7];break;case 768>=u:f=[18,u-513,8];break;case 1024>=u:f=[19,u-769,8];break;case 1536>=u:f=[20,u-1025,9];break;case 2048>=u:f=[21,u-1537,9];break;case 3072>=u:f=[22,u-2049,10];break;case 4096>=u:f=[23,u-3073,10];break;case 6144>=u:f=[24,u-4097,11];break;case 8192>=u:f=[25,u-6145,11];break;case 12288>=u:f=[26,u-8193,12];break;case 16384>=u:f=[27,u-12289,12];break;case 24576>=u:f=[28,u-16385,13];break;case 32768>=u:f=[29,u-24577,13];break;default:t("invalid distance")}for(o=f,e[h++]=o[0],e[h++]=o[1],e[h++]=o[2],l=0,v=e.length;l<v;++l)a[p++]=e[l];c[e[0]]++;g[e[3]]++;nt=n.length+r-1;s=null}var o,b,e,k,v,d={},l,y,s,a=n?new Uint16Array(2*f.length):[],p=0,nt=0,c=new(n?Uint32Array:Array)(286),g=new(n?Uint32Array:Array)(30),tt=u.w,h;if(!n){for(e=0;285>=e;)c[e++]=0;for(e=0;29>=e;)g[e++]=0}for(c[256]=1,o=0,b=f.length;o<b;++o){for(e=v=0,k=3;e<k&&o+e!==b;++e)v=v<<8|f[o+e];if(d[v]===r&&(d[v]=[]),l=d[v],!(0<nt--)){for(;0<l.length&&32768<o-l[0];)l.shift();if(o+3>=b){for(s&&w(s,-1),e=0,k=b-o;e<k;++e)h=f[o+e],a[p++]=h,++c[h];break}0<l.length?(y=yi(f,o,l),s?s.length<y.length?(h=f[o-1],a[p++]=h,++c[h],w(y,0)):w(s,-1):y.length<tt?s=y:w(y,0)):s?w(s,-1):(h=f[o],a[p++]=h,++c[h])}l.push(o)}return a[p++]=256,c[256]++,u.L=c,u.K=g,n?a.subarray(0,p):a}function yi(n,t,i){var e,h,u=0,r,o,f,s,c=n.length;o=0;s=i.length;n:for(;o<s;o++){if(e=i[s-o-1],r=3,3<u){for(f=u;3<f;f--)if(n[e+f-1]!==n[t+f-1])continue n;r=u}for(;258>r&&t+r<c&&n[e+r]===n[t+r];)++r;if(r>u&&(h=e,u=r),258===r)break}return new vi(u,t-h)}function ht(t,i){var h=t.length,u=new d(572),e=new(n?Uint8Array:Array)(h),f,o,c,r,s;if(!n)for(r=0;r<h;r++)e[r]=0;for(r=0;r<h;++r)0<t[r]&&u.push(r,t[r]);if(f=Array(u.length/2),o=new(n?Uint32Array:Array)(u.length/2),1===f.length)return e[u.pop().index]=1,e;for(r=0,s=u.length/2;r<s;++r)f[r]=u.pop(),o[r]=f[r].value;for(c=pi(o,o.length,i),r=0,s=f.length;r<s;++r)e[f[r].index]=c[r];return e}function pi(t,i,r){function p(n){var t=c[n][l[n]];t===i?(p(n+1),p(n+1)):--a[t];++l[n]}var f=new(n?Uint16Array:Array)(r),s=new(n?Uint8Array:Array)(r),a=new(n?Uint8Array:Array)(i),h=Array(r),c=Array(r),l=Array(r),w=(1<<r)-i,b=1<<r-1,o,u,e,v,y;for(f[r-1]=i,u=0;u<r;++u)w<b?s[u]=0:(s[u]=1,w-=b),w<<=1,f[r-2-u]=(f[r-1-u]/2|0)+i;for(f[0]=s[0],h[0]=Array(f[0]),c[0]=Array(f[0]),u=1;u<r;++u)f[u]>2*f[u-1]+s[u]&&(f[u]=2*f[u-1]+s[u]),h[u]=Array(f[u]),c[u]=Array(f[u]);for(o=0;o<i;++o)a[o]=r;for(e=0;e<f[r-1];++e)h[r-1][e]=t[e],c[r-1][e]=e;for(o=0;o<r;++o)l[o]=0;for(1===s[r-1]&&(--a[0],++l[r-1]),u=r-2;0<=u;--u){for(v=o=0,y=l[u+1],e=0;e<f[u];e++)v=h[u+1][y]+h[u+1][y+1],v>t[o]?(h[u][e]=v,c[u][e]=i,y+=2):(h[u][e]=t[o],c[u][e]=o,++o);l[u]=0;1===s[u]&&p(u)}return a}function ct(t){for(var f=new(n?Uint16Array:Array)(t.length),e=[],o=[],r=0,s,h,i=0,u=t.length;i<u;i++)e[t[i]]=(e[t[i]]|0)+1;for(i=1,u=16;i<=u;i++)o[i]=r,r+=e[i]|0,r<<=1;for(i=0,u=t.length;i<u;i++)for(r=o[t[i]],o[t[i]]+=1,s=f[i]=0,h=t[i];s<h;s++)f[i]=f[i]<<1|r&1,r>>>=1;return f}function e(i,r){this.l=[];this.m=32768;this.e=this.g=this.c=this.q=0;this.input=n?new Uint8Array(i):i;this.s=!1;this.n=nt;this.B=!1;!r&&(r={})||(r.index&&(this.c=r.index),r.bufferSize&&(this.m=r.bufferSize),r.bufferType&&(this.n=r.bufferType),r.resize&&(this.B=r.resize));switch(this.n){case lt:this.b=32768;this.a=new(n?Uint8Array:Array)(32768+this.m+258);break;case nt:this.b=0;this.a=new(n?Uint8Array:Array)(this.m);this.f=this.J;this.t=this.H;this.o=this.I;break;default:t(Error("invalid inflate mode"))}}function f(n,i){for(var e=n.g,f=n.e,s=n.input,o=n.c,u;f<i;)u=s[o++],u===r&&t(Error("input buffer is broken")),e|=u<<f,f+=8;return u=e&(1<<i)-1,n.g=e>>>i,n.e=f-i,n.c=o,u}function k(n,t){for(var u=n.g,i=n.e,c=n.input,s=n.c,l=t[0],h=t[1],f,e,o;i<h;){if(f=c[s++],f===r)break;u|=f<<i;i+=8}return e=l[u&(1<<h)-1],o=e>>>16,n.g=u>>o,n.e=i-o,n.c=s,e&65535}function wi(t){function u(n,t,i){for(var o,e,r,u=0;u<n;)switch(o=k(this,t),o){case 16:for(r=3+f(this,2);r--;)i[u++]=e;break;case 17:for(r=3+f(this,3);r--;)i[u++]=0;e=0;break;case 18:for(r=11+f(this,7);r--;)i[u++]=0;e=0;break;default:e=i[u++]=o}return i}for(var e=f(t,5)+257,o=f(t,5)+1,l=f(t,4)+4,s=new(n?Uint8Array:Array)(dt.length),r,h,c,i=0;i<l;++i)s[dt[i]]=f(t,3);r=p(s);h=new(n?Uint8Array:Array)(e);c=new(n?Uint8Array:Array)(o);t.o(p(u.call(t,e,r,h)),p(u.call(t,o,r,c)))}function hi(n){var t,i,o;if("string"==typeof n){for(t=n.split(""),i=0,o=t.length;i<o;i++)t[i]=(t[i].charCodeAt(0)&255)>>>0;n=t}for(var r=1,f=0,u=n.length,e,s=0;0<u;){e=1024<u?1024:u;u-=e;do r+=n[s++],f+=r;while(--e);r%=65521;f%=65521}return(f<<16|r)>>>0}function vt(n,i){var r,u;this.input=n;this.c=0;!i&&(i={})||(i.index&&(this.c=i.index),i.verify&&(this.M=i.verify));r=n[this.c++];u=n[this.c++];switch(r&15){case a:this.method=a;break;default:t(Error("unsupported compression method"))}0!=((r<<8)+u)%31&&t(Error("invalid fcheck flag:"+((r<<8)+u)%31));u&32&&t(Error("fdict flag is not supported"));this.A=new e(n,{index:this.c,bufferSize:i.bufferSize,bufferType:i.bufferType,resize:i.resize})}function ft(t,i){this.input=t;this.a=new(n?Uint8Array:Array)(32768);this.h=s.k;var r={},u;!i&&(i={})||"number"!=typeof i.compressionType||(this.h=i.compressionType);for(u in i)r[u]=i[u];r.outputBuffer=this.a;this.z=new w(this.input,r)}function ci(n,t){var r,u,i,f;if(Object.keys)r=Object.keys(t);else for(u in r=[],i=0,t)r[i++]=u;for(i=0,f=r.length;i<f;++i)u=r[i],c(n+"."+u,t[u])}var r=void 0,i=!0,li=this,n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,et,v,o,st,pt,ei,rt,ut,oi,si,a,s;for(l.prototype.f=function(){var i=this.buffer,t,u=i.length,r=new(n?Uint8Array:Array)(u<<1);if(n)r.set(i);else for(t=0;t<u;++t)r[t]=i[t];return this.buffer=r},l.prototype.d=function(n,t,i){var u=this.buffer,f=this.index,e=this.i,r=u[f],s;if(i&&1<t&&(n=8<t?(o[n&255]<<24|o[n>>>8&255]<<16|o[n>>>16&255]<<8|o[n>>>24&255])>>32-t:o[n]>>8-t),8>t+e)r=r<<t|n,e+=t;else for(s=0;s<t;++s)r=r<<1|n>>t-s-1&1,8==++e&&(e=0,u[f++]=o[r],r=0,f===u.length&&(u=this.f()));u[f]=r;this.buffer=u;this.i=e;this.index=f},l.prototype.finish=function(){var t=this.buffer,i=this.index,r;return 0<this.i&&(t[i]<<=8-this.i,t[i]=o[t[i]],i++),n?r=t.subarray(0,i):(t.length=i,r=t),r},et=new(n?Uint8Array:Array)(256),v=0;256>v;++v){for(var y=v,ot=y,yt=7,y=y>>>1;y;y>>>=1)ot<<=1,ot|=y&1,--yt;et[v]=(ot<<yt&255)>>>0}o=et;d.prototype.getParent=function(n){return 2*((n-2)/4|0)};d.prototype.push=function(n,t){var r,u,i=this.buffer,f;for(r=this.length,i[this.length++]=t,i[this.length++]=n;0<r;)if(u=this.getParent(r),i[r]>i[u])f=i[r],i[r]=i[u],i[u]=f,f=i[r+1],i[r+1]=i[u+1],i[u+1]=f,r=u;else break;return this.length};d.prototype.pop=function(){var u,f,n=this.buffer,r,t,i;for(f=n[0],u=n[1],this.length-=2,n[0]=n[this.length],n[1]=n[this.length+1],i=0;;){if(t=2*i+2,t>=this.length)break;if(t+2<this.length&&n[t+2]>n[t]&&(t+=2),n[t]>n[i])r=n[i],n[i]=n[t],n[t]=r,r=n[i+1],n[i+1]=n[t+1],n[t+1]=r;else break;i=t}return{index:u,value:f,length:this.length}};for(var g=2,ai={NONE:0,r:1,k:g,N:3},b=[],u=0;288>u;u++)switch(i){case 143>=u:b.push([u+48,8]);break;case 255>=u:b.push([u- -256,9]);break;case 279>=u:b.push([u-256,7]);break;case 287>=u:b.push([u-88,8]);break;default:t("invalid literal: "+u)}w.prototype.j=function(){var bt,ii,nt,ri,lt=this.input,tt,it,p,li,gt,ei,oi,d,di,pt,si,gi,nr,tr,ir;switch(this.h){case 0:for(nt=0,ri=lt.length;nt<ri;){ii=n?lt.subarray(nt,nt+65535):lt.slice(nt,nt+65535);nt+=ii.length;var ut=ii,rr=nt===ri,hi=r,kt=r,ui=r,dt=r,ci=r,e=this.a,c=this.b;if(n){for(e=new Uint8Array(this.a.buffer);e.length<=c+ut.length+5;)e=new Uint8Array(e.length<<1);e.set(this.a)}if(hi=rr?1:0,e[c++]=hi|0,kt=ut.length,ui=~kt+65536&65535,e[c++]=kt&255,e[c++]=kt>>>8&255,e[c++]=ui&255,e[c++]=ui>>>8&255,n)e.set(ut,c),c+=ut.length,e=e.subarray(0,c);else{for(dt=0,ci=ut.length;dt<ci;++dt)e[c++]=ut[dt];e.length=c}this.b=c;this.a=e}break;case 1:for(tt=new l(n?new Uint8Array(this.a.buffer):this.a,this.b),tt.d(1,1,i),tt.d(1,2,i),it=wt(this,lt),p=0,li=it.length;p<li;p++)if(gt=it[p],l.prototype.d.apply(tt,b[gt]),256<gt)tt.d(it[++p],it[++p],i),tt.d(it[++p],5),tt.d(it[++p],it[++p],i);else if(256===gt)break;this.a=tt.finish();this.b=this.a.length;break;case g:var h=new l(n?new Uint8Array(this.a.buffer):this.a,this.b),ai,rt,ft,et,ot,ur=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],at,vi,vt,yi,ni,fi=Array(19),pi,st,ti,o,wi;for(ai=g,h.d(1,1,i),h.d(ai,2,i),rt=wt(this,lt),at=ht(this.L,15),vi=ct(at),vt=ht(this.K,7),yi=ct(vt),ft=286;257<ft&&0===at[ft-1];ft--);for(et=30;1<et&&0===vt[et-1];et--);for(var bi=ft,ki=et,y=new(n?Uint32Array:Array)(bi+ki),w,f,yt,v=new(n?Uint32Array:Array)(316),a,s,k=new(n?Uint8Array:Array)(19),u=w=0;u<bi;u++)y[w++]=at[u];for(u=0;u<ki;u++)y[w++]=vt[u];if(!n)for(u=0,yt=k.length;u<yt;++u)k[u]=0;for(u=a=0,yt=y.length;u<yt;u+=w){for(w=1;u+w<yt&&y[u+w]===y[u];++w);if(f=w,0===y[u])if(3>f)for(;0<f--;)v[a++]=0,k[0]++;else for(;0<f;)s=138>f?f:138,s>f-3&&s<f&&(s=f-3),10>=s?(v[a++]=17,v[a++]=s-3,k[17]++):(v[a++]=18,v[a++]=s-11,k[18]++),f-=s;else if(v[a++]=y[u],k[y[u]]++,f--,3>f)for(;0<f--;)v[a++]=y[u],k[y[u]]++;else for(;0<f;)s=6>f?f:6,s>f-3&&s<f&&(s=f-3),v[a++]=16,v[a++]=s-3,k[16]++,f-=s}for(bt=n?v.subarray(0,a):v.slice(0,a),ni=ht(k,7),o=0;19>o;o++)fi[o]=ni[ur[o]];for(ot=19;4<ot&&0===fi[ot-1];ot--);for(pi=ct(ni),h.d(ft-257,5,i),h.d(et-1,5,i),h.d(ot-4,4,i),o=0;o<ot;o++)h.d(fi[o],3,i);for(o=0,wi=bt.length;o<wi;o++)if(st=bt[o],h.d(pi[st],ni[st],i),16<=st){o++;switch(st){case 16:ti=2;break;case 17:ti=3;break;case 18:ti=7;break;default:t("invalid code: "+st)}h.d(bt[o],ti,i)}for(ei=[vi,at],oi=[yi,vt],gi=ei[0],nr=ei[1],tr=oi[0],ir=oi[1],d=0,di=rt.length;d<di;++d)if(pt=rt[d],h.d(gi[pt],nr[pt],i),256<pt)h.d(rt[++d],rt[++d],i),si=rt[++d],h.d(tr[si],ir[si],i),h.d(rt[++d],rt[++d],i);else if(256===pt)break;this.a=h.finish();this.b=this.a.length;break;default:t("invalid compression type")}return this.a};st=function(){function f(n){switch(i){case 3===n:return[257,n-3,0];case 4===n:return[258,n-4,0];case 5===n:return[259,n-5,0];case 6===n:return[260,n-6,0];case 7===n:return[261,n-7,0];case 8===n:return[262,n-8,0];case 9===n:return[263,n-9,0];case 10===n:return[264,n-10,0];case 12>=n:return[265,n-11,1];case 14>=n:return[266,n-13,1];case 16>=n:return[267,n-15,1];case 18>=n:return[268,n-17,1];case 22>=n:return[269,n-19,2];case 26>=n:return[270,n-23,2];case 30>=n:return[271,n-27,2];case 34>=n:return[272,n-31,2];case 42>=n:return[273,n-35,3];case 50>=n:return[274,n-43,3];case 58>=n:return[275,n-51,3];case 66>=n:return[276,n-59,3];case 82>=n:return[277,n-67,4];case 98>=n:return[278,n-83,4];case 114>=n:return[279,n-99,4];case 130>=n:return[280,n-115,4];case 162>=n:return[281,n-131,5];case 194>=n:return[282,n-163,5];case 226>=n:return[283,n-195,5];case 257>=n:return[284,n-227,5];case 258===n:return[285,n-258,0];default:t("invalid length: "+n)}}for(var u=[],r,n=3;258>=n;n++)r=f(n),u[n]=r[2]<<24|r[1]<<16|r[0];return u}();pt=n?new Uint32Array(st):st;var lt=0,nt=1,bt={D:lt,C:nt};e.prototype.p=function(){for(var a;!this.s;){a=f(this,3);a&1&&(this.s=i);a>>>=1;switch(a){case 0:var c=this.input,u=this.c,h=this.a,e=this.b,o=r,s=r,v=r,y=h.length,l=r;this.e=this.g=0;o=c[u++];o===r&&t(Error("invalid uncompressed block header: LEN (first byte)"));s=o;o=c[u++];o===r&&t(Error("invalid uncompressed block header: LEN (second byte)"));s|=o<<8;o=c[u++];o===r&&t(Error("invalid uncompressed block header: NLEN (first byte)"));v=o;o=c[u++];o===r&&t(Error("invalid uncompressed block header: NLEN (second byte)"));v|=o<<8;s===~v&&t(Error("invalid uncompressed block header: length verify"));u+s>c.length&&t(Error("input buffer is broken"));switch(this.n){case lt:for(;e+s>h.length;){if(l=y-e,s-=l,n)h.set(c.subarray(u,u+l),e),e+=l,u+=l;else for(;l--;)h[e++]=c[u++];this.b=e;h=this.f();e=this.b}break;case nt:for(;e+s>h.length;)h=this.f({v:2});break;default:t(Error("invalid inflate mode"))}if(n)h.set(c.subarray(u,u+s),e),e+=s,u+=s;else for(;s--;)h[e++]=c[u++];this.c=u;this.b=e;this.a=h;break;case 1:this.o(ei,si);break;case 2:wi(this);break;default:t(Error("unknown BTYPE: "+a))}}return this.t()};for(var kt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],dt=n?new Uint16Array(kt):kt,gt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],ni=n?new Uint16Array(gt):gt,ti=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],tt=n?new Uint8Array(ti):ti,ii=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],ri=n?new Uint16Array(ii):ii,ui=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],it=n?new Uint8Array(ui):ui,at=new(n?Uint8Array:Array)(288),h=0,fi=at.length;h<fi;++h)at[h]=143>=h?8:255>=h?9:279>=h?7:8;for(ei=p(at),rt=new(n?Uint8Array:Array)(30),ut=0,oi=rt.length;ut<oi;++ut)rt[ut]=5;si=p(rt);e.prototype.o=function(n,t){var u=this.a,i=this.b,o,r,e,s,h;for(this.u=n,o=u.length-258;256!==(r=k(this,n));)if(256>r)i>=o&&(this.b=i,u=this.f(),i=this.b),u[i++]=r;else for(e=r-257,h=ni[e],0<tt[e]&&(h+=f(this,tt[e])),r=k(this,t),s=ri[r],0<it[r]&&(s+=f(this,it[r])),i>=o&&(this.b=i,u=this.f(),i=this.b);h--;)u[i]=u[i++-s];for(;8<=this.e;)this.e-=8,this.c--;this.b=i};e.prototype.I=function(n,t){var i=this.a,u=this.b,e,r,o,h,s;for(this.u=n,e=i.length;256!==(r=k(this,n));)if(256>r)u>=e&&(i=this.f(),e=i.length),i[u++]=r;else for(o=r-257,s=ni[o],0<tt[o]&&(s+=f(this,tt[o])),r=k(this,t),h=ri[r],0<it[r]&&(h+=f(this,it[r])),u+s>e&&(i=this.f(),e=i.length);s--;)i[u]=i[u++-h];for(;8<=this.e;)this.e-=8,this.c--;this.b=u};e.prototype.f=function(){var r=new(n?Uint8Array:Array)(this.b-32768),u=this.b-32768,t,f,i=this.a;if(n)r.set(i.subarray(32768,r.length));else for(t=0,f=r.length;t<f;++t)r[t]=i[t+32768];if(this.l.push(r),this.q+=r.length,n)i.set(i.subarray(u,u+32768));else for(t=0;32768>t;++t)i[t]=i[u+t];return this.b=32768,i};e.prototype.J=function(t){var r,u=this.input.length/this.c+1|0,o,f,e,s=this.input,i=this.a;return t&&("number"==typeof t.v&&(u=t.v),"number"==typeof t.F&&(u+=t.F)),2>u?(o=(s.length-this.c)/this.u[2],e=129*o|0,f=e<i.length?i.length+e:i.length<<1):f=i.length*u,n?(r=new Uint8Array(f),r.set(i)):r=i,this.a=r};e.prototype.t=function(){var o=0,h=this.a,u=this.l,f,e=new(n?Uint8Array:Array)(this.q+(this.b-32768)),t,i,r,s;if(0===u.length)return n?this.a.subarray(32768,this.b):this.a.slice(32768,this.b);for(t=0,i=u.length;t<i;++t)for(f=u[t],r=0,s=f.length;r<s;++r)e[o++]=f[r];for(t=32768,i=this.b;t<i;++t)e[o++]=h[t];return this.l=[],this.buffer=e};e.prototype.H=function(){var t,i=this.b;return n?this.B?(t=new Uint8Array(i),t.set(this.a.subarray(0,i))):t=this.a.subarray(0,i):(this.a.length>i&&(this.a.length=i),t=this.a),this.buffer=t};vt.prototype.p=function(){var n=this.input,i,r;return i=this.A.p(),this.c=this.A.c,this.M&&(r=(n[this.c++]<<24|n[this.c++]<<16|n[this.c++]<<8|n[this.c++])>>>0,r!==hi(i)&&t(Error("invalid adler-32 checksum"))),i};a=8;s=ai;ft.prototype.j=function(){var f,c,o,h,e,u,i,r=0;i=this.a;f=a;switch(f){case a:c=Math.LOG2E*Math.log(32768)-8;break;default:t(Error("invalid compression method"))}o=c<<4|f;i[r++]=o;switch(f){case a:switch(this.h){case s.NONE:e=0;break;case s.r:e=1;break;case s.k:e=2;break;default:t(Error("unsupported compression type"))}break;default:t(Error("invalid compression method"))}return h=e<<6|0,i[r++]=h|31-(256*o+h)%31,u=hi(this.input),this.z.b=r,i=this.z.j(),r=i.length,n&&(i=new Uint8Array(i.buffer),i.length<=r+4&&(this.a=new Uint8Array(i.length+4),this.a.set(i),i=this.a),i=i.subarray(0,r+4)),i[r++]=u>>24&255,i[r++]=u>>16&255,i[r++]=u>>8&255,i[r++]=u&255,i};c("Zlib.Inflate",vt);c("Zlib.Inflate.prototype.decompress",vt.prototype.p);ci("Zlib.Inflate.BufferType",{ADAPTIVE:bt.C,BLOCK:bt.D});c("Zlib.Deflate",ft);c("Zlib.Deflate.compress",function(n,t){return new ft(n,t).j()});c("Zlib.Deflate.prototype.compress",ft.prototype.j);ci("Zlib.Deflate.CompressionType",{NONE:s.NONE,FIXED:s.r,DYNAMIC:s.k});w.prototype.compress=w.prototype.j;Zlib.RawDeflate=w;e.prototype.decompress=e.prototype.p;Zlib.RawInflate=e}',n["_$ES.Main"]()}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};t=i();Object.defineProperty(n,"Main",{get:function(){return t["_$ES.Main"]},set:function(n){t["_$ES.Main"]=n},enumerable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.ESFastLinkedList"]=function(n){function t(){this.id=_$ES.F.id++;this.iteratorList=[];n.call(this)}return t.prototype.id=undefined,t.prototype.count=0,t.prototype.firstNode=undefined,t.prototype.lastNode=undefined,t.prototype.iteratorList=undefined,t.prototype.iteratorListLength=0,t.prototype.theIterator=undefined,Object.defineProperty(t.prototype,"beginReader",{value:function(n){n===undefined&&(n=null);var i=this.iteratorList,t=_$ES.ESFastLinkedListIterator.pop(this,n);return this.theIterator!=null&&(i.push(this.theIterator),this.iteratorListLength++,this.theIterator=null),this.iteratorListLength>0?(i.push(t),this.iteratorListLength++):this.theIterator=t,t}}),Object.defineProperty(t.prototype,"endReader",{value:function(n){var t=this.iteratorList;n===this.theIterator?this.theIterator=null:(_$ES.F.removeArray(t,n),--this.iteratorListLength==1&&(this.theIterator=t.pop(),this.iteratorListLength=0));_$ES.ESFastLinkedListIterator.push(n)}}),Object.defineProperty(t.prototype,"clear",{value:function(){for(var t=null,n=this.firstNode;n;)t=n.nextNode,_$ES.Pools.pushFastLinkedListNode(this.id,n),n=t;this.firstNode=this.lastNode=null;this.iteratorList.length=0;this.theIterator=null;this.count=0}}),Object.defineProperty(t.prototype,"has",{value:function(n){var t=n.getLinkedNode(this.id);return t&&t.linkedList===this}}),Object.defineProperty(t.prototype,"get",{value:function(n){return n.getLinkedNode(this.id)}}),Object.defineProperty(t.prototype,"insert",{value:function(n,t){var r=null,u=null,i=n.getLinkedNode(this.id);i&&i.linkedList.remove(n);i=_$ES.Pools.popFastLinkedListNode(n,this);n.setLinkedNode(this.id,i);t?(r=t.prevNode,r?(r.nextNode=i,i.prevNode=r):this.firstNode=i,t.prevNode=i,i.nextNode=t):(u=this.lastNode,u?(u.nextNode=i,i.prevNode=u):this.firstNode=i,this.lastNode=i);this.count++}}),Object.defineProperty(t.prototype,"removeNode",{value:function(n){var t=null,i=null,f=null,r=null,u=NaN,o=NaN,e=null;if(n&&n.linkedList===this){if(t=n.prevNode,i=n.nextNode,f=this.iteratorList,r=this.theIterator,r)r.currentNode==n&&(r.currentNode=t);else for(u=0,o=f.length;u<o;)e=f[u],e.currentNode==n&&(e.currentNode=t),u++;return n===this.firstNode&&(this.firstNode=i),n===this.lastNode&&(this.lastNode=t),t&&(t.nextNode=i),i&&(i.prevNode=t),this.count--,_$ES.Pools.pushFastLinkedListNode(this.id,n),!0}return!1}}),Object.defineProperty(t.prototype,"remove",{value:function(n){var t=null;n&&(t=n.getLinkedNode(this.id))&&this.removeNode(t)}}),function(){}.call(t),t},function(){n["_$ES.ESFastLinkedList"]=n["_$ES.ESFastLinkedList"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"ESFastLinkedList",{get:function(){return t===undefined&&(t=null,t=i(),delete n.ESFastLinkedList,n.ESFastLinkedList=t["_$ES.ESFastLinkedList"]),t["_$ES.ESFastLinkedList"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.Pools"]=function(n){function t(){n.call(this)}return Object.defineProperty(t,"createObj",{value:function(n,t,i){i===undefined&&(i=8);for(var r=0;r<i;)n.push(new t),r++;return i}}),Object.defineProperty(t,"createObjByFunction",{value:function(n,t,i){i===undefined&&(i=8);for(var r=0;r<i;)n.push(t()),r++;return i}}),t.poolRenderInfo=undefined,Object.defineProperty(t,"pushRenderInfo",{value:function(n){n.reset();_$ES.Pools.poolRenderInfo.push(n)}}),Object.defineProperty(t,"popRenderInfo",{value:function(n,t,i){var u=_$ES.Pools.poolRenderInfo,r;return u.length==0&&_$ES.Pools.createObjByFunction(u,function(){var n=new _$ES.RenderInfoV2;return n.preRender=i,n.isUpdateMatrix=!0,n.isUpdateBounds=!0,n.isUpdateTexture=!0,n.playerCT=null,n.playerCT2=new _$ES.Geoms.ESColorTransform,n.playerMatrix=new _$ES.Geoms.ESMatrix,n.playerBounds=new _$ES.Geoms.ESRectangle,n.playerBoundsP1=new _$ES.Geoms.ESPoint,n.playerBoundsP2=new _$ES.Geoms.ESPoint,n.playerBoundsP3=new _$ES.Geoms.ESPoint,n.playerBoundsP4=new _$ES.Geoms.ESPoint,n.playerBoundsInStage=!0,n}),r=u.pop(),r.displayObject=n,r.canDraw=t,r.preRender=i,r}}),t.poolCanvasAllocateResult=undefined,Object.defineProperty(t,"pushCanvasAllocateResult",{value:function(n){n.sprite=null;n.mainRect=null;n.vertexX=0;n.vertexY=0;n.vertexLocation=0;n.width=0;n.height=0;n.isSucceed=!1;n.x=n.y=0;n.lastColumnsRect=n.lastRowsRect=null;n.separateColumns=n.separateRows=!1;n.separateColumnsWidth=n.separateRowsHeight=0;n.realLength=0;_$ES.Pools.poolCanvasAllocateResult.push(n)}}),Object.defineProperty(t,"popCanvasAllocateResult",{value:function(n,t,i,r,u,f,e){var s=_$ES.Pools.poolCanvasAllocateResult,o;return s.length==0&&_$ES.Pools.createObjByFunction(s,function(){return{sprite:null,vertexX:0,vertexY:0,width:0,height:0,mainRect:null,vertexLocation:0,realLength:0}}),o=s.pop(),o.sprite=n,o.mainRect=f,o.vertexX=t,o.vertexY=i,o.vertexLocation=e,o.width=r,o.height=u,o}}),t.poolCanvasSpriteRect=undefined,Object.defineProperty(t,"pushCanvasSpriteRect",{value:function(n){n.isUsed=!1;n.allocateResult=null;n.bottomRect=n.topRect=n.leftRect=n.rightRect=null;n.sprite=null;n.x=n.y=n.width=n.height=n.vertexX=n.vertexY=n.vertexLocation=0;_$ES.Pools.poolCanvasSpriteRect.push(n)}}),Object.defineProperty(t,"popCanvasSpriteRect",{value:function(n,t,i,r,u){var e=_$ES.Pools.poolCanvasSpriteRect,f;return e.length==0&&_$ES.Pools.createObjByFunction(e,function(){return new _$ES.CanvasSpriteRect(null,0,0,0,0)},4096),f=e.pop(),f.sprite=n,f.x=t,f.y=i,f.width=r,f.height=u,f}}),t.poolFastLinkedListNode=undefined,Object.defineProperty(t,"pushFastLinkedListNode",{value:function(n,t){t.linkedList=null;t.obj.setLinkedNode(n,null);t.obj=null;t.prevNode=t.nextNode=null;_$ES.Pools.poolFastLinkedListNode.push(t)}}),Object.defineProperty(t,"popFastLinkedListNode",{value:function(n,t){var r=_$ES.Pools.poolFastLinkedListNode,i;return r.length==0&&_$ES.Pools.createObjByFunction(r,function(){return{}},64),i=r.pop(),i.obj=n,i.linkedList=t,i}}),function(){this.poolRenderInfo=[];this.poolCanvasAllocateResult=[];this.poolCanvasSpriteRect=[];this.poolFastLinkedListNode=[]}.call(t),t},function(){n["_$ES.Pools"]=n["_$ES.Pools"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"Pools",{get:function(){return t===undefined&&(t=null,t=i(),delete n.Pools,n.Pools=t["_$ES.Pools"]),t["_$ES.Pools"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.ESMap"]=function(n){function t(){n.call(this);this.arrKey=[];this.arrVal=[]}return t.prototype.arrKey=undefined,t.prototype.arrVal=undefined,Object.defineProperty(t.prototype,"set",{value:function(n,t){var i=NaN;return(i=this.arrKey.indexOf(n))==-1?(this.arrKey.push(n),this.arrVal.push(t)):this.arrVal[i]=t,this}}),Object.defineProperty(t.prototype,"get",{value:function(n){var t=this.arrKey.indexOf(n);return t!=-1?this.arrVal[t]:undefined}}),Object.defineProperty(t.prototype,"clear",{value:function(){this.arrKey.length=this.arrVal.length=0}}),Object.defineProperty(t.prototype,"has",{value:function(n){return!(this.arrKey.indexOf(n)==-1)}}),Object.defineProperty(t.prototype,"delete",{value:function(n){var t=this.arrKey.indexOf(n);return t==-1?!1:(this.arrKey.splice(t,1),this.arrVal.splice(t,1),!0)}}),Object.defineProperty(t.prototype,"forEach",{value:function(n){var t=null,i;t=this.arrKey;i=this.arrVal;i.forEach(function(i,r){n(i,t[r])})}}),Object.defineProperty(t.prototype,"size",{get:function(){return this.arrKey.length},set:undefined}),function(){}.call(t),t},function(){return n["_$ES.ESMap"]=n["_$ES.ESMap"](Object),self.Map=_$ES.F.JSAPIGet(self,["Map"])||n["_$ES.ESMap"]}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};t=i();Object.defineProperty(n,"ESMap",{get:function(){return t["_$ES.ESMap"]},set:function(n){t["_$ES.ESMap"]=n},enumerable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.TypeInfo"]=function(n){function t(t,i){if(n.call(this),!t||!Object.hasOwnProperty.call(t,"_$TypeInfo"))throw new Error("对象不包含类型信息");this.typeSource=t;this.typeManage=i;var r=t._$TypeInfo,u=0;if(this.typeInfoSource=r,this.fullName=r.fullName,this.extendsType=r.theExtends==null?null:this.typeManage.get(r.theExtends),this.isImplements=r.isInterface?!0:!1,this.so=r.so,this.swfParse=r.so.swfParse,this.appDomain=r.so.appDomain,this.theImplements=[],r.theImplements&&r.theImplements.length>0)for(u=0;u<r.theImplements.length;)this.theImplements.push(this.typeManage.get(r.theImplements[u])),u++;if(this.isGenericType=r.isGenericType?!0:!1,this.isGenericType&&(this.genericType=this.typeManage.get(r.genericType),this.genericParamTypes=[],r.genericParamTypes&&r.genericParamTypes.length>0))for(u=0;u<r.genericParamTypes.length;)this.genericParamTypes.push(this.typeManage.get(r.genericParamTypes[u])),u++}return t.prototype.typeManage=undefined,Object.defineProperty(t.prototype,"makeGeneric",{value:function(n){if(this.typeSource==this.typeManage.AS_Vector)return this.makeGeneric_Vector(n);throw new Error("暂不支持除Vector以外的泛型类型");}}),Object.defineProperty(t.prototype,"makeGeneric_Vector",{value:function(n){var u=null,e=null,o=null,r=null,s=this.typeManage.get(n[0]),t=this.typeManage.appDomainRoot,f=this.typeManage.get(this.typeManage.AS_$Vector),i=f.fullName.replace("_$Vector","Vector.<"+s.fullName+">");return t.hasClass(i)||(u=t.getDefine(f.fullName),e={fullName:i,refs:u.refs,fun:new Function("return "+u.fun.toString().replace(new RegExp(f.fullName.replace(/\./g,"\\.").replace(/\$/g,"\\$"),"g"),i))()},t.addDefine(e,this.typeManage.appInfo.appSWFParse),o=t.getClass(i),r=o._$TypeInfo,r.isGenericType=!0,r.genericType=this.typeManage.AS_Vector,r.genericParamTypes=n),this.typeManage.get(t.getClass(i))}}),t.prototype._allInstanceKeys=undefined,t.prototype._allClassKeys=undefined,Object.defineProperty(t.prototype,"isEqualOrExtendsOrImplements",{value:function(n){if(!n)return!1;if(this===n||this.extendsType&&this.extendsType.isEqualOrExtendsOrImplements(n))return!0;for(var t=0;t<this.theImplements.length;){if(this.theImplements[t].isEqualOrExtendsOrImplements(n))return!0;t++}return!1}}),Object.defineProperty(t.prototype,"getSymbol",{value:function(){var t=null,n=this.swfParse;return n&&n.tag_SymbolClass&&n.tag_SymbolClass.nameAndTag&&(t=n.tag_SymbolClass.nameAndTag[this.fullName],!t&&this.extendsType)?this.extendsType.getSymbol():t}}),t.prototype.typeSource=undefined,t.prototype.typeInfoSource=undefined,t.prototype.fullName=undefined,t.prototype.extendsType=undefined,t.prototype.theImplements=undefined,t.prototype.isImplements=!1,t.prototype.isGenericType=!1,t.prototype.genericParamTypes=undefined,t.prototype.genericType=undefined,t.prototype.appDomain=undefined,t.prototype.swfParse=undefined,t.prototype.so=undefined,Object.defineProperty(t.prototype,"allInstanceKeys",{get:function(){var i,t=null,n=NaN;if(this._allInstanceKeys==null){if(this._allInstanceKeys={},this.extendsType!=null)for(i in this.extendsType.allInstanceKeys)this._allInstanceKeys[i]=null;if(!(this.typeSource==null)&&!(this.typeSource.prototype==null))for(t=Object.getOwnPropertyNames(this.typeSource.prototype),n=0;n<t.length;)this._allInstanceKeys[t[n]]=null,n++}return this._allInstanceKeys},set:undefined}),Object.defineProperty(t.prototype,"allClassKeys",{get:function(){var t=null,n=NaN;if(this._allClassKeys==null&&(this._allClassKeys={},this.typeSource!=null))for(t=Object.getOwnPropertyNames(this.typeSource),n=0;n<t.length;)this._allClassKeys[t[n]]=null,n++;return this._allClassKeys},set:undefined}),function(){}.call(t),t},function(){n["_$ES.TypeInfo"]=n["_$ES.TypeInfo"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"TypeInfo",{get:function(){return t===undefined&&(t=null,t=i(),delete n.TypeInfo,n.TypeInfo=t["_$ES.TypeInfo"]),t["_$ES.TypeInfo"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.Draw_REMOVED"]=function(n){function t(){n.call(this)}return function(){}.call(t),t},function(){n["_$ES.Draw_REMOVED"]=n["_$ES.Draw_REMOVED"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"Draw_REMOVED",{get:function(){return t===undefined&&(t=null,t=i(),delete n.Draw_REMOVED,n.Draw_REMOVED=t["_$ES.Draw_REMOVED"]),t["_$ES.Draw_REMOVED"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.TypeManage"]=function(n){function t(t){this.classAliasDic=[];this.aliasClassDic=[];n.call(this);this.appInfo=t;this.appDomainRoot=t.appDomainRoot}return t.prototype.appDomainRoot=undefined,t.prototype.appInfo=undefined,t.prototype._asArray=undefined,t.prototype._asString=undefined,t.prototype._asFunction=undefined,t.prototype._asint=undefined,t.prototype._asuint=undefined,t.prototype._asNumber=undefined,t.prototype._asObject=undefined,t.prototype._asBoolean=undefined,t.prototype._asVector=undefined,t.prototype._asXML=undefined,t.prototype._asXMLList=undefined,t.prototype._as_$Vector=undefined,t.prototype._asArgumentError=undefined,t.prototype._asReferenceError=undefined,t.prototype._asTypeError=undefined,t.prototype._asMethodClosure=undefined,t.prototype._asBuiltinShape=undefined,Object.defineProperty(t.prototype,"isClass",{value:function(n){return!(n==null)&&!(n._$TypeInfo==null)}}),Object.defineProperty(t.prototype,"isClassInstance",{value:function(n){return!(n==null)&&this.isClass(n.constructor)}}),Object.defineProperty(t.prototype,"isInterface",{value:function(n){var t=null;return n&&Object.hasOwnProperty.call(n,"_$TypeInfo")?(t=n._$TypeInfo,t.isInterface):!1}}),Object.defineProperty(t.prototype,"getSymbol",{value:function(n){if(!n)return null;var t=this.get3(n);return t||(t=this.get3(n.constructor)),t.getSymbol()}}),Object.defineProperty(t.prototype,"get",{value:function(n){var t=this.get3(n);return t||(t=this.get2(n)),t}}),Object.defineProperty(t.prototype,"get2",{value:function(n){if(n===null||n===undefined)n=null;else if(n.constructor&&Object.hasOwnProperty.call(n.constructor,"_$TypeInfo"))n=n.constructor;else if(Array.isArray(n))n=this.AS_Array;else switch(typeof n){default:n=null;break;case"undefined":n=null;break;case"string":n=this.AS_String;break;case"function":n=this.AS_Function;break;case"number":n=n>>0===n?this.AS_int:this.AS_Number;break;case"object":n=this.AS_Object;break;case"boolean":n=this.AS_Boolean}return n!=null?this.get3(n):null}}),Object.defineProperty(t.prototype,"get3",{value:function(n){var t=null;return this.isClass(n)?(t=n._$TypeInfo,t.typeInfo||(t.typeInfo=new _$ES.TypeInfo(n,this)),t.typeInfo):null}}),Object.defineProperty(t.prototype,"makeGeneric",{value:function(n,t){return this.get3(n).makeGeneric(t).typeSource}}),Object.defineProperty(t.prototype,"IS",{value:function(n,t){var u=NaN,i,r;if(n instanceof t||(i=this.get3(t),this.isClass(n)&&this.isClass(t)&&i.fullName=="Class")||n instanceof Array&&i.fullName=="Array")return!0;if(r=this.get2(n),!r||!i)return!1;var e=this.get3(this.AS_int),o=this.get3(this.AS_uint),f=this.get3(this.AS_Number);return typeof n=="number"||r==e||r==o||r==f?(u=n+0,u>>0!==u?i==f?!0:!1:u>>>0!==u?i==f||i==e?!0:!1:i==f||i==e||i==o?!0:!1):r.isEqualOrExtendsOrImplements(i)}}),Object.defineProperty(t.prototype,"isVector",{value:function(n){return this.isVector_ParamIsType(this.get2(n))}}),Object.defineProperty(t.prototype,"isVector_ParamIsType",{value:function(n){return!(n==null)&&n.isGenericType&&n.genericType.typeSource==this.AS_Vector?!0:!1}}),Object.defineProperty(t.prototype,"AS",{value:function(n,t){return this.IS(n,t)?n:null}}),Object.defineProperty(t.prototype,"CAST_SimpleArgs",{value:function(n,t){if(!n||!t||!t.length)throw new this.ASArgumentError("类强制转换的参数数量不匹配。应为 1 个，当前为 0 个。");return this.CAST_Simple(t[0],n)}}),Object.defineProperty(t.prototype,"CAST_Simple",{value:function(n,t){if(t===this.AS_Object)return n;if(n===null||n===undefined)return null;if(this.AS(n,t)!==null)return n;throw new this.ASTypeError('Error #1034: 强制转换类型失败:无法将 "'+n+'" 转换为 '+this.get(t).fullName+"。");}}),Object.defineProperty(t.prototype,"CAST",{value:function(n,t){return t===this.AS_Number?this.AS_Number(n):t===this.AS_uint?this.AS_uint(n):t===this.AS_int?this.AS_int(n):t===this.AS_Boolean?this.AS_Boolean(n):t===this.AS_String?n!=null?n.toString():null:this.CAST_Simple(n,t)}}),t.prototype.classAliasDic=undefined,t.prototype.aliasClassDic=undefined,Object.defineProperty(t.prototype,"registerClassAlias",{value:function(n,t){var f=null,r=null,i=null,u;return n==null||t==null||(f=this.get3(t))==null?!1:(u=this.aliasClassDic[n],u===t)?!0:(u!=null&&(r=this.get3(u).fullName,i=this.classAliasDic[r],i.splice(i.indexOf(n),1),i.length==0&&delete this.classAliasDic[r],delete this.aliasClassDic[n]),r=f.fullName,i=this.classAliasDic[r],i||(this.classAliasDic[r]=i=[]),i.push(n),this.aliasClassDic[n]=t,!0)}}),Object.defineProperty(t.prototype,"getClassByAlias",{value:function(n){return this.aliasClassDic[n]}}),Object.defineProperty(t.prototype,"AS_Array",{get:function(){return this._asArray==null&&(this._asArray=this.appDomainRoot.getClass("Array")),this._asArray},set:undefined}),Object.defineProperty(t.prototype,"AS_String",{get:function(){return this._asString==null&&(this._asString=this.appDomainRoot.getClass("String")),this._asString},set:undefined}),Object.defineProperty(t.prototype,"AS_Function",{get:function(){return this._asFunction==null&&(this._asFunction=this.appDomainRoot.getClass("Function")),this._asFunction},set:undefined}),Object.defineProperty(t.prototype,"AS_int",{get:function(){return this._asint==null&&(this._asint=this.appDomainRoot.getClass("int")),this._asint},set:undefined}),Object.defineProperty(t.prototype,"AS_uint",{get:function(){return this._asuint==null&&(this._asuint=this.appDomainRoot.getClass("uint")),this._asuint},set:undefined}),Object.defineProperty(t.prototype,"AS_Number",{get:function(){return this._asNumber==null&&(this._asNumber=this.appDomainRoot.getClass("Number")),this._asNumber},set:undefined}),Object.defineProperty(t.prototype,"AS_Object",{get:function(){return this._asObject==null&&(this._asObject=this.appDomainRoot.getClass("Object")),this._asObject},set:undefined}),Object.defineProperty(t.prototype,"AS_Boolean",{get:function(){return this._asBoolean==null&&(this._asBoolean=this.appDomainRoot.getClass("Boolean")),this._asBoolean},set:undefined}),Object.defineProperty(t.prototype,"AS_Vector",{get:function(){return this._asVector==null&&(this._asVector=this.appDomainRoot.getClass("__AS3__.vec::Vector")),this._asVector},set:undefined}),Object.defineProperty(t.prototype,"AS_XML",{get:function(){return this._asXML==null&&(this._asXML=this.appDomainRoot.getClass("XML")),this._asXML},set:undefined}),Object.defineProperty(t.prototype,"AS_XMLList",{get:function(){return this._asXMLList==null&&(this._asXMLList=this.appDomainRoot.getClass("XMLList")),this._asXMLList},set:undefined}),Object.defineProperty(t.prototype,"AS_$Vector",{get:function(){return this._as_$Vector==null&&(this._as_$Vector=this.appDomainRoot.getClass("__AS3__.vec::_$Vector")),this._as_$Vector},set:undefined}),Object.defineProperty(t.prototype,"ASArgumentError",{get:function(){return this._asArgumentError==null&&(this._asArgumentError=this.appDomainRoot.getClass("ArgumentError")),this._asArgumentError},set:undefined}),Object.defineProperty(t.prototype,"ASReferenceError",{get:function(){return this._asReferenceError==null&&(this._asReferenceError=this.appDomainRoot.getClass("ReferenceError")),this._asReferenceError},set:undefined}),Object.defineProperty(t.prototype,"ASTypeError",{get:function(){return this._asTypeError==null&&(this._asTypeError=this.appDomainRoot.getClass("TypeError")),this._asTypeError},set:undefined}),Object.defineProperty(t.prototype,"ASMethodClosure",{get:function(){return this._asMethodClosure==null&&(this._asMethodClosure=this.appDomainRoot.getClass("builtin.as$0::MethodClosure")),this._asMethodClosure},set:undefined}),Object.defineProperty(t.prototype,"ASBuiltinShape",{get:function(){return this._asBuiltinShape==null&&(this._asBuiltinShape=this.appDomainRoot.getClass("builtin::_$Builtin_Shape")),this._asBuiltinShape},set:undefined}),function(){}.call(t),t},function(){n["_$ES.TypeManage"]=n["_$ES.TypeManage"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"TypeManage",{get:function(){return t===undefined&&(t=null,t=i(),delete n.TypeManage,n.TypeManage=t["_$ES.TypeManage"]),t["_$ES.TypeManage"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.ESLinkedListIterator"]=function(n){function t(){n.call(this)}return t.prototype.list=undefined,t.prototype.currentNode=undefined,t.prototype.direction=undefined,Object.defineProperty(t.prototype,"next",{value:function(){var n=this.currentNode,t=this.direction,i=null;return this.currentNode=n?n=t==="next"?n.nextNode:n.prevNode:n=t==="next"?this.list.firstNode:this.list.lastNode,n&&(i=n.obj),i}}),t.iteratorList=undefined,Object.defineProperty(t,"pop",{value:function(n,i,r){var u=_$ES.ESLinkedListIterator.iteratorList.pop()||new t;return u.currentNode=i,u.direction=r,u.list=n,u}}),Object.defineProperty(t,"push",{value:function(n){n.currentNode=null;n.list=null;_$ES.ESLinkedListIterator.iteratorList.push(n)}}),function(){this.iteratorList=[]}.call(t),t},function(){n["_$ES.ESLinkedListIterator"]=n["_$ES.ESLinkedListIterator"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"ESLinkedListIterator",{get:function(){return t===undefined&&(t=null,t=i(),delete n.ESLinkedListIterator,n.ESLinkedListIterator=t["_$ES.ESLinkedListIterator"]),t["_$ES.ESLinkedListIterator"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.GL.GLRender"]=function(n){function t(t){var i,r,f,u;this.glTextures=[];this.textureFrameBufferPools=[];this.stateTextureFrameBufferStack=[];this.stateClipStack=[];this.activeTextureDic=[];this.vData=new Float32Array(_$ES.GL.GLRender.glRenderBufferSize/Float32Array.BYTES_PER_ELEMENT);this.removeTextureDisplayList=[];n.call(this);this.appInfo=t;this.canvas=t.renderCanvas;i=this.gl=t.renderCTX;r=i.getParameter(i.MAX_TEXTURE_SIZE);r>4096&&(r=4096);t.canvasInfoPoolsSpriteH=t.canvasInfoPoolsSpriteW=this.maxTextureSize=r;this.maxTextureImageUnits=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS);this.shaderDefault=new _$ES.GL.ShaderDefault(this);this.shaderCT=new _$ES.GL.ShaderCT(this);this.shaderRect=new _$ES.GL.ShaderRect(this);this.shaderTexture=new _$ES.GL.ShaderTexture(this);i.clearColor(0,0,0,0);i.clear(i.COLOR_BUFFER_BIT);i.disable(i.DEPTH_TEST);i.enable(i.BLEND);i.blendFunc(i.ONE,i.ONE_MINUS_SRC_ALPHA);i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1);this.unpackPremultiplyAlphaState=!0;f=this.glRenderBuffer=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,f);i.bufferData(i.ARRAY_BUFFER,_$ES.GL.GLRender.glRenderBufferSize,i.DYNAMIC_DRAW);u=Float32Array.BYTES_PER_ELEMENT;i.vertexAttribPointer(0,2,i.FLOAT,!1,4*u,0);i.enableVertexAttribArray(0);i.vertexAttribPointer(1,2,i.FLOAT,!1,4*u,2*u);i.enableVertexAttribArray(1)}return t.prototype.maxTextureImageUnits=undefined,t.prototype.unpackPremultiplyAlphaState=!0,t.prototype.preRender=undefined,t.prototype.canvas=undefined,t.prototype.glRenderBuffer=undefined,t.prototype.maxTextureSize=undefined,t.prototype.appInfo=undefined,t.prototype.canvasWidth=undefined,t.prototype.canvasHeight=undefined,t.prototype.glTextures=undefined,t.prototype.gl=undefined,t.prototype.textureFrameBufferPools=undefined,t.prototype.shaderDefault=undefined,t.prototype.shaderCT=undefined,t.prototype.shaderRect=undefined,t.prototype.orthoMatrix=undefined,t.prototype.stateCurrentShader=undefined,t.prototype.stateOffsetX=0,t.prototype.stateOffsetY=0,t.prototype.stateCurrentTextureFrameBuffer=null,t.prototype.stateTextureFrameBufferStack=undefined,t.prototype.stateCurrentClip=null,t.prototype.stateClipStack=undefined,t.prototype.activeTextureDic=undefined,t.prototype.activeTextureCount=0,t.prototype.nextActiveTextureIndex=0,Object.defineProperty(t.prototype,"bindTexture",{value:function(n,t){var u=null,f=NaN,i=NaN,r=NaN;if(t&&!t._$bindTarget){for(u=this.activeTextureDic,f=this.maxTextureImageUnits-1,i=-1,r=0;r<f;){if(!u[r]){i=r;break}r++}i==-1?(i=this.nextActiveTextureIndex++,i>=this.maxTextureImageUnits&&(i=this.nextActiveTextureIndex=0)):this.activeTextureCount++;t._$bindTime=new Date;t._$bindTargetIndex=i;n.activeTexture(t._$bindTarget=n["TEXTURE"+i]);n.bindTexture(n.TEXTURE_2D,t);u[i]=t}return t}}),Object.defineProperty(t.prototype,"cancelBindTexture",{value:function(n){var t=NaN;n&&(t=n._$bindTarget)&&(this.gl.activeTexture(t),this.gl.bindTexture(this.gl.TEXTURE_2D,null),delete this.activeTextureDic[n._$bindTargetIndex],n._$bindTarget=0,n._$bindTargetIndex=-1,this.activeTextureCount--)}}),t.prototype.mainFrameBuffer=null,Object.defineProperty(t.prototype,"useMainFrameBuffer",{value:function(){var n=this.mainFrameBuffer;this.stateOffsetX=this.stateOffsetY=0;this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,n);n?(n._$texture._$offsetX=n._$texture._$offsetY=0,this.setViewPort(this.canvasWidth,this.canvasHeight,!0)):this.setViewPort(this.canvasWidth,this.canvasHeight,!1)}}),Object.defineProperty(t.prototype,"useTextureFrameBuffer",{value:function(){var n=null;(n=this.stateCurrentTextureFrameBuffer)&&(this.stateOffsetX=n._$texture._$offsetX,this.stateOffsetY=n._$texture._$offsetY,this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,n),this.setViewPort(n._$texture._$w,n._$texture._$h,!0))}}),Object.defineProperty(t.prototype,"setRenderBounds",{value:function(n,t,i,r){var u=this.canvas;this.appInfo.renderTargetElement.appendChild(u);u.style.position="absolute";u.style.width=n+"px";u.style.height=t+"px";u.width=this.canvasWidth=i;u.height=this.canvasHeight=r;u.style.left="0px";u.style.top="0px";this.setViewPort(i,r)}}),Object.defineProperty(t.prototype,"setViewPort",{value:function(n,t,i){i===undefined&&(i=!1);this.gl.viewport(0,0,n,t);this.createOrthoMatrix(n,t,i)}}),Object.defineProperty(t.prototype,"createOrthoMatrix",{value:function(n,t,i){i===undefined&&(i=!1);this.orthoMatrix=i?(new _$ES.GL.Mat4).ortho(0,n,0,t,255,-255):(new _$ES.GL.Mat4).ortho(0,n,t,0,255,-255)}}),Object.defineProperty(t.prototype,"addTexture",{value:function(n,t,i,r,u){var f=null,e,o;i!=!this.unpackPremultiplyAlphaState&&(this.unpackPremultiplyAlphaState=!i,this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i?0:1));e=this.glTextures;o=n.spriteId;(f=e[o])||(f=e[o]=this.createEmptyGLTexture(this.maxTextureSize,this.maxTextureSize));this.updateSubGLTexture(t,f,n.allocatorBounds.x,n.allocatorBounds.y);r&&(n.imageSource=u)}}),Object.defineProperty(t.prototype,"removeTexture",{value:function(n){var t=n.allocatorResult,i=this.gl;i.activeTexture(this.bindTexture(i,this.getGLTexture(n))._$bindTarget);i.texSubImage2D(i.TEXTURE_2D,0,t.x,t.y,t.width,t.height,i.RGBA,i.UNSIGNED_BYTE,new Uint8Array(t.width*t.height*4))}}),t.prototype.shaderTexture=undefined,Object.defineProperty(t.prototype,"readPixel",{value:function(n,t,i,r,u){var e=null,f=this.gl,h=this.glTextures,c=n.allocatorResult.sprite.id,o=this.popGLTextureFrameBuffer(n.allocatorBounds.width,n.allocatorBounds.height),s=this.stateCurrentTextureFrameBuffer;return this.stateCurrentTextureFrameBuffer=o,this.useTextureFrameBuffer(),f.clear(f.COLOR_BUFFER_BIT),this.shaderTexture.drawByTextureInfo(n),e=new Uint8Array(4*r*u),f.readPixels(t,i,r,u,f.RGBA,f.UNSIGNED_BYTE,e),s?(this.stateCurrentTextureFrameBuffer=s,this.useTextureFrameBuffer()):(this.useMainFrameBuffer(),this.stateCurrentTextureFrameBuffer=null),this.pushGLTextureFrameBuffer(o),_$ES.F.unAlphaPremultipliedByUint8Array(e),e}}),Object.defineProperty(t.prototype,"readPixelToImageSource",{value:function(n,t,i,r,u){var o;t===undefined&&(t=0);i===undefined&&(i=0);r===undefined&&(r=0);u===undefined&&(u=0);var s=null,v=NaN,y=NaN,f=NaN,e=NaN,c=NaN,p=null,h=null,l=null,b=null,a=NaN,k=NaN,w=null;if(t=t>>>0,i=i>>>0,r=r==0?n.boundsSource.width:r>>>0,u==0?u=n.boundsSource.height:r=r>>>0,o=n.imageSource,o)return t==0&&i==0&&r==o.width&&u==o.height||(s=_$ES.F.createCTX(r,u),s.drawImage(o,t,i,r,u,0,0,r,u),o=s.canvas),o;if(_$ES.F.error(this.appInfo,"要读取的图像未在缓存中找到，将从GL中读取"),v=t,y=i,f=r,e=u,(c=n.boundsScale)!=1&&(v=v*c>>0,y=y*c>>0,f=f*c>>0,e=e*c>>0),p=this.readPixel(n,v,y,f,e),h=_$ES.F.createCanvas(f,e),s=h.getContext("2d"),l=s.createImageData(f,e),l.data.set!=null)l.data.set(p);else for(b=l.data,a=0,k=p.length;a<k;)b[a]=p[a],a++;return s.putImageData(l,0,0),f==r&&e==u||(w=_$ES.F.createCTX(r,u),w.drawImage(h,0,0,r,u),h=w.canvas),n.imageSource=h,n.imageSourceIsAlphaPremultiplied=!1,h}}),Object.defineProperty(t.prototype,"getGLTexture",{value:function(n){return this.glTextures[n.spriteId]}}),Object.defineProperty(t.prototype,"createEmptyGLTexture",{value:function(n,t,i){i===undefined&&(i=!1);var r=this.gl,u=r.createTexture();return this.bindTexture(r,u),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),i?r.texImage2D(r.TEXTURE_2D,0,r.ALPHA,n,t,0,r.ALPHA,r.UNSIGNED_BYTE,new Uint8Array(n*t)):r.texImage2D(r.TEXTURE_2D,0,r.RGBA,n,t,0,r.RGBA,r.UNSIGNED_BYTE,new Uint8Array(n*t*4)),this.cancelBindTexture(u),u._$w=n,u._$h=t,u}}),Object.defineProperty(t.prototype,"deleteGLTexture",{value:function(n){this.cancelBindTexture(n);this.gl.deleteTexture(n)}}),Object.defineProperty(t.prototype,"updateSubGLTexture",{value:function(n,t,i,r){var u=this.gl,f;u.activeTexture(this.bindTexture(u,t)._$bindTarget);f=new Date;u.texSubImage2D(u.TEXTURE_2D,0,i,r,u.RGBA,u.UNSIGNED_BYTE,n)}}),Object.defineProperty(t.prototype,"updateAlphaSubGLTexture",{value:function(n,t,i,r,u,f){var o=new Date,e=this.gl;e.activeTexture(this.bindTexture(e,t)._$bindTarget);e.pixelStorei(e.UNPACK_ALIGNMENT,1);e.texSubImage2D(e.TEXTURE_2D,0,i,r,u,f,e.ALPHA,e.UNSIGNED_BYTE,new Uint8Array(n));e.pixelStorei(e.UNPACK_ALIGNMENT,4);_$ES.F.traceLog("upload alpha:",(new Date).time-o.time,n.byteLength)}}),Object.defineProperty(t.prototype,"renderToCanvas",{value:function(n,t,i,r,u,f,e){var b=null,a=null,p=null,c=null,s=NaN,k=NaN,l=NaN,w=this.gl,o=this.preRender,ot=o.matrix,d,g,nt,tt,it,rt,ut,ft,v,y,h,et;o.matrix=u;d=o.colorTransform;o.colorTransform=f;g=o.source;o.source=t;nt=o.canvasRect;o.canvasRect=new _$ES.Geoms.ESRectangle(0,0,i,r);tt=o.renderByBitmapDataDraw;o.renderByBitmapDataDraw=!0;it=o.isSystem;o.isSystem=!1;rt=o.renderInfoDic;o.renderInfoDic=[];this.mainFrameBuffer=this.popGLTextureFrameBuffer(i,r);ut=this.canvasWidth;ft=this.canvasHeight;this.canvasWidth=this.mainFrameBuffer._$texture._$w;this.canvasHeight=this.mainFrameBuffer._$texture._$h;this.useMainFrameBuffer();this.render(!0);this.useMainFrameBuffer();v=0;y=0;e&&(v=e.x,y=e.y,i=e.width,r=e.height);h=new Uint8Array(4*i*r);w.readPixels(v,y,i,r,w.RGBA,w.UNSIGNED_BYTE,h);this.pushGLTextureFrameBuffer(this.mainFrameBuffer);this.mainFrameBuffer=null;this.canvasWidth=ut;this.canvasHeight=ft;this.useMainFrameBuffer();o.matrix=ot;o.colorTransform=d;o.source=g;o.canvasRect=nt;o.renderByBitmapDataDraw=tt;o.isSystem=it;for(et in o.renderInfoDic)b=o.renderInfoDic[et],_$ES.Pools.pushRenderInfo(b);for(o.renderInfoDic=rt,a=_$ES.F.createCTX(i,r),p=a.createImageData(i,r),c=p.data,s=0,k=h.length;s<k;)l=c[s+3]=h[s+3],l>0?(l=l/255,c[s]=h[s]/l>>0,c[s+1]=h[s+1]/l>>0,c[s+2]=h[s+2]/l>>0):(c[s]=h[s],c[s+1]=h[s+1],c[s+2]=h[s+2]),s=s+4;return a.putImageData(p,0,0),n.setTransform(1,0,0,1,0,0),n.drawImage(a.canvas,v,y),n}}),t.prototype.vData=undefined,t.prototype.vDataOffset=0,t.prototype.removeTextureDisplayList=undefined,Object.defineProperty(t.prototype,"render",{value:function(n){var f=null,r=null,e=null,l=null,y=NaN,o=null,p=null,s=null,w=this.preRender,t,c;r=w.run();var i=0,a=r.length,v=1,h=this.removeTextureDisplayList,u=this.gl,b=this.glRenderBuffer;for(u.bindBuffer(u.ARRAY_BUFFER,b),u.bufferSubData(u.ARRAY_BUFFER,0,new Float32Array(this.vData.buffer,0,this.vDataOffset)),n&&u.clear(u.COLOR_BUFFER_BIT),t=null,c=null,i=0;i<a;){y=r[i];switch(y){case"C1":u.clear(u.COLOR_BUFFER_BIT);break;case"C2":e=r[++i];l=this.popGLTextureFrameBuffer(e.width,e.height);l._$texture._$offsetX=-e.x;l._$texture._$offsetY=-e.y;this.stateTextureFrameBufferStack.push(this.stateCurrentTextureFrameBuffer);this.stateCurrentTextureFrameBuffer=l;break;case"C3":this.pushGLTextureFrameBuffer(this.stateCurrentTextureFrameBuffer);this.stateCurrentTextureFrameBuffer=this.stateTextureFrameBufferStack.pop();break;case"C4":t&&(t.draw(),t=null);this.stateClipStack.push(this.stateCurrentClip);this.stateCurrentClip=this.stateCurrentTextureFrameBuffer._$texture;this.stateCurrentClip._$isClip=r[++i];break;case"C5":t&&(t.draw(),t=null);this.cancelBindTexture(this.stateCurrentClip);this.stateCurrentClip=this.stateClipStack.pop();break;case"C9":t&&(t.draw(),t=null);this.useMainFrameBuffer();break;case"C8":t&&(t.draw(),t=null);this.useTextureFrameBuffer();break;case"C0":f=r[++i];c=f.playerCT?this.shaderCT:this.shaderDefault;c.cache(f);!t||c===t||t.draw();t=c;break;case"C10":t&&(t.draw(),t=null);o=this.shaderRect;f=r[++i];o.fillColor=r[++i];o.borderColor=r[++i];o.renderInfo=f;o.draw();break;case"C11":p=r[++i];s=r[++i];s.parentNode||p.appendChild(s);s.style.zIndex!=v&&(s.style.zIndex=v);v++;break;case"C13":h.push(r[++i])}i++}if(t&&(t.draw(),t=null),h.length)for(i=0,a=h.length;i<a;)h[i].removeTexture(),i++;r.length=0;h.length=0;this.vDataOffset=0}}),Object.defineProperty(t.prototype,"createGLRenderFrameBuffer",{value:function(n,t){var i=this.gl,u=i.createRenderbuffer(),r;return i.bindRenderbuffer(i.RENDERBUFFER,u),i.renderbufferStorage(i.RENDERBUFFER,i.RGBA4,n,t),r=i.createFramebuffer(),r._$renderBuffer=u,i.bindFramebuffer(i.FRAMEBUFFER,r),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,u),r}}),Object.defineProperty(t.prototype,"deleteGLRenderFrameBuffer",{value:function(n){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.mainFrameBuffer);t.deleteFramebuffer(n);n._$renderBuffer&&(t.bindRenderbuffer(t.RENDERBUFFER,null),t.deleteRenderbuffer(n._$renderBuffer))}}),Object.defineProperty(t.prototype,"createGLTextureFrameBuffer",{value:function(n,t){var i=this.gl,f=_$ES.Draw.Utils.toTextureSize(n,t),u,r;return n=f.x,t=f.y,u=this.createEmptyGLTexture(n,t),r=i.createFramebuffer(),i.bindFramebuffer(i.FRAMEBUFFER,r),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,u,0),r._$texture=u,i.bindFramebuffer(i.FRAMEBUFFER,this.mainFrameBuffer),r}}),Object.defineProperty(t.prototype,"deleteGLTextureFrameBuffer",{value:function(n){this.deleteGLTexture(n._$texture);this.gl.deleteFramebuffer(n);n._$texture=null}}),Object.defineProperty(t.prototype,"popGLTextureFrameBuffer",{value:function(n,t){var i=this.textureFrameBufferPools.pop(),r=0,u=0;return(!i||(r=i._$texture._$w)<n||(u=i._$texture._$h)<t)&&(i&&this.deleteGLTextureFrameBuffer(i),i=this.createGLTextureFrameBuffer(n>r?n:r,t>u?t:u)),i}}),Object.defineProperty(t.prototype,"pushGLTextureFrameBuffer",{value:function(n){this.textureFrameBufferPools.push(n)}}),Object.defineProperty(t.prototype,"init",{value:function(n,t,i,r,u,f,e,o,s){u===undefined&&(u=null);f===undefined&&(f=!1);e===undefined&&(e=null);o===undefined&&(o=null);s===undefined&&(s=!1);var c=this.appInfo,h=_$ES.F.getPixelRatio(),l=h*t,a=h*i;c.player.matrix=r.scale2(h,h);c.player.matrixIsEmpty=r.isEmpty();c.player.matrixInvert=r.clone().invert();this.setRenderBounds(t,i,l,a);this.preRender?this.preRender.init(n,l,a,r,u,e,o,s):this.preRender=new _$ES.PreRender(this.appInfo.player,this,n,l,a,r,u,e,o,s);n.updateRenderInfoMatrix()}}),Object.defineProperty(t.prototype,"getRenderTarget",{value:function(){return this.canvas}}),Object.defineProperty(t.prototype,"setVdata",{value:function(n,t,i){i===undefined&&(i=!1);var r=null,u=this.vData;n.textureVDataInBufferIndex=this.vDataOffset;n.isUpdateTextureVData&&n.updateTextureVData(i);t&&(r=n.textureInfo.allocatorResult.sprite,_$ES.TextureInfo.updateTextureBounds(_$ES.Draw.Utils.rectToTextureCoordinate(t,r.w,r.h),n.textureVData));u.set(n.textureVData,this.vDataOffset);this.vDataOffset=this.vDataOffset+n.textureVData.length}}),Object.defineProperty(t.prototype,"setRectVData",{value:function(n){var f=this.vData;n.textureVDataInBufferIndex=this.vDataOffset;var t=n.playerBoundsP1,r=n.playerBoundsP2,u=n.playerBoundsP3,i=n.playerBoundsP4;f.set([r.x,r.y,0,0,t.x,t.y,0,0,i.x,i.y,0,0,i.x,i.y,0,0,t.x,t.y,0,0,u.x,u.y,0,0,t.x,t.y,0,0,r.x,r.y,0,0,r.x,r.y,0,0,i.x,i.y,0,0,i.x,i.y,0,0,u.x,u.y,0,0,u.x,u.y,0,0,t.x,t.y,0,0],this.vDataOffset);this.vDataOffset=this.vDataOffset+56}}),Object.defineProperty(t.prototype,"renderCanvas",{get:function(){return this.canvas},set:undefined}),Object.defineProperty(t.prototype,"supportClip",{get:function(){return!1},set:undefined}),t.glRenderBufferSize=524288,function(){this.glRenderBufferSize=524288}.call(t),t},function(){n["_$ES.GL.GLRender"]=n["_$ES.GL.GLRender"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};n=n.GL=n.GL||{};Object.defineProperty(n,"GLRender",{get:function(){return t===undefined&&(t=null,t=i(),delete n.GLRender,n.GLRender=t["_$ES.GL.GLRender"]),t["_$ES.GL.GLRender"]},configurable:!0})}).call(this);(function(){function i(){var n={};return n["_$ES.BR"]=function(n){function t(t,i){n.call(this);this.SetArrayBuffer(new Uint8Array(t));this.currentWorkerManage=i}return t.prototype.currentWorkerManage=undefined,Object.defineProperty(t.prototype,"SetArrayBuffer",{value:function(n){this.source=n.buffer;this.data=n;this.dataView=new DataView(this.source,n.byteOffset,n.byteLength);this.Length=n.byteLength;this.Position=0;this.fontGlyphCount={}}}),t.prototype.mainSprite=undefined,t.prototype.defineScene=undefined,t.prototype.currentTagLength=undefined,t.prototype.currentTagEndPostion=undefined,t.prototype.fontGlyphCount=undefined,Object.defineProperty(t.prototype,"createTagDefineSprite",{value:function(n){var i=NaN,r=NaN,u=null,t={tagType:39,defineId:n};if(t.frames=[],t.frames.push(t.currentFrame=[]),t.sceneOffset=[],t.scene_keyIsName={},n===0&&this.defineScene)for(i=0;i<this.defineScene.sceneCount;)r=this.defineScene.frameLableOffsets[i],u=this.defineScene.frameLableNames[i],t.sceneOffset.push(r),t.scene_keyIsName[u]=r,i++;else t.sceneOffset.push(0),t.scene_keyIsName["场景 1"]=0;return t.frameLablesCount=0,t.frameLables_keyIsFrame={},t.frameLables_keyIsName={},t}}),Object.defineProperty(t.prototype,"ReadTag",{value:function(n){var o;n===undefined&&(n=null);var b=NaN,t=null,l=NaN,a=NaN,i=0,s=NaN,e=null,f=null,u=null,c=null,h=null,k=null,v=NaN,r=null,d=NaN,y=null,p=null,w=NaN;if(this.mainSprite||(this.mainSprite=this.createTagDefineSprite(0)),n==null&&(n=this.mainSprite),o=0,this.Position<this.Length){a=this.ReadUInt16();i=a>>>6;s=a&63;s==63&&(s=this.ReadInt32());this.currentTagLength=s;this.currentTagEndPostion=this.Position+s;switch(i){case 82:return{tagType:i,code:this.ReadUTF8(s)};case 9:return{tagType:i,color:this.ReadInfo_ColorRGB(null)};case 78:return{tagType:i,targetDefineId:this.ReadUInt16(),rect:this.ReadInfo_Rectangle()};case 14:return this.readTag_DefineSound(i);case 2:case 22:case 32:case 83:return this.ReadTag_DefineShape(i);case 46:case 84:return e=this.ReadTag_DefineShape(i),f={tagType:i,defineId:e.defineId},f.renderFuns=[],f.textures=[],f.defineShape=e,f.maxMatrixScale=e.maxMatrixScale,f.ratios=e.ratioList,f.bounds=e.ratioBounds,f.rects=e.ratioRects,f;case 7:case 34:return this.ReadTag_DefineButton(i);case 17:return this.ReadTag_DefineButtonSound(i);case 6:case 21:case 35:case 90:case 20:case 36:return this.ReadTag_DefineBits(i);case 86:for(u={tagType:i,sceneCount:this.RVU30U32(),scenesOffsets:[],scenesNames:[],frameLabelCount:0,frameLableOffsets:[],frameLableNames:[]},o=0;o<u.sceneCount;)u.scenesOffsets.push(this.RVU30U32()),u.scenesNames.push(this.ReadUTF8_c()),o++;for(u.frameLabelCount=this.RVU30U32(),o=0;o<u.frameLabelCount;)u.frameLableOffsets.push(this.RVU30U32()),u.frameLableNames.push(this.ReadUTF8_c()),o++;return this.defineScene=u,u;case 39:for(c=this.createTagDefineSprite(this.ReadUInt16()),c.frameCount=this.ReadUInt16(),b=this.currentTagEndPostion;this.Position<b;)this.ReadTag(c);return c;case 1:return n.frames.push(n.currentFrame=[]);case 4:return t={tagType:i},t.defineId=this.ReadUInt16(),t.depth=this.ReadUInt16(),t.matrix=this.ReadInfo_Matrix(),this.Position<this.currentTagEndPostion&&(t.colorTransform=this.ReadInfo_CXForm()),n.currentFrame.push(t);case 26:return t={tagType:i},t.fHasClipActions=this.RBB(!0),t.fHasClipDepth=this.RBB(),t.fHasName=this.RBB(),t.fHasRatio=this.RBB(),t.fHasColorTransform=this.RBB(),t.fHasMatrix=this.RBB(),t.fHasCharacter=this.RBB(),t.fMove=this.RBB(),t.depth=this.ReadUInt16(),t.fHasCharacter&&(t.defineId=this.ReadUInt16()),t.fHasMatrix&&(t.matrix=this.ReadInfo_Matrix()),t.fHasColorTransform&&(t.colorTransform=this.ReadInfo_CXFormAlpha()),t.fHasRatio&&(t.ration=this.ReadUInt16()),t.fHasName&&(t.name=this.ReadUTF8_c()),t.fHasClipDepth&&(t.clipDepth=this.ReadUInt16()),this.Position=this.currentTagEndPostion,n.currentFrame.push(t);case 70:return t={tagType:i},t.fHasClipActions=this.RBB(!0),t.fHasClipDepth=this.RBB(),t.fHasName=this.RBB(),t.fHasRatio=this.RBB(),t.fHasColorTransform=this.RBB(),t.fHasMatrix=this.RBB(),t.fHasCharacter=this.RBB(),t.fMove=this.RBB(),this.RBB(),t.fOpaqueBackground=this.RBB(),t.fHasVisible=this.RBB(),t.flagHasImage=this.RBB(),t.fHasClassName=this.RBB(),t.fHasCacheAsBitmap=this.RBB(),t.fHasBlendMode=this.RBB(),t.fHasFilterList=this.RBB(),t.depth=this.ReadUInt16(),t.fHasClassName&&(t.className=this.ReadUTF8_c()),t.fHasCharacter&&(t.defineId=this.ReadUInt16()),t.fHasMatrix&&(t.matrix=this.ReadInfo_Matrix()),t.fHasColorTransform&&(t.colorTransform=this.ReadInfo_CXFormAlpha()),t.fHasRatio&&(t.ration=this.ReadUInt16()),t.fHasName&&(t.name=this.ReadUTF8_c()),t.fHasClipDepth&&(t.clipDepth=this.ReadUInt16()),t.fHasFilterList&&(t.surfaceFilterList=this.ReadInfo_FilterList()),t.fHasBlendMode&&(t.blendMode=this.ReadByte()),t.fHasCacheAsBitmap&&(t.bitmapCache=this.ReadByte()==1),t.visible=t.fHasVisible?this.ReadByte()==1:!0,t.fOpaqueBackground&&(t.backGroupColor=this.ReadInfo_ColorRGBA(null)),this.Position=this.currentTagEndPostion,n.currentFrame.push(t);case 5:return n.currentFrame.push({tagType:i,defineId:this.ReadUInt16(),depth:this.ReadUInt16()});case 28:return n.currentFrame.push({tagType:i,defineId:0,depth:this.ReadUInt16()});case 43:return h={tagType:i,name:this.ReadUTF8_c(),namedAnchorFlag:this.Position<this.currentTagEndPostion?this.ReadByte():0},n.frameLables_keyIsName[h.name]||(l=n.frames.length,n.frameLablesCount++,n.frameLables_keyIsFrame[l]=h,n.frameLables_keyIsName[h.name]=l),n.currentFrame.push(h);case 15:case 89:return n.currentFrame.push(this.readTag_StartSound(i));case 18:case 45:return n.soundStreamHead={tagType:i,soundDefine:this.readTag_DefineSound(14)};case 19:return n.currentFrame.push({tagType:i,startTime:this.ReadUint32(),soundStreamHead:n.soundStreamHead});case 76:return this.ReadTag_SymbolClass();case 87:return k={tagType:i,defineId:this.ReadUInt16(),reserved:this.ReadUint32(),data:this.ReadBytesToArrayBuffer(this.currentTagEndPostion-this.Position)},this.Position=this.currentTagEndPostion,k;case 48:case 75:return this.ReadTag_DefineFont2(i);case 73:return v=0,{tagType:i,fontId:v=this.ReadUInt16(),csmTableHint:this.RUB(2,!0),reserved:this.RUB(6),zoneTable:this.ReadInfo_List(this.fontGlyphCount[v],_$ES.F.bind(function(){var n=0;return{numData:n=this.ReadByte(),data:this.ReadInfo_List(n,_$ES.F.bind(function(){return{coordinate:this.ReadFloat16(),range:this.ReadFloat16()}},this),[]),reserved:this.RUB(6,!0),maskY:this.RBB(),maskX:this.RBB()}},this),[])};case 11:case 33:for(r={tagType:i,defineId:this.ReadUInt16(),bounds:this.ReadInfo_Rectangle(),matrix:this.ReadInfo_Matrix(),glyphBits:this.ReadByte(),advanceBits:this.ReadByte(),textRecords:[]},d=this.ReadInt32(),y=r.textRecords;y.length<d;)y.push(this.ReadTag_Info_TextRecord(i,r.glyphBits,r.advanceBits));return(r.bitTagDefineId=this.ReadUint32())>0&&(r.inBitX=this.ReadUInt16(),r.inBitY=this.ReadUInt16(),r.inBitWidth=this.ReadUInt16(),r.inBitHeight=this.ReadUInt16(),r.inBitScale=this.ReadFloat()),r;case 37:return this.ReadTag_DefineEditText();case 1023:return p={tagType:i,fileName:this.ReadUTF8_2(),fileType:this.ReadByte()},w=this.ReadUint32(),w&&(p.defineId=w),p;case 0:return(n.currentFrame&&n.currentFrame.length==0&&n.frames.pop(),n==this.mainSprite)?(n.frameCount=n.frames.length,n):0}return this.Position=this.currentTagEndPostion,!0}return!1}}),Object.defineProperty(t.prototype,"readTag_DefineSound",{value:function(n){var t={tagType:n,defineId:this.ReadUInt16(),soundFormat:this.RUB(4,!0),soundRate:this.RUB(2),soundSize:this.RBB(),soundIsStereo:this.RBB(),soundSampleCount:this.ReadUint32()};t.soundData=this.ReadBytesToArrayBuffer(this.ReadInt32());t.soundData_ogg=this.ReadBytesToArrayBuffer(this.ReadInt32());switch(t.soundRate){default:case 3:t.soundRateNum=44100;break;case 2:t.soundRateNum=22050;break;case 1:t.soundRateNum=11025;break;case 0:t.soundRateNum=5512}return t}}),Object.defineProperty(t.prototype,"ReadInfo_List",{value:function(n,t,i){for(var r=0;r<n;)i.push(t()),r++;return i}}),Object.defineProperty(t.prototype,"ReadTag_Info_TextRecord",{value:function(n,t,i){var r={recordType:this.RBB(!0),fReserved:this.RUB(3),fHasFont:this.RBB(),fHasColor:this.RBB(),fHasYOffset:this.RBB(),fHasXOffset:this.RBB()};return r.fHasFont&&(r.fontId=this.ReadUInt16()),r.fHasColor&&(r.color=n==11?this.ReadInfo_ColorRGB(null):this.ReadInfo_ColorRGBA(null)),r.fHasXOffset&&(r.xOffset=this.ReadUInt16()*.05),r.fHasYOffset&&(r.yOffset=this.ReadUInt16()*.05),r.fHasFont&&(r.textHeight=this.ReadUInt16()*.05),r.glyphCount=this.ReadByte(),this.ReadNewBitValue(),r.glyphEntries=this.ReadInfo_List(r.glyphCount,_$ES.F.bind(function(){return{index:this.RUB(t),advance:this.RUB(i)*.05}},this),[]),r}}),Object.defineProperty(t.prototype,"ReadTag_DefineEditText",{value:function(){var n={tagType:37,defineId:this.ReadUInt16(),bound:this.ReadInfo_Rectangle(),hasText:this.RBB(!0),wordWrap:this.RBB(),multiline:this.RBB(),passWord:this.RBB(),readOnly:this.RBB(),hasTextColor:this.RBB(),hasMaxLength:this.RBB(),hasFont:this.RBB(),hasFontClass:this.RBB(),autoSize:this.RBB(),hasLayout:this.RBB(),noSelect:this.RBB(),border:this.RBB(),wasStatic:this.RBB(),html:this.RBB(),useOutLines:this.RBB()};return n.hasFont&&(n.fontId=this.ReadUInt16()),n.hasFontClass&&(n.fontClass=this.ReadUTF8_c()),n.hasFont&&(n.fontHeight=this.ReadUInt16()*.05),n.hasTextColor&&(n.textColor=this.ReadInfo_ColorRGBA(null)),n.hasMaxLength&&(n.maxLength=this.ReadUInt16()),n.hasLayout&&(n.aligh=this.ReadByte(),n.leftMargin=this.ReadUInt16()*.05,n.rightMargin=this.ReadUInt16()*.05,n.indent=this.ReadInt16()*.05,n.leading=this.ReadInt16()*.05),n.variableName=this.ReadUTF8_c(),n.hasText&&(n.initialText=this.ReadUTF8_c()),n}}),Object.defineProperty(t.prototype,"ReadTag_DefineFont2",{value:function(n){var u=NaN,f=NaN,i=0,t={tagType:n,defineId:this.ReadUInt16(),fHasLayout:this.RBB(!0),fShiftJIS:this.RBB(),fSmallText:this.RBB(),fANSI:this.RBB(),fWideOffsets:this.RBB(),fWideCodes:this.RBB(),fItalic:this.RBB(),fBold:this.RBB(),languageCode:this.ReadByte()},e=this.ReadByte(),r=this.ReadUTF8(e);for(r.charCodeAt(r.length-1)==0&&(r=r.substr(0,r.length-1)),t.name=r,t.numGlyphs=this.fontGlyphCount[t.defineId]=this.ReadUInt16(),t.codeTable=[],t.codeTableDic={},i=0;i<t.numGlyphs;)u=t.fWideCodes||n==75?this.ReadUInt16():this.ReadByte(),t.codeTableDic[String.fromCharCode(u)]=t.codeTable.length,t.codeTable.push(u),i++;if(t.fHasLayout){for(t.ascent=this.ReadInt16()*.05/1024,t.descent=this.ReadInt16()*.05/1024,t.leading=this.ReadInt16()*.05/1024,t.advanceTable=[],i=0;i<t.numGlyphs;)t.advanceTable.push(this.ReadInt16()/20480),i++;for(t.boundsTable=[],i=0;i<t.numGlyphs;)t.boundsTable.push(this.ReadInfo_Rectangle()),i++;for(f=this.ReadUInt16(),t.kerningTable=[],i=0;i<f;)t.kerningTable.push({code1:t.fWideCodes?this.ReadUInt16():this.ReadByte(),code2:t.fWideCodes?this.ReadUInt16():this.ReadByte(),adjustment:this.ReadInt16()}),i++}for(t.glyphShapes=[],i=0;i<t.numGlyphs;)t.glyphShapes.push(this.ReadInfo_Shape(t)),i++;return t}}),Object.defineProperty(t.prototype,"ReadTag_SymbolClass",{value:function(){for(var n=NaN,r=null,t=null,i={tagType:76,idAndNames:[]},f=this.ReadUInt16(),u=0;u<f;)n=this.ReadUInt16(),r=this.ReadUTF8_c(),t=i.idAndNames[n]||[],t.push(r),i.idAndNames[n]=t,u++;return i}}),Object.defineProperty(t.prototype,"readTag_StartSound",{value:function(n){var t={tagType:n};return n==15?t.soundId=this.ReadUInt16():t.soundClassName=this.ReadUTF8_c(),t.soundInfo=this.readInfo_SoundInfo(),t}}),Object.defineProperty(t.prototype,"readInfo_SoundInfo",{value:function(){var i=NaN,t=NaN,n={};if(n.reserved=this.RUB(2,!0),n.syncStop=this.RBB(),n.syncNoMultiple=this.RBB(),n.hasEnvelope=this.RBB(),n.hasLoops=this.RBB(),n.hasOutPoint=this.RBB(),n.hasInPoint=this.RBB(),n.hasInPoint&&(n.inPoint=this.ReadUint32()),n.hasOutPoint&&(n.outPoint=this.ReadUint32()),n.hasLoops&&(n.loopCount=this.ReadUInt16()),n.hasEnvelope)for(i=n.envPoints=this.ReadByte(),n.EnvelopeRecords=[],t=0;t<i;)n.EnvelopeRecords.push(this.readInfo_SoundEnvlope()),t++;return n}}),Object.defineProperty(t.prototype,"readInfo_SoundEnvlope",{value:function(){return{post44:this.ReadUint32(),leftLevel:this.ReadUInt16(),rightLevel:this.ReadUInt16()}}}),Object.defineProperty(t.prototype,"imageTypeToMimeType",{value:function(n){var t="image/png";return n==1?t="image/jpeg":n==2&&(t="image/gif"),t}}),Object.defineProperty(t.prototype,"ReadTag_DefineShape",{value:function(n){return this.ReadTag_Shape({tagType:n,defineId:this.ReadUint32()})}}),Object.defineProperty(t.prototype,"ReadTag_Shape",{value:function(n){var r=null,u=NaN,i=NaN;n.shapeType=this.RUB(3,!0);n.shapeType==4&&(n.usesFillWindingRule=this.RBB(),n.usesNonScalingStrokes=this.RBB(),n.usesScalingStrokes=this.RBB(),n.EdgeBounds=this.ReadInfo_Rectangle(),n.isMorph=this.ReadByte()==1,n.isMorph&&(n.EndShapeBounds=this.ReadInfo_Rectangle(),n.EndEdgeBounds=this.ReadInfo_Rectangle()));n.ShapeBounds=this.ReadInfo_Rectangle();n.EdgeBounds==null&&(n.EdgeBounds=n.ShapeBounds);n.shapeInfo=this.ReadInfo_Shape(n);n.maxMatrixScale=this.ReadFloat64();var t=0,f=0,e=this.ReadInt32();if(e>0)for(n.relateShapes=[],t=0,f=e;t<f;)r=this.ReadTag_DefineShape(n.tagType),n.relateShapes.push(r),t++;if(n.isMorph)for(n.ratioList=[],n.ratioBounds=[],n.ratioRects=[],u=this.ReadInt32(),t=0;t<u;)i=this.ReadUInt16(),n.ratioList.push(i),n.ratioBounds[i]=this.ReadInfo_Rectangle(),n.ratioRects[i]=this.ReadInfo_Rectangle(),t++;return(n.bitTagDefineId=this.ReadUint32())&&(n.inBitX=this.ReadUInt16(),n.inBitY=this.ReadUInt16(),n.inBitWidth=this.ReadUInt16(),n.inBitHeight=this.ReadUInt16(),n.inBitScale=this.ReadFloat(),n.isBitmapFill=this.ReadByte()==1),this.ReadByte()==1&&(n.bitmapMatrix=this.ReadInfo_Matrix(!0)),n}}),Object.defineProperty(t.prototype,"ReadInfo_Shape",{value:function(n){for(var t={segGroupList:[]},r=this.ReaderVariableS32(),i=0;i<r;)t.segGroupList.push(this.ReadInfo_PathSegmentGroup(n)),i++;return t}}),Object.defineProperty(t.prototype,"ReadTag_DefineBits",{value:function(n){var t={tagType:n,defineId:this.ReadUint32(),imageWidth:this.ReadUInt16(),imageHeight:this.ReadUInt16(),imageType:this.ReadByte(),shapeRefNumber:this.ReadInt32(),imageData:this.RBytes_ArrayBuffer(this.ReadInt32()),alphaData:this.RBytes_Dec(this.ReadInt32()),imageIsAlphaPremultiplied:this.ReadByte()==1,workIndex:this.currentWorkerManage.inWorkIndex};return(t.bitTagDefineId=this.ReadUint32())&&(t.inBitX=this.ReadUInt16(),t.inBitY=this.ReadUInt16(),t.inBitWidth=this.ReadUInt16(),t.inBitHeight=this.ReadUInt16(),t.inBitScale=this.ReadFloat()),t.imageMIMEType=this.imageTypeToMimeType(t.imageType),t}}),Object.defineProperty(t.prototype,"ReadTag_DefineButton",{value:function(n){var t={tagType:n,defineId:this.ReadUInt16()},r,i;for(t.trackAsMenu=this.ReadByte()==1,t.characters=[],r=this.ReadInt32(),i=0;i<r;)t.characters.push(this.ReadInfo_ButtonRecord(t)),i++;return t}}),Object.defineProperty(t.prototype,"ReadInfo_ButtonRecord",{value:function(n){var t={};return this.RUB(2,!0),t.hasBlendMode=this.RBB(),t.hasFilterList=this.RBB(),t.stateHitTest=this.RBB(),t.stateDown=this.RBB(),t.stateOver=this.RBB(),t.stateUp=this.RBB(),t.characterId=this.ReadUInt16(),t.placeDepth=this.ReadUInt16(),t.placeMatrix=this.ReadInfo_Matrix(),n.tagType==34?(t.colorTransform=this.ReadInfo_CXFormAlpha(),t.hasFilterList&&(t.filterList=this.ReadInfo_FilterList()),t.hasBlendMode&&(t.blendMode=this.ReadByte())):t.colorTransform={redMultiplier:1,greenMultiplier:1,blueMultiplier:1,alphaMultiplier:1,redOffset:0,greenOffset:0,blueOffset:0,alphaOffset:0},t}}),Object.defineProperty(t.prototype,"ReadTag_DefineButtonSound",{value:function(n){var t={tagType:n,buttonId:this.ReadUInt16()};return(t.soundChar0=this.ReadUInt16())&&(t.soundInfo0=this.readInfo_SoundInfo()),(t.soundChar1=this.ReadUInt16())&&(t.soundInfo1=this.readInfo_SoundInfo()),(t.soundChar2=this.ReadUInt16())&&(t.soundInfo2=this.readInfo_SoundInfo()),(t.soundChar3=this.ReadUInt16())&&(t.soundInfo3=this.readInfo_SoundInfo()),t}}),Object.defineProperty(t.prototype,"ReadInfo_Rectangle",{value:function(){var n=this.RUB(5,!0),t=this.RSB(n)*.05,r=this.RSB(n)*.05,i=this.RSB(n)*.05,u=this.RSB(n)*.05;return{x:t,y:i,width:r-t,height:u-i}}}),Object.defineProperty(t.prototype,"ReadInfo_PathSegmentGroup",{value:function(n){var r=NaN,t=NaN,u=!1,i;for(r=this.ReaderVariableS32(),i={},i.FigureList=[],i.SegmentList=[],i.FillStyleList=[],i.LineStyleList=[],t=0;t<r;)i.FigureList.push(this.ReadInfo_PathFigure(n)),t++;for(r=this.ReaderVariableS32(),t=0;t<r;)i.SegmentList.push(this.ReadInfo_PathSegment(n)),t++;for(r=this.ReaderVariableS32(),t=0;t<r;)i.FillStyleList.push(this.ReadInfo_FillStyle(n)),t++;for(r=this.ReaderVariableS32(),t=0;t<r;)u=this.ReadByte()==0,u?i.LineStyleList.push(this.ReadInfo_LineStyle2(n)):i.LineStyleList.push(this.ReadInfo_LineStyle(n)),t++;return i}}),Object.defineProperty(t.prototype,"ReadInfo_PathFigure",{value:function(n){var r=NaN,i=NaN,t={};for(t.boundX=this.ReadFloat()*.05,t.boundY=this.ReadFloat()*.05,t.boundW=this.ReadFloat()*.05,t.boundH=this.ReadFloat()*.05,t.boundRight=t.boundX+t.boundW,t.boundBottom=t.boundY+t.boundH,t.fillStyleIndex=this.ReaderVariableS32(),t.segmentIndex=[],r=this.ReaderVariableS32(),i=0;i<r;)t.segmentIndex.push(this.ReaderVariableS32()),i++;for(t.childs=[],r=this.ReaderVariableS32(),i=0;i<r;)t.childs.push(this.ReadInfo_PathFigure(n)),i++;return t}}),Object.defineProperty(t.prototype,"ReadInfo_PathSegment",{value:function(){var f=NaN,i=NaN,r=NaN,u=NaN,t=NaN,o=NaN,e=NaN,n={};if(n.isReversion=this.ReadByte()==1,n.isReversion)n.reversionSourceIndex=this.ReaderVariableS32();else{for(n.commands=[],n.data=[],f=this.ReaderVariableS32(),i=0,r=0,u=0;u<f;){n.commands.push(o=this.RUB(2,u==0)+1);switch(o){case 1:t=this.RUB(5);n.data.push((i=this.RSB(t))*.05);n.data.push((r=this.RSB(t))*.05);break;case 2:t=this.RUB(4);n.data.push((i=i+this.RSB(t+2))*.05);n.data.push((r=r+this.RSB(t+2))*.05);break;case 3:t=this.RUB(4);n.data.push((i=i+this.RSB(t+2))*.05);n.data.push((r=r+this.RSB(t+2))*.05);n.data.push((i=i+this.RSB(t+2))*.05);n.data.push((r=r+this.RSB(t+2))*.05)}u++}if(n.isMorph=this.ReadByte()==1,n.isMorph)for(n.morphRatioDeltaData=[],u=0;u<f;)e=n.commands[u],e==1||e==2?(n.morphRatioDeltaData.push(this.ReadFloat()/65535*.05),n.morphRatioDeltaData.push(this.ReadFloat()/65535*.05)):(n.morphRatioDeltaData.push(this.ReadFloat()/65535*.05),n.morphRatioDeltaData.push(this.ReadFloat()/65535*.05),n.morphRatioDeltaData.push(this.ReadFloat()/65535*.05),n.morphRatioDeltaData.push(this.ReadFloat()/65535*.05)),u++;n.lineStyleIndex=this.RVU30U32();n.fillStyle0Index=this.RVU30U32();n.fillStyle1Index=this.RVU30U32()}return n}}),Object.defineProperty(t.prototype,"ReadInfo_FillStyle",{value:function(n){var t={};t.fillStyleType=this.ReadByte();t.isMorph=this.ReadByte()==1;switch(t.fillStyleType){case 0:t.colorRGBA=n.shapeType<3?this.ReadInfo_ColorRGB(n):this.ReadInfo_ColorRGBA(n);t.isMorph&&(t.endColorRGBA=this.ReadInfo_ColorRGBA(n));break;case 16:case 18:case 19:t.gradientMatrix=this.ReadInfo_Matrix(!0);t.isMorph&&(t.endGradientMatrix=this.ReadInfo_Matrix(!0));t.gradient=this.ReadInfo_Gradient(n,t.fillStyleType==19);break;case 65:case 64:case 67:case 66:t.bitmapId=this.ReadUInt16();t.bitmapMatrix=this.ReadInfo_Matrix(!0);t.isMorph&&(t.endBitmapMatrix=this.ReadInfo_Matrix(!0))}return t}}),Object.defineProperty(t.prototype,"ReadInfo_ColorRGB",{value:function(){var n=NaN,t=NaN,i=NaN,r=NaN;return{R:n=this.ReadByte(),G:t=this.ReadByte(),B:i=this.ReadByte(),A:r=255,RGB:n<<16|t<<8|i}}}),Object.defineProperty(t.prototype,"ReadInfo_ColorRGBA",{value:function(){var n=NaN,t=NaN,i=NaN,r=NaN;return{R:n=this.ReadByte(),G:t=this.ReadByte(),B:i=this.ReadByte(),A:r=this.ReadByte(),RGB:n<<16|t<<8|i}}}),Object.defineProperty(t.prototype,"ReadInfo_Gradient",{value:function(n,t){var r,i,f,u;for(t===undefined&&(t=!1),r=null,i={},i.spreadMode=this.RUB(2,!0),i.interpolationMode=this.RUB(2),i.colors=[],i.alphas=[],i.ratios=[],i.endColors=[],i.endAlphas=[],i.endRatios=[],f=this.RUB(4),u=0;u<f;)i.ratios.push(this.ReadByte()),r=n.shapeType<3?this.ReadInfo_ColorRGB(n):this.ReadInfo_ColorRGBA(n),i.colors.push(r.RGB),i.alphas.push(r.A),i.isMorph=this.ReadByte()==1,i.isMorph&&(i.endRatios.push(this.ReadByte()),r=this.ReadInfo_ColorRGBA(n),i.endColors.push(r.RGB),i.endAlphas.push(r.A)),u++;return t&&(i.focalPoint=this.RFB8()),i}}),Object.defineProperty(t.prototype,"ReadInfo_Matrix",{value:function(n){n===undefined&&(n=!1);var r=n?.05:1,t=0,i={a:1,b:0,c:0,d:1,tx:0,ty:0};return this.RBB(!0)&&(t=this.RUB(5),i.a=this.RFB_BitNum(t)*r,i.d=this.RFB_BitNum(t)*r),this.RBB()&&(t=this.RUB(5),i.b=this.RFB_BitNum(t)*r,i.c=this.RFB_BitNum(t)*r),t=this.RUB(5),i.tx=this.RSB(t)*.05,i.ty=this.RSB(t)*.05,i}}),Object.defineProperty(t.prototype,"ReadInfo_LineStyle",{value:function(n){var t={width:this.ReadUInt16()*.05};return t.colorRGBA=n.shapeType<3?this.ReadInfo_ColorRGB(n):this.ReadInfo_ColorRGBA(n),t.isMorph=this.ReadByte()==1,t.isMorph&&(t.endWidth=this.ReadUInt16()*.05,t.endColorRGBA=this.ReadInfo_ColorRGBA(n)),t}}),Object.defineProperty(t.prototype,"ReadInfo_LineStyle2",{value:function(n){var t={isLineStyle2:!0,width:this.ReadUInt16()*.05};return t.isMorph=this.ReadByte()==1,t.isMorph&&(t.endWidth=this.ReadUInt16()*.05),t.startCapStyle=this.RUB(2,!0),t.joinStyle=this.RUB(2),t.hasFillFlag=this.RBB(),t.noHScaleFlag=this.RBB(),t.noVScaleFlag=this.RBB(),t.pixelHintingFlag=this.RBB(),this.RUB(5),t.noClose=this.RBB(),t.endCapStyle=this.RUB(2),t.joinStyle==2&&(t.miterLimitFactor=this.RFB8()),t.hasFillFlag?t.fillStyle=this.ReadInfo_FillStyle(n):(t.colorRGBA=this.ReadInfo_ColorRGBA(n),t.isMorph&&(t.endColorRGBA=this.ReadInfo_ColorRGBA(n))),t}}),Object.defineProperty(t.prototype,"ReadInfo_CXForm",{value:function(){var t=this.RBB(!0),i=this.RBB(),n=this.RUB(4);return{redMultiplier:i?this.RSB(n)/256:1,greenMultiplier:i?this.RSB(n)/256:1,blueMultiplier:i?this.RSB(n)/256:1,alphaMultiplier:1,redOffset:t?this.RSB(n):0,greenOffset:t?this.RSB(n):0,blueOffset:t?this.RSB(n):0,alphaOffset:0}}}),Object.defineProperty(t.prototype,"ReadInfo_CXFormAlpha",{value:function(){var t=this.RBB(!0),i=this.RBB(),n=this.RUB(4);return{redMultiplier:i?this.RSB(n)/256:1,greenMultiplier:i?this.RSB(n)/256:1,blueMultiplier:i?this.RSB(n)/256:1,alphaMultiplier:i?this.RSB(n)/256:1,redOffset:t?this.RSB(n):0,greenOffset:t?this.RSB(n):0,blueOffset:t?this.RSB(n):0,alphaOffset:t?this.RSB(n):0}}}),Object.defineProperty(t.prototype,"ReadInfo_DropShadowFilter",{value:function(){return{dropShadowColor:this.ReadInfo_ColorRGBA(null),blurX:this.RFB32(),blurY:this.RFB32(),angle:this.RFB32(),distance:this.RFB32(),strength:this.RFB8(),innerShadow:this.RBB(!0),knockout:this.RBB(),compositeSource:this.RBB(),passes:this.RUBByte(5)}}}),Object.defineProperty(t.prototype,"ReadInfo_GlowFilter",{value:function(){return{glowColor:this.ReadInfo_ColorRGBA(null),blurX:this.RFB32(),blurY:this.RFB32(),strength:this.RFB8(),innerGlow:this.RBB(!0),knockout:this.RBB(),compositeSource:this.RBB(),passes:this.RUB(5)}}}),Object.defineProperty(t.prototype,"ReadInfo_Filter",{value:function(){var t=NaN,n={filterType:this.ReadByte()};switch(n.filterType){case 3:this.Position=this.Position+27;break;case 1:this.Position=this.Position+9;break;case 6:this.Position=this.Position+80;break;case 5:this.Position=this.Position+(this.ReadByte()*this.ReadByte()*4+12+1);break;case 0:n.dropShadowFilter=this.ReadInfo_DropShadowFilter();break;case 2:n.glowFilter=this.ReadInfo_GlowFilter();break;case 7:case 4:t=this.ReadByte();this.Position=this.Position+(t*4+t*1+16+2+1)}return n}}),Object.defineProperty(t.prototype,"ReadInfo_FilterList",{value:function(){var n={numberOfFilters:this.ReadByte()},t;for(n.filter=[],t=0;t<n.numberOfFilters;)n.filter.push(this.ReadInfo_Filter()),t++;return n}}),t.prototype.source=undefined,t.prototype.data=undefined,t.prototype.dataView=undefined,t.prototype.BV_currentByte=0,t.prototype.BV_currentByteReadedNum=0,t.prototype.BV_currentValueSignbitIndex=0,Object.defineProperty(t.prototype,"isSWF",{value:function(n){n===undefined&&(n=!0);var t=null,i=null,r=null,u=null;return this.Length>3&&((t=this.ReadUTF8(3))=="ESC"||t=="ESF")?(t=="ESC"&&n&&(i=new Date,r=new Uint8Array(this.source,this.Position+this.data.byteOffset,this.data.byteLength-this.Position),u=new Zlib.Inflate(r).decompress(),this.SetArrayBuffer(u),_$ES.F.traceLog("解压缩用时:",(new Date).time-i.time,"毫秒")),_$ES.F.traceLog("应用解析中,解压缩后容量:",this.Length,"字节"),!0):!1}}),Object.defineProperty(t.prototype,"ReadBytes",{value:function(n){for(var t=this.Position,r=t+n,i=[],u=this.data;t<r;)i.push(u[t++]);return this.Position=t,i}}),Object.defineProperty(t.prototype,"ReadBytesToArrayBuffer",{value:function(n){var t=this.Position,i=t+n,r=_$ES.F.sliceArrayBuffer(this.source,t,i);return this.Position=i,r}}),Object.defineProperty(t.prototype,"ReadUTF8_c",{value:function(){for(var n=NaN,t=[];(n=this.ReadByte())!=0;)t.push(n);return this.GetUTF8String(t)}}),Object.defineProperty(t.prototype,"ReadUTF8_2",{value:function(){return this.ReadUTF8(this.RVU30U32())}}),Object.defineProperty(t.prototype,"ReadUTF8",{value:function(n){return this.GetUTF8String(this.ReadBytes(n))}}),Object.defineProperty(t.prototype,"GetUTF8String",{value:function(n){for(var i=NaN,f=NaN,o=NaN,r=[],t=0,u=n.length,e,t=0;t<u;){i=n[t];switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:r.push(i);break;case 12:case 13:t<u-1?(f=n[++t],r.push((i&31)<<6|f&63)):r.push(i);break;case 14:t<u-2?(f=n[++t],o=n[++t],r.push((i&15)<<12|(f&63)<<6|(o&63)<<0)):r.push(i)}t++}for(e="",t=0,u=r.length;t<u;)e=e+String.fromCharCode(r[t]),t++;return e}}),Object.defineProperty(t.prototype,"ReaderVariableU30U32S32Bytes",{value:function(){var n=NaN,t=[];do n=this.ReadByte(),t.push(n);while(n>>7==1);return t}}),Object.defineProperty(t.prototype,"ReaderVariableS32",{value:function(){for(var i=this.ReaderVariableU30U32S32Bytes(),n=0,r=0,t=i.length-1;t>=0;)r=i[t]&127,n=n+r,t>0&&(n=n<<7),t--;return n}}),Object.defineProperty(t.prototype,"RVU30U32",{value:function(){return this.ReaderVariableS32()>>>0}}),Object.defineProperty(t.prototype,"RSB",{value:function(n){this.BV_currentValueSignbitIndex=0;var t=this.RUB(n);return t>>this.BV_currentValueSignbitIndex-1==1&&(t=t|-1<<this.BV_currentValueSignbitIndex),t}}),Object.defineProperty(t.prototype,"RFB32",{value:function(){return this.ReadInt32()/65536}}),Object.defineProperty(t.prototype,"ReadInt32",{value:function(){var n=this.Position=this.Position+4;return this.data[n-4]|this.data[n-3]<<8|this.data[n-2]<<16|this.data[n-1]<<24}}),Object.defineProperty(t.prototype,"ReadUint32",{value:function(){return this.ReadInt32()>>>0}}),Object.defineProperty(t.prototype,"ReadUInt16",{value:function(){var n=this.Position=this.Position+2;return this.data[n-2]|this.data[n-1]<<8>>>0}}),Object.defineProperty(t.prototype,"ReadInt16",{value:function(){var t=this.Position=this.Position+2,n=this.data[t-2]|this.data[t-1]<<8;return n>>15==1&&(n=-32768|n),n}}),Object.defineProperty(t.prototype,"ReadByte",{value:function(){return this.data[this.Position++]}}),Object.defineProperty(t.prototype,"RBytes_Dec",{value:function(n,t){if(t===undefined&&(t=0),n==0)return null;var r=this.data.subarray(this.Position=this.Position+t,this.Position=this.Position+n),i=new Zlib.Inflate(r).decompress();return _$ES.F.sliceArrayBuffer(i.buffer,i.byteOffset,i.byteOffset+i.byteLength)}}),Object.defineProperty(t.prototype,"RBytes_Uint8Array",{value:function(n,t){return t===undefined&&(t=0),this.data.subarray(this.Position=this.Position+t,this.Position=this.Position+n)}}),Object.defineProperty(t.prototype,"RBytes_ArrayBuffer",{value:function(n,t){return t===undefined&&(t=0),_$ES.F.sliceArrayBuffer(this.data.buffer,this.Position=this.Position+t,this.Position=this.Position+n)}}),Object.defineProperty(t.prototype,"RBytes_DataURI",{value:function(n,t,i){i===undefined&&(i=0);var r="image/png";return n==1?r="image/jpeg":n==2&&(r="image/gif"),_$ES.F.getDataURI(r,this.data.subarray(this.Position=this.Position+i,this.Position=this.Position+t))}}),Object.defineProperty(t.prototype,"RBytes_ImageBlob",{value:function(n,t){var i="image/png";return n==1?i="image/jpeg":n==2&&(i="image/gif"),this.RBytes_Blob(t,i)}}),Object.defineProperty(t.prototype,"RBytes_Blob",{value:function(n,t,i){return i===undefined&&(i=0),new Blob([this.data.subarray(this.Position=this.Position+i,this.Position=this.Position+n)],{type:t})}}),Object.defineProperty(t.prototype,"RFB_BitNum",{value:function(n){return this.RSB(n)/65536}}),Object.defineProperty(t.prototype,"RFB8",{value:function(){return this.ReadUInt16()/256}}),Object.defineProperty(t.prototype,"ReadFB8_BitNum",{value:function(n){return this.RSB(n)/256}}),Object.defineProperty(t.prototype,"ReadNewBitValue",{value:function(){this.BV_currentByte=this.ReadByte();this.BV_currentByteReadedNum=0;this.BV_currentValueSignbitIndex=0}}),Object.defineProperty(t.prototype,"RUB",{value:function(n,t,i){t===undefined&&(t=!1);i===undefined&&(i=0);t&&this.ReadNewBitValue();var u=8-this.BV_currentByteReadedNum,r=n;return n>=u&&(r=u),i=i<<r,this.BV_currentValueSignbitIndex=this.BV_currentValueSignbitIndex+r,i=i|this.BV_currentByte>>u-r&~(-1<<r),i=i>>>0,this.BV_currentByteReadedNum=this.BV_currentByteReadedNum+r,r<n&&(this.BV_currentByte=this.ReadByte(),this.BV_currentByteReadedNum=0,i=this.RUB(n-r,!1,i)),i}}),Object.defineProperty(t.prototype,"ReadFloat",{value:function(){var n=this.dataView.getFloat32(this.Position,!0);return this.Position=this.Position+4,n}}),Object.defineProperty(t.prototype,"ReadFloat64",{value:function(){var n=this.dataView.getFloat64(this.Position,!0);return this.Position=this.Position+8,n}}),t.prototype.readFloat16_dv=undefined,Object.defineProperty(t.prototype,"ReadFloat16",{value:function(){var t=null;this.readFloat16_dv==null&&(t=new ArrayBuffer(4),this.readFloat16_dv=new DataView(t));var i=this.ReadByte(),n=this.ReadByte(),r=((n&127)>>2)- -111,u=i|(n&3)<<8|r<<23|(n&128)<<24;return this.readFloat16_dv.setInt32(0,u,!0),this.readFloat16_dv.getFloat32(0,!0)}}),Object.defineProperty(t.prototype,"RUBByte",{value:function(n,t){return t===undefined&&(t=!1),this.RUB(n,t)&255}}),Object.defineProperty(t.prototype,"RBB",{value:function(n){return n===undefined&&(n=!1),this.RUB(1,n)==1}}),Object.defineProperty(t.prototype,"GetBitCount",{value:function(){return(this.Length-this.Position)*8+(8-this.BV_currentByteReadedNum)}}),t.prototype.Position=0,t.prototype._length=undefined,Object.defineProperty(t.prototype,"Length",{get:function(){return this._length},set:function(n){this._length=n}}),function(){}.call(t),t},function(){n["_$ES.BR"]=n["_$ES.BR"](Object)}.call(n),n}var t,n=this;n=n._$ES=n._$ES||{};Object.defineProperty(n,"BR",{get:function(){return t===undefined&&(t=null,t=i(),delete n.BR,n.BR=t["_$ES.BR"]),t["_$ES.BR"]},configurable:!0})}).call(this);