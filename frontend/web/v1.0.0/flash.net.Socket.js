_$ES.Define("flash.net::Socket",["flash.events::EventDispatcher","flash.utils::ByteArray","flash.utils::IDataInput","flash.utils::IDataOutput","flash.events::Event","flash.events::IOErrorEvent","flash.events::ProgressEvent","Object"],function(n){"use strict";var t={},i=n.createScope({},t,"flash.events::EventDispatcher");return t["flash.net::Socket"]=function(i){function r(n,t){n===undefined&&(n=null);n=n==null?null:""+n;t===undefined&&(t=0);t=t|0;this._$receivedBuffer=new u.ByteArray;this._$sendBuffer=new u.ByteArray;i.call(this);n&&this._$$connect(n,t)}var u=n.createScope({},t,"flash.utils::ByteArray","flash.events::EventDispatcher","flash.utils::IDataInput","flash.utils::IDataOutput","flash.events::Event","flash.events::IOErrorEvent","flash.events::ProgressEvent","Object");return u._$push(u.Object,u.EventDispatcher),u._$push(r),r._$TypeInfo={so:n,isDynamic:!1,isFinal:!1,isInterface:!1,fullName:"flash.net::Socket",theExtends:u.EventDispatcher,theImplements:[u.IDataInput,u.IDataOutput]},_$ES.F._extends(r,i),n.defMethod(r.prototype,"close",function(){this._$ws&&(this._$ws.close(),this._$ws=null)}),n.defField(r.prototype,"_$ws"),n.defField(r.prototype,"_$receivedBuffer"),n.defField(r.prototype,"_$receivedBufferWritePostion",0),n.defField(r.prototype,"_$sendBuffer"),n.defMethod(r.prototype,"connect",function(t,i){var f,r;t=t==null?null:""+t;i=i|0;f=this;this._$$close();this._$receivedBuffer.length=0;this._$sendBuffer.length=0;this._$receivedBufferWritePostion=0;t||(t="127.0.0.1");r=this._$ws=new n.js.WebSocket("ws://"+t+":"+i);r.binaryType="arraybuffer";r.onopen=_$ES.F.bind(function(){this.dispatchEvent(new u.Event("connect"))},this);r.onclose=_$ES.F.bind(function(){this.dispatchEvent(new u.Event("close"))},this);r.onerror=_$ES.F.bind(function(){this.dispatchEvent(new u.Event(u.IOErrorEvent.IO_ERROR))},this);r.onmessage=_$ES.F.bind(function(t){var e,r,i,f;i=this._$receivedBuffer;f=t.data;f&&(e=i.position,r=this._$receivedBufferWritePostion,e==r&&(e=r=0),i.position=r,typeof f=="string"?i.writeUTF(f):i._$writeBytesByUint8Array(new n.js.Uint8Array(f)),this._$receivedBufferWritePostion=i.position,i.position=e,this.dispatchEvent(new u.ProgressEvent(u.ProgressEvent.SOCKET_DATA,!1,!1,this._$receivedBufferWritePostion-r)))},this)}),n.defMethod(r.prototype,"flush",function(){var n=null,t=this._$ws;t&&(n=this._$sendBuffer,t.send(_$ES.F.sliceArrayBuffer(n._$buffer,0,n.position)),n.position=0)}),n.defField(r.prototype,"_$timeout",2e4),n.defProp(r.prototype,"timeout",function(){return this._$timeout},function(n){n=n>>>0;this._$timeout=n}),n.defProp(r.prototype,"endian",function(){return this._$sendBuffer.endian},function(t){t=t==null?null:""+t;this._$sendBuffer.endian=n.castString(this._$receivedBuffer.endian=t)}),n.defProp(r.prototype,"objectEncoding",function(){return this._$sendBuffer.objectEncoding},function(n){n=n>>>0;this._$sendBuffer.objectEncoding=(this._$receivedBuffer.objectEncoding=n)>>>0}),n.defMethod(r.prototype,"readBoolean",function(){return this._$receivedBuffer._$$readBoolean()}),n.defMethod(r.prototype,"readByte",function(){return this._$receivedBuffer._$$readByte()}),n.defMethod(r.prototype,"readBytes",function(n,t,i){t===undefined&&(t=0);t=+t;i===undefined&&(i=0);i=+i;this._$receivedBuffer._$$readBytes(n,t,i)}),n.defMethod(r.prototype,"readDouble",function(){return this._$receivedBuffer._$$readDouble()}),n.defMethod(r.prototype,"readFloat",function(){return this._$receivedBuffer._$$readFloat()}),n.defMethod(r.prototype,"readInt",function(){return this._$receivedBuffer._$$readInt()}),n.defMethod(r.prototype,"readMultiByte",function(n,t){return n=n>>>0,t=t==null?null:""+t,this._$receivedBuffer._$$readMultiByte(n,t)}),n.defMethod(r.prototype,"readObject",function(){return this._$receivedBuffer._$$readObject()}),n.defMethod(r.prototype,"readShort",function(){return this._$receivedBuffer._$$readShort()}),n.defMethod(r.prototype,"readUnsignedByte",function(){return this._$receivedBuffer._$$readUnsignedByte()}),n.defMethod(r.prototype,"readUnsignedInt",function(){return this._$receivedBuffer._$$readUnsignedInt()}),n.defMethod(r.prototype,"readUnsignedShort",function(){return this._$receivedBuffer._$$readUnsignedShort()}),n.defMethod(r.prototype,"readUTF",function(){return this._$receivedBuffer._$$readUTF()}),n.defMethod(r.prototype,"readUTFBytes",function(n){return n=+n,this._$receivedBuffer._$$readUTFBytes(n)}),n.defMethod(r.prototype,"writeBoolean",function(n){this._$sendBuffer._$$writeBoolean(n)}),n.defMethod(r.prototype,"writeByte",function(n){n=+n;this._$sendBuffer._$$writeByte(n)}),n.defMethod(r.prototype,"writeBytes",function(n,t,i){t===undefined&&(t=0);t=+t;i===undefined&&(i=0);i=+i;this._$sendBuffer._$$writeBytes(n,t,i)}),n.defMethod(r.prototype,"writeDouble",function(n){n=+n;this._$sendBuffer._$$writeDouble(n)}),n.defMethod(r.prototype,"writeFloat",function(n){n=+n;this._$sendBuffer._$$writeFloat(n)}),n.defMethod(r.prototype,"writeInt",function(n){n=+n;this._$sendBuffer._$$writeInt(n)}),n.defMethod(r.prototype,"writeMultiByte",function(n,t){n=n==null?null:""+n;t=t==null?null:""+t;this._$sendBuffer._$$writeMultiByte(n,t)}),n.defMethod(r.prototype,"writeObject",function(n){this._$sendBuffer._$$writeObject(n)}),n.defMethod(r.prototype,"writeShort",function(n){n=+n;this._$sendBuffer._$$writeShort(n)}),n.defMethod(r.prototype,"writeUTF",function(n){n=n==null?null:""+n;this._$sendBuffer._$$writeUTF(n)}),n.defMethod(r.prototype,"writeUTFBytes",function(n){n=n==null?null:""+n;this._$sendBuffer._$$writeUTFBytes(n)}),n.defProp(r.prototype,"connected",function(){return this._$ws&&this._$ws.readyState===n.js.WebSocket.OPEN},!1),n.defProp(r.prototype,"bytesAvailable",function(){return this._$receivedBufferWritePostion-this._$receivedBuffer.position>>>0},!1),function(){}.call(r),r},function(){t["flash.net::Socket"]=t["flash.net::Socket"](i.EventDispatcher)}.call(t),t});