_$ES.Define("XML",["Object","TypeError","XMLList","QName","Number","String"],function(n){"use strict";var t={},i=n.createScope({},t,"Object");return t.XML=function(i){function r(r){var e=null,f=null;if(n.isConstructorCall(this,u.XML))if(r==null)throw new u.TypeError;else return n._is(r,u.XML)?r:new u.XML(u.XML._$loadNode(r));if(f=n._is(r,n.js.Node)?this._$node=r:(e=n._as(r,u.XML))?this._$node=e._$node.cloneNode(!0):this._$node=u.XML._$loadNode(r),this._$isSimpleContentNode(f)&&!n._is(this,t._$SimpleContentXML))return new t._$SimpleContentXML(f);this._$nodeToXMLObj();i.call(this)}var u=n.createScope({},t,"XML","TypeError","Object","XMLList","QName","Number","String");return u._$push(u.Object,u.Object),u._$push(r),r._$TypeInfo={so:n,isDynamic:!1,isFinal:!1,isInterface:!1,fullName:"XML",theExtends:u.Object,theImplements:[]},_$ES.F._extends(r,i),n.defField(r.prototype,"_$node"),n.defMethod(r.prototype,"_$nodeToXMLObj",function(){this[0]=this;for(var t=this._$node.childNodes,n=0,i=t.length-0;n<i;)this._$appendNode(t[n],!1),n++}),n.defMethod(r.prototype,"_$childsByNodeType",function(n){n=+n;for(var r=null,e=this._$node,f=new u.XMLList,i=e.childNodes,t=0,o=i.length-0;t<o;)r=i[t],r.nodeType==n&&f._$appendXML(u.XML._$loadXML(i[t])),t++;return f._$appendComplete()}),n.defMethod(r.prototype,"_$appendNode",function(n,t){this._$insert(u.XML._$loadXML(n),-1,t)}),n.defMethod(r.prototype,"_$removeNode",function(n){this._$remove(n._$xml)}),n.defMethod(r.prototype,"_$remove",function(t){if(t){var r=this._$node,i=t._$node;i.parentNode===r&&(r.removeChild(i),i.nodeType==n.js.Node.ELEMENT_NODE&&delete this[i.nodeName])}}),n.defMethod(r.prototype,"_$insert",function(n,t,i){var r;if(t===undefined&&(t=-1),t=+t,i===undefined&&(i=!0),r=null,n){var u=this._$node,f=n._$node,e=(t==-1?null:u.childNodes[t])||null;i&&(r=n.parent(),r&&r._$remove(n),u.insertBefore(f,e));this._$createProp(this,this,f)}}),n.defMethod(r.prototype,"_$createProp",function(t,i,r){var e=this,u=null,f=null;return r.nodeType==n.js.Node.ELEMENT_NODE&&(u=r.nodeName,!n.js.Object.hasOwnProperty.call(t,u))?(f=i,n.defProp(t,u,function(){var n,t;return n=u,t=f,function(){return t.child(n)}}(),null),!0):!1}),n.defMethod(r.prototype,"addNamespace",function(){return this}),n.defMethod(r.prototype,"appendChild",function(n){return this._$appendNode(u.XML(n)._$node,!0),this}),n.defMethod(r.prototype,"attribute",function(t){var i=null,r=null,f=null,e=new u.XMLList,o=this._$node;return o.nodeType==n.js.Node.ELEMENT_NODE&&(f=o,r=(i=n._as(t,u.QName))!=null?f.attributes.getNamedItemNS(i.uri,i.localName):f.attributes.getNamedItem(t.toString())),r&&e._$appendXML(u.XML._$loadXML(r)),e._$appendComplete()}),n.defMethod(r.prototype,"_$getAttribute",function(n){return this.attribute(n)}),n.defMethod(r.prototype,"_$setAttribute",function(t,i){var r=null,f=null,e=this._$node;e.nodeType==n.js.Node.ELEMENT_NODE&&(f=e,(r=n._as(t,u.QName))!=null?f.setAttributeNS(r.uri,r.localName,i):f.setAttribute(t.toString(),i))}),n.defMethod(r.prototype,"attributes",function(){for(var t=new u.XMLList,i=this._$node.attributes,n=0,r=i.length;n<r;)t._$appendXML(u.XML._$loadXML(i[n])),n++;return t._$appendComplete()}),n.defMethod(r.prototype,"child",function(n){var i=null,t=NaN,e=NaN,r=null,o=this._$node,f=new u.XMLList;if(n!=null)if(0+n===n)f._$appendXML(u.XML._$loadXML(o.childNodes[n]));else for(i=o.childNodes,t=0,e=i.length-0;t<e;)r=i[t],(n==="*"||n.toString()==r.nodeName)&&f._$appendXML(u.XML._$loadXML(r)),t++;return f._$appendComplete()}),n.defMethod(r.prototype,"childIndex",function(){var t=null,n=NaN,i=NaN,u=this._$node,r=this.parent();if(r)for(t=r._$node.childNodes,n=0,i=t.length-0;n<i;){if(t[n]===u)return n>>0;n++}return-1}),n.defMethod(r.prototype,"children",function(){return this.child("*")}),n.defMethod(r.prototype,"comments",function(){return this._$childsByNodeType(n.js.Node.COMMENT_NODE)}),n.defMethod(r.prototype,"contains",function(n){return n?this.toXMLString()==n.toXMLString():!1}),n.defMethod(r.prototype,"copy",function(){return new u.XML(this._$node.cloneNode(!0))}),n.defMethod(r.prototype,"descendants",function(t){t===undefined&&(t="*");var r=null,f=null,e=null,i=NaN,s=NaN,h=new u.XMLList,o=this._$node;if(o.nodeType==n.js.Node.ELEMENT_NODE)for(f=o,e=(r=n._as(t,u.QName))?f.getElementsByTagNameNS(r.uri,r.localName):t==="*"?u.XML._$descendants(o):f.getElementsByTagName(t.toString()),i=0,s=e.length;i<s;)h._$appendXML(u.XML._$loadXML(e[i])),i++;return h._$appendComplete()}),n.defMethod(r.prototype,"elements",function(t){t===undefined&&(t="*");var r=null,f=null,e=null,i=NaN,o=NaN,s=new u.XMLList,h=this._$node;if(h.nodeType==n.js.Node.ELEMENT_NODE)for(f=h,e=(r=n._as(t,u.QName))?f.getElementsByTagNameNS(r.uri,r.localName):f.getElementsByTagName(t.toString()),i=0,o=e.length;i<o;)s._$appendXML(u.XML._$loadXML(e[i])),i++;return s._$appendComplete()}),n.defMethod(r.prototype,"hasComplexContent",function(){for(var i=this._$node.childNodes,t=0,r=i.length-0;t<r;){if(i[t].nodeType==n.js.Node.ELEMENT_NODE)return!0;t++}return!1}),n.defMethod(r.prototype,"hasOwnProperty",function(t){return t=t==null?null:""+t,n.js.Object.hasOwnProperty.call(this,t)}),n.defMethod(r.prototype,"hasSimpleContent",function(){return this._$isSimpleContentNode(this._$node)}),n.defMethod(r.prototype,"_$isSimpleContentNode",function(t){var r=null,i=NaN,u=NaN;switch(t.nodeType){case n.js.Node.TEXT_NODE:case n.js.Node.ATTRIBUTE_NODE:return!0;case n.js.Node.ELEMENT_NODE:for(r=t.childNodes,i=0,u=r.length-0;i<u;){if(r[i].nodeType==n.js.Node.ELEMENT_NODE)return!1;i++}return!0;default:return!1}}),n.defMethod(r.prototype,"inScopeNamespaces",function(){return[]}),n.defMethod(r.prototype,"insertChildAfter",function(t,i){var e=0,r=n._as(t,u.XML),f=n._as(i,u.XML),o=this._$node;if(!f||!(o.nodeType==n.js.Node.ELEMENT_NODE))return undefined;if(r){if(r.parent()!==this)return undefined;e=r.childIndex()+1}return this._$insert(f,e),f}),n.defMethod(r.prototype,"insertChildBefore",function(t,i){var e=-1,r=n._as(t,u.XML),f=n._as(i,u.XML),o=this._$node;if(!f||!(o.nodeType==n.js.Node.ELEMENT_NODE))return undefined;if(r){if(r.parent()!==this)return undefined;e=r.childIndex()}return this._$insert(f,e),f}),n.defMethod(r.prototype,"length",function(){return 1}),n.defMethod(r.prototype,"localName",function(){return this._$node.localName}),n.defMethod(r.prototype,"name",function(){var n=this._$node;return n._$qName||(n._$qName=new u.QName(n.namespaceURI||"",n.localName))}),n.defMethod(r.prototype,"namespace",function(n){return n===undefined&&(n=null),n=n==null?null:""+n,this._$node.lookupNamespaceURI(n)}),n.defMethod(r.prototype,"namespaceDeclarations",function(){return[]}),n.defMethod(r.prototype,"nodeKind",function(){switch(this._$node){default:case n.js.Node.ELEMENT_NODE:return"element";case n.js.Node.COMMENT_NODE:return"comment";case n.js.Node.PROCESSING_INSTRUCTION_NODE:return"processing-instruction";case n.js.Node.TEXT_NODE:return"text";case n.js.Node.ATTRIBUTE_NODE:return"attribute"}}),n.defMethod(r.prototype,"normalize",function(){return this._$node.normalize(),this}),n.defMethod(r.prototype,"parent",function(){var n=this._$node;return n.parentNode&&n.parentNode._$xml?n.parentNode._$xml:undefined}),n.defMethod(r.prototype,"prependChild",function(){return this._$insert(u.XML(this.child),0),this}),n.defMethod(r.prototype,"processingInstructions",function(t){t===undefined&&(t="*");t=t==null?null:""+t;for(var i=null,f=this._$node.childNodes,e=new u.XMLList,r=0,o=f.length-0;r<o;)i=f[r],i.nodeType==n.js.Node.PROCESSING_INSTRUCTION_NODE&&(t=="*"||t==i.nodeName)&&e._$appendXML(u.XML._$loadXML(i)),r++;return e._$appendComplete()}),n.defMethod(r.prototype,"propertyIsEnumerable",function(n){return n=n==null?null:""+n,!(n==null)&&n.toString()=="0"}),n.defMethod(r.prototype,"removeNamespace",function(){return this}),n.defMethod(r.prototype,"replace",function(t,i){var h=null,o=NaN,s=null,r=null,f=NaN,c=NaN,l=null,e=null,a=null;if(t!=null){if(h=this._$node,f=0,a=n.castString(typeof t),a==="number")o=u.Number(t)-0,r=h.childNodes[o];else for(l=h.childNodes,c=l.length-0,s=n._as(t,u.QName);f<c;)e=l[f],(s==null||e.localName!=s.localName||e.namespaceURI!=s.uri)&&t!="*"&&t!=e.nodeName||(r?(this._$removeNode(e),f--,c--):(o=f,r=e)),f++;r&&r._$xml&&(this._$removeNode(r),this._$insert(i,o))}return this}),n.defMethod(r.prototype,"setChildren",function(t){for(var i=NaN,o=NaN,r=null,f=null,h=this._$node,s=h.childNodes,e,i=s.length-1;i>=0;)this._$removeNode(s[i]),i--;if(e=n._as(t,u.XML),e)this._$insert(e);else if(r=n._as(t,u.XMLList),r)for(f=r._$xmlList,i=0,o=f.length-0;i<o;)this._$insert(f[i]),i++;return this}),n.defMethod(r.prototype,"setLocalName",function(n){n=n==null?null:""+n;_$ES.F.error(null,"XML.setLocalName() 未实现")}),n.defMethod(r.prototype,"setName",function(n){n=n==null?null:""+n;_$ES.F.error(null,"XML.setName() 未实现")}),n.defMethod(r.prototype,"setNamespace",function(){_$ES.F.error(null,"XML.setNamespace() 未实现")}),n.defMethod(r.prototype,"text",function(){return this._$childsByNodeType(n.js.Node.TEXT_NODE)}),n.defMethod(r.prototype,"toJSON",function(n){return n=n==null?null:""+n,"XML"}),n.defMethod(r.prototype,"valueOf",function(){return this}),n.defMethod(r.prototype,"toString",function(){var r=null,t,i=null;return this.hasSimpleContent()?(r=this._$node,t=r.textContent,t===undefined&&(i=n.js.document.createElement("toString"),i.appendChild(this._$node.cloneNode(!0)),t=i.textContent),n.castString(t)):this.toXMLString()}),n.defMethod(r.prototype,"toXMLString",function(){var t=null,r=this._$node,i=r.outerHTML;return i===undefined&&(t=n.js.document.createElement("toXMLString"),t.appendChild(this._$node.cloneNode(!0)),i=t.innerHTML),n.castString(i)}),n.defFunc(r.prototype,"_$get",function(t){var r=n.castString(u.String(t)),i;return r[0]=="@"?this.attribute(r.slice(1)):(i=this[t],i===undefined)?new u.XMLList:i}),n.defFunc(r.prototype,"_$set",function(n,t){return this[n]=t}),n.defFunc(r.prototype,"_$delete",function(n){return delete this[n]}),n.defFunc(r.prototype,"_$in",function(n){return n in this}),function(){var i=arguments[0]._$clone();n.defFunc(r,"setSettings",function(){for(var u=[],t=0,f=arguments.length;t<f;t++)u.push(arguments[t]);for(var n=null,r=i.XML.defaultSettings(),t=0,f=u.length-0;t<f;)n=u[t],n!=null&&(i.XML.ignoreComments=n.hasOwnProperty("ignoreComments")?n.ignoreComments:r.ignoreComments,i.XML.ignoreProcessingInstructions=n.hasOwnProperty("ignoreProcessingInstructions")?n.ignoreProcessingInstructions:r.ignoreProcessingInstructions,i.XML.ignoreWhitespace=n.hasOwnProperty("ignoreWhitespace")?n.ignoreWhitespace:r.ignoreWhitespace,i.XML.prettyIndent=(n.hasOwnProperty("prettyIndent")?n.prettyIndent:r.prettyIndent)-0,i.XML.prettyPrinting=n.hasOwnProperty("prettyPrinting")?n.prettyPrinting:r.prettyPrinting),t++},r);n.defFunc(r,"settings",function(){return{ignoreComments:i.XML.ignoreComments,ignoreProcessingInstructions:i.XML.ignoreProcessingInstructions,ignoreWhitespace:i.XML.ignoreWhitespace,prettyIndent:i.XML.prettyIndent,prettyPrinting:i.XML.prettyPrinting}},r);n.defFunc(r,"_$loadXML",function(n){return n._$xml||(n._$xml=new r(n))},r);n.defFunc(r,"_$loadNode",function(t){var r=null,u=null,f=null;return t==null?n.js.document.createTextNode(""):(r=n.castString(t.toString().replace(/(&(?!(amp;|lt;|gt;|quot;|apos;)))/g,"&amp;")),u=(new n.js.DOMParser).parseFromString(r,"text/xml"),u.getElementsByTagName("parsererror").length>0)?n.js.document.createTextNode(r):(f=u.firstChild,(i.XML.ignoreComments||i.XML.ignoreProcessingInstructions||i.XML.ignoreWhitespace)&&i.XML._$checkNode(f),f)},r);n.defFunc(r,"_$checkNode",function(t){for(var r=null,e=t.childNodes,u=0,f=e.length-0;u<f;)r=e[u],i.XML.ignoreComments&&r.nodeType==n.js.Node.COMMENT_NODE||i.XML.ignoreProcessingInstructions&&r.nodeType==n.js.Node.PROCESSING_INSTRUCTION_NODE?(t.removeChild(r),f--,u--):i.XML.ignoreWhitespace&&r.nodeType==n.js.Node.TEXT_NODE?(r.textContent=n.castString(r.textContent.replace(/(^\s*)|(\s*$)/g,"")),r.textContent==""&&(t.removeChild(r),f--,u--)):i.XML._$checkNode(r),u++},r);n.defFunc(r,"_$descendants",function(n,t){var r;t===undefined&&(t=null);r=null;t||(t=[]);for(var f=n.childNodes,u=0,e=f.length-0;u<e;)r=f[u],t.push(r),i.XML._$descendants(r,t),u++;return t},r);n.defProp(r,"ignoreComments",function(){return i.XML._$ignoreComments},function(n){i.XML._$ignoreComments=n});n.defField(r,"_$ignoreComments",!0);n.defProp(r,"ignoreProcessingInstructions",function(){return i.XML._$ignoreProcessingInstructions},function(n){i.XML._$ignoreProcessingInstructions=n});n.defField(r,"_$ignoreProcessingInstructions",!0);n.defProp(r,"ignoreWhitespace",function(){return i.XML._$ignoreWhitespace},function(n){i.XML._$ignoreWhitespace=n});n.defField(r,"_$ignoreWhitespace",!0);n.defProp(r,"prettyIndent",function(){return i.XML._$prettyIndent},function(n){n=+n;i.XML._$prettyIndent=n});n.defField(r,"_$prettyIndent",2);n.defProp(r,"prettyPrinting",function(){return i.XML._$prettyPrinting},function(n){i.XML._$prettyPrinting=n});n.defField(r,"_$prettyPrinting",!0);n.defFunc(r,"defaultSettings",function(){return{ignoreComments:!0,ignoreProcessingInstructions:!0,ignoreWhitespace:!0,prettyIndent:2,prettyPrinting:!0}},r);n.defProp(r,"_$simpleContentXMLClass",function(){return t._$SimpleContentXML},!1)}(u),function(){}.call(r),r},t._$SimpleContentXML=function(i){function u(n){i.call(this,n)}var r=n.createScope({},t,"XML","Object");return r._$push(r.Object,r.Object,r.XML),r._$push(u),u._$TypeInfo={so:n,isDynamic:!1,isFinal:!1,isInterface:!1,fullName:"ASXML.as$405::_$SimpleContentXML",theExtends:r.XML,theImplements:[]},_$ES.F._extends(u,i),function(){}.call(u),u},function(){var r=this;return t.XML=t.XML(i.Object),t._$SimpleContentXML=t._$SimpleContentXML(t.XML),function(){for(var i,u,f=n.js.Object.getOwnPropertyNames(n.js.String.prototype),e=t._$SimpleContentXML.prototype,r=0,o=f.length;r<o;)i=f[r],u=n.js.String.prototype[i],typeof u!="function"||i=="constructor"||e[i]||n.defMethod(e,i,function(t){return t=t==null?null:""+t,function(){return n.js.String.prototype[t].apply(this.toString(),arguments)}}(i)),r++}()}.call(t),t});